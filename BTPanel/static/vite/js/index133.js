import{N as e,n as a,B as t,_ as l,a as s}from"./index.js?v=1723125373998";import{l as i,ad as o,r as p,k as n,P as r,S as d,Z as m,_ as u,V as c,q as f,a3 as _,W as x,b as C,U as h,aw as j}from"./vue.js?v=1723125373998";import{b as g}from"./useTableColumns.js?v=1723125373998";import{u as v}from"./file2.js?v=1723125373998";import{_ as U,a as b}from"./Upload2.js?v=1723125373998";import{u as y}from"./use-theme-vars.js?v=1723125373998";import{_ as w}from"./Progress.js?v=1723125373998";import{N as F}from"./DataTable.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./Switch.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./Image.js?v=1723125373998";import"./_createCompounder.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Select.js?v=1723125373998";import"./Tag.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./omit.js?v=1723125373998";const k={class:"p-16px"},z={class:"flex items-center mb-12px"},S={key:1,class:"flex-center flex-col h-300px"},D={class:"drag-text"},B={class:"drag-suffix"},E=s(i({__name:"index",props:{path:{default:""},size:{default:100},uploadData:{default:()=>({multiple:!1})}},emits:["setConfirm","uploadSuccess"],setup(s,{expose:i,emit:E}){const P=s,T=E,{path:$,uploadData:I}=P,{t:L}=o(),N=y(),q=p([]),V=n((()=>(I.accept||"").split(",").map((e=>"'".concat(e,"'"))).join(", "))),W=e=>{var t,l;const{file:s}=e,{size:i}=P;return(null!=(l=null==(t=s.file)?void 0:t.size)?l:0)>1048576*i?(a.error(L("Component.UploadFile.index_7",[s.name,i])),!1):(I.multiple||(q.value=[]),!0)},Z=p([{key:"name",title:L("Component.UploadFile.index_3"),ellipsis:!0},{key:"size",title:L("Component.UploadFile.index_4"),width:100,render:a=>{var t;return e(null==(t=a.file)?void 0:t.size)}},{key:"status",title:L("Component.UploadFile.index_5"),width:140,render:e=>"pending"===e.status?L("Component.UploadFile.index_8"):"finished"===e.status?r("span",{class:"text-primary"},[L("Component.UploadFile.index_9")]):r(w,{type:"line",color:N.value.primaryColor,"indicator-placement":"outside",processing:!0,percentage:e.percentage||0},null)},g({width:70,options:(e,a)=>[{label:L("Public.Btn.Del"),type:"error",show:"uploading"!==e.status,onClick:()=>{q.value.splice(a,1)}}]})]);return i({onConfirm:async()=>{const e=q.value.filter((e=>"pending"===e.status));if(0===e.length)return a.error(L("Component.UploadFile.index_10")),!1;T("setConfirm",{disabled:!0}),e.forEach((e=>{e.status="uploading"}));for(let a of e){const e=new FormData;e.append("f_path",$),e.append("f_name",a.name),e.append("f_start","0"),a.file&&(e.append("f_size",a.file.size.toString()),e.append("blob",a.file)),await v(e,(e=>{a.percentage=100*(e.progress||0)})),a.status="finished"}a.success(L("Component.UploadFile.index_9")),T("setConfirm",{disabled:!1}),T("uploadSuccess",e)}}),(e,a)=>{const s=t,i=U,o=F,p=l,n=b;return d(),m("div",k,[u("div",z,[r(i,{ref:"upload",class:"w-auto","file-list":x(q),"onUpdate:fileList":a[0]||(a[0]=e=>C(q)?q.value=e:null),accept:x(I).accept,multiple:x(I).multiple,"default-upload":!1,"show-file-list":!1,onBeforeUpload:W},{default:c((()=>[r(s,{type:"primary"},{default:c((()=>[f(_(e.$t("Component.UploadFile.index_6")),1)])),_:1})])),_:1},8,["file-list","accept","multiple"])]),r(i,{ref:"upload",class:"w-auto","file-list":x(q),"onUpdate:fileList":a[2]||(a[2]=e=>C(q)?q.value=e:null),accept:x(I).accept,multiple:x(I).multiple,"default-upload":!1,"show-file-list":!1,onBeforeUpload:W},{default:c((()=>[r(n,null,{default:c((()=>[x(q).length>0?(d(),h(o,{key:0,"max-height":300,bordered:!1,data:x(q),columns:x(Z),onClick:a[1]||(a[1]=j((()=>{}),["stop"]))},null,8,["data","columns"])):(d(),m("div",S,[r(p,{name:"base-upload",size:"48",class:"text-#999"}),u("div",D,_(e.$t("Component.UploadFile.index_1")),1),u("div",B,_(e.$t("Component.UploadFile.index_2",[x(V)])),1)]))])),_:1})])),_:1},8,["file-list","accept","multiple"])])}}}),[["__scopeId","data-v-751e0eae"]]);export{E as default};
