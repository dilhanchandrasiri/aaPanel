System.register(["./public-legacy.js?v=1732601582185","./index-legacy102.js?v=1732601582185","./index-legacy.js?v=1732601582185","./index-legacy96.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1732601582185","./page_layout-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1732601582185","./vue-legacy.js?v=1732601582185","./naive-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy9.js?v=1732601582185","./common-legacy.js?v=1732601582185","./__commonjsHelpers__-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1732601582185"],(function(e,t){"use strict";var a,s,n,i,l,o,u,c,r,d,p,y,_,g,m,x,v,h,w,b,k,f,S,I,A,j,C,$,O,P,U,R,q,z,M,L,T,F,W,K,E,H,B,D,G,J,Q,V,X,Y,Z,N,ee,te,ae,se,ne,ie;return{setters:[e=>{a=e.d,s=e.b,n=e.h,i=e.E,l=e.f,o=e.a,u=e.s,c=e.F},e=>{r=e._},e=>{d=e._},e=>{p=e._},e=>{y=e._},e=>{_=e.i,g=e.a8,m=e.S,x=e.I,v=e.bn,h=e.m,w=e.f,b=e.a4,k=e._,f=e.k,S=e.u,I=e.n},e=>{A=e._},e=>{j=e.d,C=e.W,$=e.r,O=e.n,P=e.j,U=e.O,R=e.P,q=e.M,z=e.Y,M=e.Q,L=e.Z,T=e.R,F=e.ac,W=e.V,K=e.w,E=e.F,H=e.c,B=e.X,D=e.L,G=e.ad,J=e.k,Q=e.v,V=e.e},e=>{X=e.bL,Y=e.bh,Z=e.ad,N=e.bG,ee=e.aa,te=e.aW,ae=e.bJ,se=e.bo},e=>{ne=e._},e=>{ie=e._},null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".ul-style[data-v-e7a4054e]{margin:0 auto;display:flex;align-items:center;justify-content:center;gap:48px;font-size:16px}.ul-style li[data-v-e7a4054e]{display:flex;align-items:center}.item[data-v-e7a4054e]{border-left:3px solid #def2e2}.item li[data-v-e7a4054e]{width:180px;margin-left:-3px;font-size:14px;line-height:36px;padding:0 20px;cursor:pointer}.item .active[data-v-e7a4054e]{border-left:3px solid #20a53a;color:#20a53a;font-weight:700;font-size:16px}\n",document.head.appendChild(t);const{t:le}=_.global,oe=e=>g.post("/plugin?action=a&name=bt_security&s=start_user_security",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),ue=e=>g.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),ce=e=>g.post("/plugin?action=a&name=bt_security&s=start_user_log",e,{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}),re=e=>g.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),de=e=>g.post("/plugin?action=a&name=bt_security&s=get_logs_list",e,{requestOptions:{loading:le("Site.Api.Index_10"),successMessage:!1}}),pe=e=>g.post("/plugin?action=a&name=bt_security&s=del_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_3"),successMessage:!0}}),ye=e=>g.post("/plugin?action=a&name=bt_security&s=add_porcess_log",e,{requestOptions:{loading:le("Security.Api.Index_4"),successMessage:!0}}),_e={class:"p-20px"},ge=j({__name:"log",props:{data:{}},setup(e,{expose:t}){const{t:n}=C(),i=e,{date:l,name:o}=i.data,u=$([]),{keys:c,table:r,columns:d}=a([{key:"log",title:n("Ftp.Analysis.Index_27"),render:()=>o},{key:"cwd",title:n("Security.Anti.Index_46")},{key:"cmd",title:n("Security.Anti.Index_47")},{key:"filename",title:n("Security.Anti.Index_48")},{key:"cwd",title:n("Config.Safe.index_152"),render:e=>m(e.timestamp)}]);O((()=>{u.value=l.map((e=>({label:e,value:e})))}));const p=P({p:1,num:999,day:l[0]}),{loading:_,setLoading:v}=s(),h=async()=>{try{v(!0);const{message:t}=await(e={...p,user:o},g.post("/plugin?action=a&name=bt_security&s=get_user_log",e));x(t)&&(r.data=t,r.total=t.length)}finally{c.value=[],v(!1)}var e};return h(),t({init:h}),(e,t)=>{const a=X,s=Y,n=y,i=A;return U(),R("div",_e,[q(s,{class:"flex-nowrap! items-center mb-10px"},{default:z((()=>[M("span",null,L(e.$t("Security.Anti.Index_45")),1),q(a,{class:"w-150px",value:T(p).day,"onUpdate:value":[t[0]||(t[0]=e=>T(p).day=e),h],options:T(u)},null,8,["value","options"])])),_:1}),q(i,null,{table:z((()=>[q(n,{"checked-row-keys":T(c),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>F(c)?c.value=e:null),loading:T(_),data:T(r).data,"max-height":350,columns:T(d)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),me=j({__name:"index",setup(e,{expose:t}){const{t:o}=C(),u=v(),{antiForm:c}=W(u),r=n(),{keys:_,table:m,columns:b}=a([{key:"user",title:o("Ftp.Analysis.Index_27")},{key:"total",title:o("Security.Anti.Index_7")},{key:"today",title:o("Public.Search.Today")},i({key:"protection",title:o("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await oe({user:t.user}):await ue({user:t.user})}}),i({key:"log",title:o("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{e?await ce({uid:t.uid}):await re({uid:t.uid})}}),{key:"remark",title:o("Site.Proxy.index_3")},l({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await de({user:e.user});!x(t)||t.length?(r.title=`[${e.user}] - ${o("Site.Proxy.index_51")}`,r.data.date=t,r.data.name=e.user,r.show=!0):h.error(o("Security.Anti.Index_44"))}}]})]);K((()=>u.isRefresh),(e=>{e&&(u.setRefresh(!1),S())}));const{loading:k,setLoading:f}=s(),S=async()=>{try{f(!0);const{message:e}=await g.post("/plugin?action=a&name=bt_security&s=get_total_all");w(e)&&(c.value.switch=e.open,c.value.times=e.totla_times,c.value.days=e.totla_days,m.data=e.system_user.map((e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]}))))}finally{_.value=[],f(!1)}};return S(),t({init:S}),(e,t)=>{const a=y,s=p,n=d;return U(),R(E,null,[q(a,{"checked-row-keys":T(_),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(_)?_.value=e:null),"row-key":"user","max-height":750,loading:T(k),data:T(m).data,columns:T(b)},null,8,["checked-row-keys","loading","data","columns"]),q(s,{class:"mt-16px"},{default:z((()=>[M("li",null,L(e.$t("Security.Anti.Index_4")),1),M("li",null,L(e.$t("Security.Anti.Index_5")),1),M("li",null,L(e.$t("Security.Anti.Index_6")),1)])),_:1}),q(n,{show:T(r).show,"onUpdate:show":t[1]||(t[1]=e=>T(r).show=e),title:T(r).title,data:T(r).data,width:750,"min-height":268,footer:!1,component:ge},null,8,["show","title","data"])],64)}}}),xe={class:"p-20px"},ve={class:"w-280px"},he={class:"color-#ff3333"},we=j({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=C(),s=e,{getList:n}=s.data,i=$(null),l=P({name:""}),o={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{await(i.value?.validate()),await ye({cmd:l.name}),n?.(),e()}}),(e,t)=>{const a=Z,s=N,n=ne,u=p;return U(),R("div",xe,[q(n,{ref_key:"formRef",ref:i,model:T(l),rules:o},{default:z((()=>[q(s,{label:e.$t("Home.index_24"),path:"name"},{default:z((()=>[M("div",ve,[q(a,{type:"text",value:T(l).name,"onUpdate:value":t[0]||(t[0]=e=>T(l).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),q(u,{class:"mt-4px"},{default:z((()=>[M("li",he,L(e.$t("Security.Anti.Index_9")),1)])),_:1})])}}}),be=j({__name:"index",setup(e,{expose:t}){const{t:i}=C(),{loading:u,setLoading:c}=s(),{keys:r,table:p,columns:_}=a([{key:"whitelist",title:i("Security.Anti.Index_11")},l({width:130,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{o({title:`${i("Security.Anti.Index_12")} [${e.whitelist}]`,content:i("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{await pe({cmd:e.whitelist}),m(),t()}})}}]})]),m=async()=>{try{c(!0);const{message:e}=await g.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");x(e)&&(p.data=e.map((e=>({whitelist:e}))))}finally{r.value=[],c(!1)}};m(),t({init:m});const v=()=>{h.show=!0},h=n(i("Security.Anti.Index_10"),{getList:m});return(e,t)=>{const a=ee,s=y,n=A,i=d;return U(),R("div",null,[q(n,null,{toolsLeft:z((()=>[q(a,{type:"primary",onClick:v},{default:z((()=>[H(L(e.$t("Security.Anti.Index_10")),1)])),_:1})])),table:z((()=>[q(s,{"checked-row-keys":T(r),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(r)?r.value=e:null),"row-key":"whitelist",loading:T(u),"max-height":440,data:T(p).data,columns:T(_)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),q(i,{show:T(h).show,"onUpdate:show":t[1]||(t[1]=e=>T(h).show=e),title:T(h).title,data:T(h).data,width:480,footer:!0,component:we},null,8,["show","title","data"])])}}}),ke=j({__name:"index",setup(e,{expose:t}){const{t:n}=C(),{keys:i,table:l,columns:o}=a([{key:"log",title:n("Public.Table.Operation")},{key:"addtime",align:"right",title:n("Site.Cert.index_68")}]),u=P({p:1,limit:10}),{loading:c,setLoading:r}=s(),d=async()=>{try{r(!0);const{message:t}=await(e=u,g.post("/plugin?action=a&name=bt_security&s=get_log",e));w(t)&&(l.data=t.data,l.total=b(t.page))}finally{i.value=[],r(!1)}var e};return d(),t({init:d}),(e,t)=>{const a=y,s=ie,n=A;return U(),B(n,{feedback:!0},{table:z((()=>[q(a,{"checked-row-keys":T(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>F(i)?i.value=e:null),"row-key":"log",loading:T(c),data:T(l).data,columns:T(o)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:z((()=>[q(s,{page:T(u).p,"onUpdate:page":t[1]||(t[1]=e=>T(u).p=e),"page-size":T(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>T(u).limit=e),"item-count":T(l).total,"store-key":"security-anti",onRefresh:d},null,8,["page","page-size","item-count"])])),_:1})}}}),fe=j({__name:"index",setup(e){const{t:t}=C(),a=$("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:me},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:be},{key:"operation",label:t("Security.Tabs.Index_7"),component:ke}];return(e,t)=>{const n=r;return U(),B(n,{value:T(a),"onUpdate:value":t[0]||(t[0]=e=>F(a)?a.value=e:null),options:s},null,8,["value"])}}}),Se={class:"pt-40px pb-40px"},Ie={class:"mb-16px"},Ae={class:"ul-style"},je={class:"text-center my-24px"},Ce={class:"flex justify-center"},$e={class:"item"},Oe=["onClick"],Pe=f(j({__name:"conversion",setup(e){const t=$(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{u({source:105})};return(e,n)=>{const i=k,l=ee,o=te,u=ae;return U(),B(u,null,{default:z((()=>[M("div",Se,[n[3]||(n[3]=M("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),M("div",Ie,[M("ul",Ae,[M("li",null,[q(i,{name:"security-lixian",size:"22"}),n[0]||(n[0]=M("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),M("li",null,[q(i,{name:"security-sanfang",size:"20"}),n[1]||(n[1]=M("span",{class:"ml-4px"},"Stop the mining virus",-1))]),M("li",null,[q(i,{name:"security-webshell",size:"26"}),n[2]||(n[2]=M("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),M("div",je,[q(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:z((()=>[H(L(e.$t("WP.Transition.index_7")),1)])),_:1})]),M("div",Ce,[M("div",$e,[M("ul",null,[(U(),R(E,null,D(a,((e,a)=>M("li",{class:G({active:T(t)==a}),key:a,onClick:e=>t.value=a},L(e),11,Oe))),64))])]),J(q(o,{width:"100%",src:T("/static/vite/images/overview2.png")},null,8,["src"]),[[Q,0==T(t)]]),J(q(o,{width:"100%",src:T("/static/vite/images/whitelist.png")},null,8,["src"]),[[Q,1==T(t)]]),J(q(o,{width:"100%",src:T("/static/vite/images/logs.png")},null,8,["src"]),[[Q,2==T(t)]])])])])),_:1})}}}),[["__scopeId","data-v-e7a4054e"]]),Ue={key:0};e("default",j({__name:"index",setup(e){const t=S(),{isPro:a}=W(t),s=v(),{antiForm:n}=W(s),i=$(n.value.switch),l=V((()=>n.value.switch));K(l,(e=>{i.value=e}));const o=V((()=>n.value.times)),u=V((()=>n.value.days)),r=async e=>{e?await g.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_1"),successMessage:!0}}):await g.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:le("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await c("bt_security")})(),(e,t)=>{const s=se,n=I,l=Y,c=ae;return T(a)?(U(),R("div",Ue,[q(c,{class:"my-15px"},{default:z((()=>[q(l,{class:"p-15px items-center"},{default:z((()=>[M("span",null,L(e.$t("Security.Anti.Index_1")),1),q(s,{value:T(i),"onUpdate:value":[t[0]||(t[0]=e=>F(i)?i.value=e:null),r],"rubber-band":!1,size:"small"},null,8,["value"]),q(n,{vertical:""}),M("span",null,L(e.$t("Security.Anti.Index_2"))+": "+L(T(o)),1),q(n,{vertical:""}),M("span",null,L(e.$t("Security.Anti.Index_3"))+": "+L(T(u)),1)])),_:1})])),_:1}),q(c,{class:"p-15px"},{default:z((()=>[q(fe)])),_:1})])):(U(),B(Pe,{key:1}))}}}))}}}));
