import{_ as a}from"./index.js?v=1732601582185";import{_ as e}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";import{_ as t}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1732601582185";import{u as s,f as n,k as o,I as u,h as r,J as d,a4 as p}from"./page_layout.js?v=1732601582185";import{s as c,h as _,d as m,D as v,f as x,e as f,a as w,u as h}from"./public.js?v=1732601582185";import{l as M,e as b,c as g,h as B,i as y,j as k,k as j}from"./mail.js?v=1732601582185";import{aa as q,ad as P,bG as $,bl as U,bL as E,bo as C,bJ as z}from"./naive.js?v=1732601582185";import{d as A,t as S,O as R,P as G,M as W,Y as D,Q as L,Z as T,c as I,W as V,r as Z,j as J,R as O,X as F,af as H,a9 as Q}from"./vue.js?v=1732601582185";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185";const Y={class:"flex justify-center p-32px"},K=o(A({__name:"login",props:{row:{},info:{}},setup(a){const e=a,l=S(e,"row"),t=S(e,"info"),i=s(),o=async()=>{if(i.isFree)return void c({source:221});const{message:a}=await M({rc_user:l.value.username,rc_pass:l.value.password});n(a)&&window.open("".concat(t.value.ssl_status?"https":"http","://").concat(a.result))},u=()=>{window.open("".concat(t.value.ssl_status?"https":"http","://").concat(t.value.site_name))};return(a,e)=>{const l=q;return R(),G("div",Y,[W(l,{onClick:o},{default:D((()=>[L("span",null,T(a.$t("Database.PhpAdmin.index_11")),1),e[0]||(e[0]=L("span",{class:"bg-recommend"},null,-1))])),_:1}),W(l,{class:"ml-32px",onClick:u},{default:D((()=>[I(T(a.$t("Database.PhpAdmin.index_6")),1)])),_:1})])}}}),[["__scopeId","data-v-6ff1f026"]]),N={class:"p-20px"},aa={class:"w-280px"},ea={class:"w-100px ml-10px"},la={class:"w-280px"},ta={class:"w-130px"},ia={class:"w-140px ml-10px"},sa={class:"w-280px"},na=A({__name:"index",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(a,{expose:e,emit:l}){const t=a,i=l,{isEdit:s}=t,{t:n}=V(),o=Z(null),p=J({full_name:"",domain:null,quota:5,quota_unit:"GB",is_admin:0,username:"",password:"",active:1}),c=Z([]),_=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],m=[{label:n("Mail.MailBox.index_19"),value:0},{label:n("Mail.MailBox.index_20"),value:1}],v={full_name:{trigger:["blur","input"],validator:()=>""!==p.full_name.trim()||new Error(n("Mail.MailBox.index_21"))},username:{trigger:["blur","input"],validator:()=>""!==p.username.trim()||new Error(n("Mail.MailBox.index_22"))},quota:{trigger:["blur","input"],validator:()=>(console.log(p.quota),!!p.quota||new Error(n("Mail.MailBox.index_23")))},password:{trigger:["blur","input"],validator:()=>{if(s){if(p.password&&p.password.trim().length<8)return new Error(n("Mail.MailBox.index_26"));const a=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/;if(p.password&&!a.test(p.password))return new Error(n("Mail.MailBox.index_27"))}else{if(p.password.trim().length<8)return new Error(n("Mail.MailBox.index_24"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(p.password))return new Error(n("Mail.MailBox.index_25"))}return!0}}},x=()=>({full_name:p.full_name,quota:p.quota+" "+p.quota_unit,is_admin:p.is_admin,username:p.username+"@"+p.domain,password:p.password,active:p.active});return(async()=>{const{message:a}=await B();u(a)&&(c.value=a.map((a=>({label:a,value:a}))),null===p.domain&&(p.domain=a[0]))})(),(()=>{const{row:a,isEdit:e}=t;if(e&&a){p.full_name=a.full_name,p.is_admin=a.is_admin,p.username=a.username.split("@")[0],p.active=a.active;const[e,l]=a.username.split("@");p.username=e,p.domain=l;const t=r(a.quota),[i,s]=t.split(" ");p.quota=d(i),p.quota_unit=s}})(),e({onConfirm:async()=>{var a;await(null==(a=o.value)?void 0:a.validate()),s?await b(x()):await g(x()),i("refresh")}}),(a,e)=>{const l=P,t=$,i=U,n=E,u=C,r=X;return R(),G("div",N,[W(r,{ref_key:"formRef",ref:o,model:O(p),rules:v},{default:D((()=>[W(t,{label:a.$t("Mail.MailBox.index_10"),path:"full_name"},{default:D((()=>[L("div",aa,[W(l,{value:O(p).full_name,"onUpdate:value":e[0]||(e[0]=a=>O(p).full_name=a),placeholder:a.$t("Mail.MailBox.index_11")},null,8,["value","placeholder"])])])),_:1},8,["label"]),W(t,{label:a.$t("Mail.MailBox.index_3"),path:"quota"},{default:D((()=>[W(i,{value:O(p).quota,"onUpdate:value":e[1]||(e[1]=a=>O(p).quota=a),class:"w-170px",min:0,"show-button":!1,placeholder:a.$t("Mail.MailBox.index_12")},null,8,["value","placeholder"]),L("div",ea,[W(n,{value:O(p).quota_unit,"onUpdate:value":e[2]||(e[2]=a=>O(p).quota_unit=a),options:_},null,8,["value"])])])),_:1},8,["label"]),W(t,{label:a.$t("Mail.MailBox.index_13"),path:"is_admin"},{default:D((()=>[L("div",la,[W(n,{value:O(p).is_admin,"onUpdate:value":e[3]||(e[3]=a=>O(p).is_admin=a),options:m},null,8,["value"])])])),_:1},8,["label"]),W(t,{label:a.$t("Mail.MailBox.index_14"),path:"username"},{default:D((()=>[L("div",ta,[W(l,{value:O(p).username,"onUpdate:value":e[4]||(e[4]=a=>O(p).username=a),disabled:O(s),placeholder:a.$t("Mail.MailBox.index_15")},null,8,["value","disabled","placeholder"])]),L("div",ia,[W(n,{value:O(p).domain,"onUpdate:value":e[5]||(e[5]=a=>O(p).domain=a),disabled:O(s),filterable:!0,options:O(c)},null,8,["value","disabled","options"])])])),_:1},8,["label"]),W(t,{label:a.$t("Mail.MailBox.index_16"),path:"password"},{default:D((()=>[L("div",sa,[W(l,{value:O(p).password,"onUpdate:value":e[6]||(e[6]=a=>O(p).password=a),placeholder:O(s)?a.$t("Mail.MailBox.index_17"):a.$t("Mail.MailBox.index_18")},null,8,["value","placeholder"])])])),_:1},8,["label"]),W(t,{label:a.$t("Public.Table.Status"),path:"active","show-feedback":!1},{default:D((()=>[W(u,{value:O(p).active,"onUpdate:value":e[7]||(e[7]=a=>O(p).active=a),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),oa={class:"w-220px mr-8px"},ua=A({__name:"index",setup(s){const{t:o}=V(),d=H(),c=Z([]),M=()=>{c.value.unshift({label:o("Public.All"),value:"all"})},g=({option:a})=>"".concat(o("Mail.MailBox.index_29")).concat(a.label),P=J({p:1,size:10,domain:"all",search:""}),$=_("",{isEdit:!1,row:void 0,onRefresh:()=>{la()}}),U=()=>{$.data.isEdit=!1,$.data.row=void 0,$.title=o("Mail.MailBox.index_1"),$.show=!0},A=()=>{window.open("".concat(ea.ssl_status?"https":"http","://").concat(ea.site_name))},{table:S,columns:G}=m([{key:"username",title:o("Public.Table.Username"),ellipsis:{tooltip:!0}},v({width:160}),{key:"info",title:o("Mail.MailBox.index_2"),width:180,render:a=>W("a",{class:"bt-link",href:"javascript:;",onClick:()=>{X(a)}},[o("Public.Btn.Copy")])},{key:"quota",title:o("Mail.MailBox.index_3"),render:a=>r(a.quota)},{key:"is_admin",title:o("Mail.MailBox.index_4"),render:a=>1===a.is_admin?"Admin":"General user"},{key:"active",title:o("Public.Table.Status"),render:a=>W(C,{value:a.active,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async e=>{await b({username:a.username,full_name:a.full_name,quota:r(a.quota),active:e,is_admin:a.is_admin}),a.active=e}},null)},x({width:150,options:a=>[{label:"WebMail",onClick:()=>{if(ea.status)Y(a);else{const{hide:a}=w({title:o("Mail.MailBox.index_5"),content:()=>W(Q,{tag:"div",keypath:"Mail.MailBox.index_6",scope:"global"},{link_1:()=>W("a",{class:"bt-link",href:"javascript:;",onClick:()=>{d.push("/mail/setting"),a()}},[o("Layout.Sider.mail_1"),I(" > "),o("Layout.Sider.mail_12")])}),onConfirm:()=>{d.push("/mail/setting")}})}}},{label:o("Public.Btn.Edit"),onClick:()=>{N(a)}},{label:o("Public.Btn.Del"),onClick:()=>{aa(a)}}]})]),X=a=>{f("WebMail: ".concat(ea.ssl_status?"https":"http","://").concat(ea.site_name,"\nUsername: ").concat(a.username,"\nPassword: ").concat(a.password,"\nPOP service [ Address: ").concat(a.mx," Port: 110/995 ]\nIMAP service [ Address: ").concat(a.mx," Port: 143/993 ]\nSMTP service [ Address: ").concat(a.mx," Port: 25/465/587 ]\n"))},Y=async a=>{h({title:"WebMail",width:400,data:{row:a,info:ea},component:K})},N=a=>{$.data.isEdit=!0,$.data.row=a,$.title=o("Mail.MailBox.index_7"),$.show=!0},aa=async a=>{w({title:o("Mail.MailBox.index_8"),content:o("Mail.MailBox.index_9",[a.username]),onConfirm:async()=>{await y({username:a.username}),la()}})},ea=J({id:0,site_name:"",status:!1,ssl_status:!1}),la=async()=>{try{S.loading=!0;const{message:a}=await k({p:P.p,size:P.size,search:P.search,..."all"!==P.domain?{domain:P.domain}:{}});n(a)&&(S.data=u(a.data)?a.data:[],S.total=p(a.page))}finally{S.loading=!1}},ta=()=>{P.p=1,la()};return M(),(async()=>{const{message:a}=await B();u(a)&&(c.value=a.map((a=>({label:a,value:a}))),M())})(),(async()=>{try{S.loading=!0,await(async()=>{const{message:a}=await j();n(a)&&(ea.id=a.id,ea.status=a.status,ea.site_name=a.site_name,ea.ssl_status=a.ssl_status)})(),await la()}finally{S.loading=!1}})(),(s,n)=>{const o=q,u=E,r=i,d=t,p=l,_=e,m=a,v=z;return R(),F(v,{class:"p-16px"},{default:D((()=>[W(_,null,{toolsLeft:D((()=>[W(o,{type:"primary",onClick:U},{default:D((()=>[I(T(s.$t("Mail.MailBox.index_1")),1)])),_:1}),W(o,{onClick:A},{default:D((()=>n[5]||(n[5]=[I("WebMail")]))),_:1})])),toolsRight:D((()=>[L("div",oa,[W(u,{value:O(P).domain,"onUpdate:value":[n[0]||(n[0]=a=>O(P).domain=a),ta],options:O(c),"render-tag":g,filterable:!0},null,8,["value","options"])]),W(r,{value:O(P).search,"onUpdate:value":n[1]||(n[1]=a=>O(P).search=a),width:"280",placeholder:s.$t("Mail.MailBox.index_28"),onSearch:ta},null,8,["value","placeholder"])])),table:D((()=>[W(d,{loading:O(S).loading,data:O(S).data,columns:O(G)},null,8,["loading","data","columns"])])),pageRight:D((()=>[W(p,{page:O(P).p,"onUpdate:page":n[2]||(n[2]=a=>O(P).p=a),"page-size":O(P).size,"onUpdate:pageSize":n[3]||(n[3]=a=>O(P).size=a),"item-count":O(S).total,onRefresh:la},null,8,["page","page-size","item-count"])])),_:1}),W(m,{show:O($).show,"onUpdate:show":n[4]||(n[4]=a=>O($).show=a),title:O($).title,data:O($).data,width:480,"min-height":236,footer:!0,component:na},null,8,["show","title","data"])])),_:1})}}});export{ua as default};
