import{_ as e}from"./index73.js?v=1723125373998";import{_ as s,a as t}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1723125373998";import{cV as a,k as i,j as o,L as r,n}from"./index.js?v=1723125373998";import{u as l}from"./useLoading.js?v=1723125373998";import{ao as m,b2 as p}from"./site.js?v=1723125373998";import{_ as d}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1723125373998";import{l as u,ad as _,f as c,r as v,S as f,Z as P,P as g,V as j,_ as x,W as h,a3 as S}from"./vue.js?v=1723125373998";import{_ as b}from"./Select.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./Progress.js?v=1723125373998";import"./DataTable.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./omit.js?v=1723125373998";import"./Tag.js?v=1723125373998";const w={class:"p-20px"},H={class:"w-200px"},y=u({__name:"batch",props:{data:{}},setup(u,{expose:y}){const{t:E}=_(),$=u,{rows:k}=$.data,L=a(),T=c({version:null}),q={version:{trigger:"change",validator:()=>null!==T.version||new Error(E("Site.PHP.add_site_27"))}},C=v([]),{loading:M,setLoading:R}=l();(async()=>{try{R(!0);const{message:e}=await m();i(e)&&e.length>0?(C.value=e.map((e=>({label:e.name,value:e.version}))),T.version=e[0].version):(T.version=null,C.value=[])}finally{R(!1)}})();return y({onConfirm:async({hide:e})=>{const{message:s}=await p((()=>{const{version:e}=T;if(null===e)throw n.error(E("Site.PHP.index_67")),new Error(E("Site.PHP.index_67"));return{version:e,sites_id:k.map((e=>e.id)).join(",")}})());L.setRefresh(!0),o(s)&&(e=>{const{success:s,error:t}=e,a=[];s.forEach((e=>{const s=k.find((s=>s.name===e));s&&a.push({name:s.name,batchStatus:"success",reqMsg:E("Site.PHP.index_64")})})),Object.entries(t).forEach((([e,s])=>{const t=k.find((s=>s.name===e));t&&a.push({name:t.name,batchStatus:"error",reqMsg:s})})),r({title:E("Site.PHP.index_65"),width:440,footer:!0,component:d,data:{title:E("Site.PHP.index_66"),data:a,status:"done",columns:[{key:"name",title:E("Site.TableRow.SiteName"),ellipsis:{tooltip:{width:"trigger"}}}]}})})(s),e()}}),(a,i)=>{const o=b,r=s,n=t,l=e;return f(),P("div",w,[g(n,{model:h(T),rules:q},{default:j((()=>[g(r,{label:a.$t("Site.PHP.add_site_21"),path:"version"},{default:j((()=>[x("div",H,[g(o,{value:h(T).version,"onUpdate:value":i[0]||(i[0]=e=>h(T).version=e),loading:h(M),options:h(C)},null,8,["value","loading","options"])])])),_:1},8,["label"])])),_:1},8,["model"]),g(l,{class:"mt-8px"},{default:j((()=>[x("li",null,S(a.$t("Site.PHP.index_61")),1),x("li",null,S(a.$t("Site.PHP.index_62")),1),x("li",null,S(a.$t("Site.PHP.index_63")),1)])),_:1})])}}});export{y as default};
