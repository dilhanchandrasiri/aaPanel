const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/details2.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185","js/page_layout.js?v=1732601582185","js/vue.js?v=1732601582185","js/__commonjsHelpers__.js?v=1732601582185","js/naive.js?v=1732601582185","js/common.js?v=1732601582185","js/public.js?v=1732601582185","css/public.css?v=1732601582185","css/page_layout.css?v=1732601582185","js/tools.js?v=1732601582185","js/rules.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang15.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185","css/index14.css?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang.js?v=1732601582185","js/index99.js?v=1732601582185","css/index11.css?v=1732601582185","js/details3.js?v=1732601582185","js/http.js?v=1732601582185","js/index151.js?v=1732601582185","css/index18.css?v=1732601582185"])))=>i.map(i=>d[i]);
import{a8 as e,i as a,a1 as t,J as l,c as i,bB as n,I as s,f as o,a4 as r,bk as d,S as u,k as p,ba as c,o as _,bm as m}from"./page_layout.js?v=1732601582185";import{d as f,f as v,u as y,a as g,b}from"./public.js?v=1732601582185";import{_ as x}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{a as h,s as w}from"./tools.js?v=1732601582185";import{d as R,W,M as k,a6 as j,O as C,X as D,R as M,a9 as S,r as U,j as I,P,Y as $,Q as L,Z as z,k as E,v as O,c as B,F as T,t as H,aA as A,y as F,aq as V,L as q,ac as G,x as J,e as Q}from"./vue.js?v=1732601582185";import{aV as Y,bL as Z,bG as X,aa as K,D as N,bP as ee,bQ as ae,bJ as te,bZ as le,bH as ie,bI as ne}from"./naive.js?v=1732601582185";import{l as se}from"./rules.js?v=1732601582185";import{_ as oe}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import{_ as re}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";import{_ as de}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{_ as ue}from"./index99.js?v=1732601582185";import{_ as pe}from"./index.vue_vue_type_script_setup_true_lang15.js?v=1732601582185";import{j as ce}from"./common.js?v=1732601582185";const _e=t=>e.post("/plugin?action=a&name=btwaf&s=get_id_log",t,{requestOptions:{loading:a.global.t("Waf.Api.report_1")}}),me=R({__name:"index",props:{data:{default:()=>[]},total:{default:0},loading:{type:Boolean,default:!1}},setup(e){const a=e,{t:n}=W(),s=t(),{columns:o}=f([{key:"ip",title:n("Waf.Report.index_7"),ellipsis:{tooltip:!0}},{key:"address",title:n("Waf.Report.index_8"),ellipsis:{tooltip:!0}},{key:"num",title:n("Waf.Report.index_9"),width:"14%",minWidth:120},{key:"num",title:n("Waf.Report.index_10"),width:"32%",minWidth:160,render:e=>{const{total:t}=a,i=l((100*(t?e.num/t:0)).toFixed(1));return k("div",{class:"w-90%"},[k(Y,{type:"line","indicator-placement":"outside",height:16,"border-radius":2,percentage:i,color:s.value.successColor},null)])}},v({width:120,options:e=>[{label:n("Waf.Report.index_11"),onClick:()=>{h(e)}},{label:n("Public.Btn.Details"),onClick:()=>{y({title:n("Waf.Report.index_12",[e.ip]),width:950,minHeight:672,data:{row:e},component:j((()=>i((()=>import("./details2.js?v=1732601582185")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))))})}}]})]);return(e,a)=>{const t=x;return C(),D(t,{loading:e.loading,data:e.data,columns:M(o)},null,8,["loading","data","columns"])}}}),fe=R({__name:"index",props:{data:{default:()=>[]},total:{default:0},loading:{type:Boolean,default:!1}},setup(e){const a=e,n=t(),{t:s}=W(),{columns:o}=f([{key:"uri",title:"URI",ellipsis:{tooltip:!0}},{key:"num",title:s("Waf.Report.index_9"),width:"20%"},{key:"num",title:s("Waf.Report.index_10"),render:e=>{const{total:t}=a,i=l((100*(t?e.num/t:0)).toFixed(1));return k("div",{class:"w-90%"},[k(Y,{type:"line","indicator-placement":"outside",height:16,"border-radius":2,percentage:i,color:n.value.successColor},null)])}},v({width:120,options:e=>[{label:s("Waf.Report.index_11"),onClick:()=>{r(e)}},{label:s("Public.Btn.Details"),onClick:()=>{d(e)}}]})]),r=e=>{g({title:s("Waf.Report.index_19"),content:()=>k(S,{tag:"div",keypath:"Waf.Report.index_33",scope:"global"},{index_1:()=>k("span",{class:"text-error"},[e.uri])}),onConfirm:async()=>{await se({url_rule:e.uri})}})},d=e=>{y({title:s("Waf.Report.index_20",[e.uri]),width:950,minHeight:600,data:{uri:e.uri,list:e.list},component:j((()=>i((()=>import("./details3.js?v=1732601582185")),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,12]))))})};return(e,a)=>{const t=x;return C(),D(t,{loading:e.loading,data:e.data,columns:M(o)},null,8,["loading","data","columns"])}}}),ve={class:"p-8px"},ye={class:"w-160px"},ge={class:"min-w-160px mr-20px"},be={class:"text-desc"},xe={class:"w-450px"},he=R({__name:"index",setup(a){const{t:t}=W(),l=U(null),p=I({p:1,limit:10,site:"all",type:"1",search:"",time:null}),c={search:{trigger:["input","blur"],validator:()=>"4"===p.type||""!==p.search.trim()||new Error(t("Waf.Report.index_28"))},time:{trigger:["change"],validator:()=>"4"!==p.type||null!==p.time||new Error(t("Waf.Report.index_29"))}},_=U([{label:t("Waf.Report.index_30"),value:"all"}]),m=[{label:"IP",value:"1"},{label:"URI",value:"2"},{label:"URL",value:"3"},{label:t("Waf.Report.index_31"),value:"4"}],{table:g,columns:b,setLoading:h}=f([{key:"time_localtime",title:t("Waf.Report.index_13"),width:"18%",minWidth:150},{key:"ip",title:t("Waf.Report.index_7"),width:"14%",minWidth:120},{key:"server_name",title:t("Waf.Report.index_14"),width:"14%",minWidth:120,ellipsis:{tooltip:!0}},{key:"uri",title:"URI",ellipsis:{tooltip:!0},minWidth:160,render:e=>n(e.uri)},{key:"filter_rule",title:t("Waf.Report.index_1"),width:"14%",minWidth:120,ellipsis:{tooltip:!0}},v({width:100,options:e=>[{label:t("Public.Btn.Details"),onClick:async()=>{const{message:a}=await _e({id:e.id});s(a)&&a.length>0&&w(a[0])}},{label:"HTTP",onClick:()=>{R(e)}}]})]),R=e=>{y({title:t("Waf.Report.index_32",[e.time_localtime]),width:800,minHeight:458,data:{id:e.id},component:j((()=>i((()=>import("./http.js?v=1732601582185")),__vite__mapDeps([21,22,4,2,3,5,6,7,8,9,23,10,11,1,13,14,15,16,17,18,19,12]))))})},D=async()=>{var a,t;try{await(null==(a=l.value)?void 0:a.validate()),h(!0);const{message:i}=await(t=(()=>{const{time:e}=p,a=e?u(e[0],"yyyy-MM-dd"):"",t=e?u(e[1],"yyyy-MM-dd"):"";return{..."all"===p.site?{is_all:1}:{server_name:p.site},..."4"===p.type?{start_time:a,end_time:t}:{serach:p.search},p:p.p,type:p.type}})(),e.post("/plugin?action=a&name=btwaf&s=get_search",t));o(i)&&(g.data=s(i.data)?i.data:[],g.total=r(i.page))}finally{h(!1)}};return(async()=>{try{const{message:a}=await e.post("/plugin?action=a&name=btwaf&s=get_server_name");s(a)&&(_.value=a.map((e=>({label:e,value:e}))))}finally{_.value.unshift({label:t("Waf.Report.index_30"),value:"all"})}})(),(e,a)=>{const t=Z,i=X,n=ue,s=d,o=K,r=de,u=x,f=re,v=oe;return C(),P("div",ve,[k(r,{ref_key:"formRef",ref:l,model:M(p),rules:c},{default:$((()=>[k(i,{label:e.$t("Waf.Report.index_21")},{default:$((()=>[L("div",ye,[k(t,{value:M(p).site,"onUpdate:value":a[0]||(a[0]=e=>M(p).site=e),options:M(_)},null,8,["value","options"])])])),_:1},8,["label"]),k(i,{label:e.$t("Waf.Report.index_22")},{default:$((()=>[L("div",ge,[k(t,{value:M(p).type,"onUpdate:value":a[1]||(a[1]=e=>M(p).type=e),options:m},null,8,["value"])]),L("div",null,[a[6]||(a[6]=L("span",{class:"mr-8px text-error"},"*",-1)),L("span",be,z(e.$t("Waf.Report.index_23")),1)])])),_:1},8,["label"]),E(k(i,{label:e.$t("Waf.Report.index_25"),path:"search"},{default:$((()=>[L("div",xe,[k(n,{value:M(p).search,"onUpdate:value":a[2]||(a[2]=e=>M(p).search=e),rows:3},null,8,["value"])])])),_:1},8,["label"]),[[O,"4"!==M(p).type]]),E(k(i,{label:e.$t("Waf.Report.index_26"),path:"time"},{default:$((()=>[k(s,{value:M(p).time,"onUpdate:value":a[3]||(a[3]=e=>M(p).time=e),type:"daterange",clearable:""},null,8,["value"])])),_:1},8,["label"]),[[O,"4"===M(p).type]]),k(i,{label:" "},{default:$((()=>[k(o,{type:"primary",onClick:D},{default:$((()=>[B(z(e.$t("Waf.Report.index_27")),1)])),_:1})])),_:1})])),_:1},8,["model"]),k(v,null,{table:$((()=>[k(u,{loading:M(g).loading,data:M(g).data,columns:M(b)},null,8,["loading","data","columns"])])),pageRight:$((()=>[k(f,{page:M(p).p,"onUpdate:page":a[4]||(a[4]=e=>M(p).p=e),"page-size":M(p).limit,"onUpdate:pageSize":a[5]||(a[5]=e=>M(p).limit=e),"display-order":["pages"],"item-count":M(g).total,onRefresh:D},null,8,["page","page-size","item-count"])])),_:1})])}}}),we={class:"h-full p-10px"},Re=p(R({__name:"index",props:{loading:{type:Boolean,default:!1},data:{default:()=>[]}},setup(e){const{columns:a}=f([{key:"ip",title:"",align:"center",render:e=>k(T,null,[k("a",{class:"bt-link",href:"javascript:;",onClick:()=>{h(e)}},[e.ip]),k("span",{class:"mx-6px"},[e.address]),k("span",null,[B("("),e.num,B(")")])])}]);return(e,t)=>{const l=x;return C(),P("div",we,[k(l,{class:"rank-table",loading:e.loading,data:e.data,"flex-height":!0,bordered:!1,"single-line":!1,"single-column":!1,columns:M(a)},null,8,["loading","data","columns"])])}}}),[["__scopeId","data-v-9bacc249"]]),We={class:"flex-center h-full p-10px"},ke=R({__name:"index",props:{data:{default:()=>[]}},setup(e){const a=H(e,"data"),{t:t}=W(),l=U(!1),i=A({backgroundColor:"#fff",title:s(),tooltip:{trigger:"item",confine:!0,formatter(e){const a=e;return"".concat(a.marker," ").concat(a.name,": ").concat(a.value," (").concat(a.percent,"%)")}},series:o()}),n=["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"];function s(e=0){return{text:t("Waf.Report.index_18"),textStyle:{color:"#484848",fontSize:17},subtext:"".concat(e),subtextStyle:{color:"#717171",fontSize:15},itemGap:20,left:"center",top:"42%"}}function o(e=[]){return[{type:"pie",data:e,radius:["50%","60%"],center:["50%","50%"],clockwise:!0,avoidLabelOverlap:!0,label:{show:!0,position:"outside",color:"#999",lineHeight:18,formatter:e=>""!==e.name?0===e.percent?"":t("Waf.Overview.index_33",[e.name,e.value,e.percent]):""},labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},itemStyle:{labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},color:e=>n[e.dataIndex]},emphasis:{scaleSize:15}}]}return F((()=>{a.value&&(l.value=!a.value.length,(()=>{let e=0;const t=[];a.value.forEach((a=>{e+=a[1],t.push({name:a[0],value:a[1]})})),i.title=s(e),i.series=o(t)})())})),(e,a)=>{const t=N;return C(),P("div",We,[M(l)?(C(),D(t,{key:0})):(C(),D(pe,{key:1,type:"pie",height:"100%",option:M(i)},null,8,["option"]))])}}}),je={class:"flex"},Ce=p(R({__name:"date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:a}=W(),t=U("today"),l=U(null),i=V(e,"value"),n=[{label:a("Public.Search.Yesterday"),value:"yesterday"},{label:a("Public.Search.Today"),value:"today"}],o=e=>{l.value=null,i.value=e},r=e=>{t.value=e?"":"today",i.value=s(e)?e:"today"};return F((()=>{s(i.value)?(l.value=i.value,t.value=""):(t.value=i.value,l.value=null)})),(e,a)=>{const i=ee,s=ae,u=d;return C(),P("div",je,[k(s,{value:M(t),"onUpdate:value":[a[0]||(a[0]=e=>G(t)?t.value=e:null),o],size:"small",class:"bt-radio"},{default:$((()=>[(C(),P(T,null,q(n,(e=>k(i,{key:e.value,value:e.value},{default:$((()=>[B(z(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),k(u,{value:M(l),"onUpdate:value":[a[1]||(a[1]=e=>G(l)?l.value=e:null),r],type:"daterange",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-9ee89472"]]),De={class:"h-320px"},Me={class:"h-320px"},Se=p(R({__name:"index",setup(a){const{loading:t,setLoading:l}=b(),i=U("ip"),n=J({type:[],ip:[],ip_list:{},uri:[],uri_list:{}}),s=Q((()=>n.value.ip.map((e=>({ip:e[0],num:e[1],address:e[2],data:n.value.ip_list[e[0]]}))))),r=Q((()=>n.value.uri.map((e=>({uri:e[0],num:e[1],list:n.value.uri_list[e[0]].ip_list||[]}))))),d=Q((()=>{let e=0;return n.value.type.forEach((a=>{e+=a[1]})),e})),p=e=>{"search"!==e&&x()},f=()=>{x()},v=()=>{const e=m();if("today"===y.date)window.open("".concat(e,"/btwaf/content_report.html"));else{const{start:a,end:t}=g();window.open("".concat(e,"/btwaf/content_report.html?stime=").concat(a,"&etime=").concat(t))}},y=I({date:"today"}),g=()=>{let e="",a="";if(_(y.date))switch(y.date){case"today":e=u(new Date,"yyyy-MM-dd"),a=u(new Date,"yyyy-MM-dd");break;case"yesterday":e=u(ce(new Date,-1),"yyyy-MM-dd"),a=u(ce(new Date,-1),"yyyy-MM-dd")}else e=u(new Date(y.date[0]),"yyyy-MM-dd"),a=u(new Date(y.date[1]),"yyyy-MM-dd");return{start:e,end:a}},x=async()=>{try{l(!0);const{message:t}=await(a=(()=>{const{start:e,end:a}=g();return{..."today"!==y.date?{start_time:e,end_time:a}:{}}})(),e.post("/plugin?action=a&name=btwaf&s=get_report",a));o(t)&&(n.value=t)}finally{l(!1)}var a};return x(),(e,a)=>{const l=te,o=le,u=K,_=ie,m=ne,g=c;return C(),D(g,{class:"report-grid","x-gap":"16"},{default:$((()=>[k(o,{span:"6"},{default:$((()=>[k(l,{class:"report-card mb-16px",title:e.$t("Waf.Report.index_1")},{default:$((()=>[L("div",De,[k(ke,{data:M(n).type},null,8,["data"])])])),_:1},8,["title"]),k(l,{class:"report-card",title:e.$t("Waf.Report.index_2")},{default:$((()=>[L("div",Me,[k(Re,{loading:M(t),data:M(s)},null,8,["loading","data"])])])),_:1},8,["title"])])),_:1}),k(o,{span:"18"},{default:$((()=>[k(l,{class:"h-full"},{default:$((()=>[k(m,{value:M(i),"onUpdate:value":[a[1]||(a[1]=e=>G(i)?i.value=e:null),p],type:"line",class:"report-tabs"},{prefix:$((()=>a[2]||(a[2]=[L("div",null,null,-1)]))),suffix:$((()=>[k(Ce,{value:M(y).date,"onUpdate:value":[a[0]||(a[0]=e=>M(y).date=e),f]},null,8,["value"]),k(u,{class:"ml-16px",type:"primary",size:"small",onClick:v},{default:$((()=>[B(z(e.$t("Waf.Report.index_3")),1)])),_:1}),a[3]||(a[3]=L("div",{class:"w-16px"},null,-1))])),default:$((()=>[k(_,{name:"ip",tab:e.$t("Waf.Report.index_4")},{default:$((()=>[k(me,{loading:M(t),total:M(d),data:M(s)},null,8,["loading","total","data"])])),_:1},8,["tab"]),k(_,{name:"uri",tab:e.$t("Waf.Report.index_5")},{default:$((()=>[k(fe,{loading:M(t),total:M(d),data:M(r)},null,8,["loading","total","data"])])),_:1},8,["tab"]),k(_,{name:"search",tab:e.$t("Waf.Report.index_6")},{default:$((()=>[k(he)])),_:1},8,["tab"])])),_:1},8,["value"])])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-0329e270"]]),Ue=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{_e as g,Ue as i};
