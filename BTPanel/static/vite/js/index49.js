import{aw as e,ax as t,ae as a,j as s,g as n,B as l,q as i,cG as o,p as u,a as r,k as c,cP as d,n as p,G as _,m,b8 as y,_ as g,r as h,au as x,cQ as f}from"./index.js?v=1723125373998";import{_ as v}from"./index77.js?v=1723125373998";import{_ as w}from"./index73.js?v=1723125373998";import{_ as b}from"./index.vue_vue_type_script_setup_true_lang.js?v=1723125373998";import{u as k,_ as S}from"./useTableData.js?v=1723125373998";import{u as I}from"./useLoading.js?v=1723125373998";import{b as A,h as j}from"./useTableColumns.js?v=1723125373998";import{_ as $,a as C}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1723125373998";import{_ as T}from"./index.vue_vue_type_script_setup_true_lang13.js?v=1723125373998";import{l as P,ad as U,r as q,f as O,S as R,Z as H,P as L,V as M,W as D,q as z,a3 as K,b as B,_ as G,t as E,w as W,F,U as N,ag as Q,B as V,M as Z,a5 as J,a6 as X,aj as Y,k as ee}from"./vue.js?v=1723125373998";import{_ as te}from"./Select.js?v=1723125373998";import{s as ae}from"./pinia.js?v=1723125373998";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1723125373998";import{_ as ne}from"./Image.js?v=1723125373998";import{_ as le}from"./Switch.js?v=1723125373998";import"./Tabs.js?v=1723125373998";import"./omit.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1723125373998";import"./data.js?v=1723125373998";import"./Skeleton.js?v=1723125373998";import"./DataTable.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./Progress.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1723125373998";import"./InputGroupLabel.js?v=1723125373998";import"./InputGroup.js?v=1723125373998";import"./Tag.js?v=1723125373998";import"./_createCompounder.js?v=1723125373998";const{t:ie}=e.global,oe={class:"p-20px"},ue=P({__name:"form",props:{data:{}},setup(e,{expose:s}){const{t:n}=U(),l=[{label:n("Security.Anti.Index_28"),value:"i"},{label:n("Security.Anti.Index_29"),value:"a"}],i=e,{getList:o}=i.data,{row:u}=i.data,r=q(null),c=O({path:"",chattr:"i",d_mode:""}),d={path:{required:!0,message:n("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:n("Security.Conf.Index_28"),trigger:["blur","input"]}};return s({onConfirm:async({hide:e})=>{var a,s;await(null==(a=r.value)?void 0:a.validate()),await(s={...c,s_key:u.key},t.post("/plugin?name=syssafe&action=a&s=add_safe_path",s,{requestOptions:{loading:ie("Security.Api.Index_4"),successMessage:!0}})),null==o||o(),e()}}),(e,t)=>{const s=T,n=$,i=te,o=a,u=C;return R(),H("div",oe,[L(u,{ref_key:"formRef",ref:r,model:D(c),rules:d},{default:M((()=>[L(n,{label:e.$t("Site.DelSite.Path"),path:"path"},{default:M((()=>[L(s,{class:"w-280px",value:D(c).path,"onUpdate:value":t[0]||(t[0]=e=>D(c).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),L(n,{label:e.$t("Public.Table.Model")},{default:M((()=>[L(i,{class:"w-280px",value:D(c).chattr,"onUpdate:value":t[1]||(t[1]=e=>D(c).chattr=e),options:l},null,8,["value"])])),_:1},8,["label"]),L(n,{label:e.$t("Public.Table.Permissions"),path:"d_mode"},{default:M((()=>[L(o,{class:"w-280px!",value:D(c).d_mode,"onUpdate:value":t[2]||(t[2]=e=>D(c).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),re={class:"p-20px"},ce=P({__name:"index",props:{data:{}},setup(e){const{t:a}=U(),o=e,{data:u}=o,{keys:r,table:c,columns:d}=k([{key:"path",title:a("Site.DelSite.Path")},{key:"chattr",title:a("Public.Table.Model"),render:e=>"i"==e.chattr?a("Security.Anti.Index_28"):a("Security.Anti.Index_29")},{key:"s_mode",title:a("Public.Table.Permissions"),render:e=>e.s_mode!==e.d_mode?"".concat(e.s_mode," >> ").concat(e.d_mode):e.d_mode},{key:"state",title:"Status",render:e=>L("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?a("Security.Anti.Index_35"):a("Security.Anti.Index_36")])},A({width:130,title:a("Public.Table.Operation"),options:e=>[{label:a("Site.TableOP.Del"),onClick:async()=>{await(e=>t.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:ie("Security.Api.Index_3"),successMessage:!0}}))({s_key:u.key,path:e.path}),await y()}}]})]),p=async()=>{g.data.row=u,g.show=!0},{loading:_,setLoading:m}=I(),y=async()=>{try{m(!0);const{message:e}=await(e=>t.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:u.key});s(e)&&(c.data=e.paths)}finally{r.value=[],m(!1)}};y();const g=n(a("Security.Anti.Index_30"),{getList:y});return(e,t)=>{const a=l,s=S,n=w,o=b,u=i;return R(),H("div",re,[L(o,null,{toolsLeft:M((()=>[L(a,{type:"primary",onClick:p},{default:M((()=>[z(K(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:M((()=>[L(s,{"checked-row-keys":D(r),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>B(r)?r.value=e:null),loading:D(_),"loading-num":3,"max-height":340,data:D(c).data,columns:D(d)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:M((()=>[L(n,null,{default:M((()=>[G("li",null,K(e.$t("Security.Anti.Index_31")),1),G("li",null,K(e.$t("Security.Anti.Index_32")),1),G("li",null,K(e.$t("Security.Anti.Index_33")),1),G("li",null,K(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),L(u,{show:D(g).show,"onUpdate:show":t[1]||(t[1]=e=>D(g).show=e),title:D(g).title,data:D(g).data,width:500,footer:!0,component:ue},null,8,["show","title","data"])])}}}),de={class:"p-20px"},pe={class:"leading-32px"},_e=r(P({__name:"index",setup(e){const{t:a}=U(),n=q(null),i=O({cycle:120,limit_count:3,limit:3600}),r={cycle:{required:!0,type:"number",message:a("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:a("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:a("Security.Conf.Index_28"),trigger:["blur","input"]}},c=async()=>{var e,a;await(null==(e=n.value)?void 0:e.validate()),await(a=E(i),t.post("/plugin?name=syssafe&action=a&s=save_ssh_config",a,{requestOptions:{loading:ie("Security.Api.Index_6"),successMessage:!0}}))};return(async()=>{const{message:e}=await t.post("/plugin?name=syssafe&action=a&s=get_ssh_config");s(e)&&(i.cycle=e.cycle,i.limit=e.limit,i.limit_count=e.limit_count)})(),(e,t)=>{const a=o,s=$,d=l,p=C,_=u,m=w;return R(),H("div",de,[L(p,{ref_key:"formRef",ref:n,model:D(i),rules:r,inline:"","label-width":"auto",class:"form"},{default:M((()=>[L(s,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:M((()=>[L(a,{"show-button":!1,value:D(i).cycle,"onUpdate:value":t[0]||(t[0]=e=>D(i).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),L(s,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:M((()=>[L(a,{"show-button":!1,value:D(i).limit_count,"onUpdate:value":t[1]||(t[1]=e=>D(i).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),L(s,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:M((()=>[L(a,{"show-button":!1,value:D(i).limit,"onUpdate:value":t[2]||(t[2]=e=>D(i).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),G("span",pe,K(e.$t("Security.Anti.Index_40")),1),L(d,{type:"primary",class:"ml-auto",onClick:c},{default:M((()=>[z(K(e.$t("Site.Cert.Save")),1)])),_:1})])),_:1},8,["model"]),L(_,{class:"mb-15px!"}),L(m,null,{default:M((()=>[G("li",null,K(e.$t("Security.Anti.Index_41")),1),G("li",null,K(e.$t("Security.Anti.Index_42")),1),G("li",null,K(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),[["__scopeId","data-v-58d5bb81"]]),me={class:"p-20px"},ye=P({__name:"form",props:{data:{}},setup(e,{expose:s}){const{t:n}=U(),l=e,{getList:i}=l.data,o=q(null),u=O({process_name:""}),r={process_name:{required:!0,message:n("Security.Conf.Index_28"),trigger:["blur","input"]}};return s({onConfirm:async({hide:e})=>{var a,s;await(null==(a=o.value)?void 0:a.validate()),await(s=E(u),t.post("/plugin?name=syssafe&action=a&s=add_process_white",s,{requestOptions:{loading:ie("Security.Api.Index_4"),successMessage:!0}})),null==i||i(),e()}}),(e,t)=>{const s=a,n=$,l=C;return R(),H("div",me,[L(l,{ref_key:"formRef",ref:o,model:D(u),rules:r},{default:M((()=>[L(n,{label:e.$t("Home.index_24"),path:"process_name"},{default:M((()=>[L(s,{class:"w-280px!",value:D(u).process_name,"onUpdate:value":t[0]||(t[0]=e=>D(u).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),ge={class:"p-20px"},he=P({__name:"index",setup(e){const{t:a}=U(),{keys:s,table:o,columns:u}=k([{key:"name",title:a("Home.index_24")},A({width:130,title:a("Public.Table.Operation"),options:e=>[{label:a("Site.TableOP.Del"),onClick:async()=>{var a;await(a={process_name:e.name},t.post("/plugin?name=syssafe&action=a&s=remove_process_white",a,{requestOptions:{loading:ie("Security.Api.Index_3"),successMessage:!0}})),await _()}}]})]),r=async()=>{m.show=!0},{loading:d,setLoading:p}=I(),_=async()=>{try{p(!0);const{message:e}=await t.post("/plugin?name=syssafe&action=a&s=get_process_white");c(e)&&(o.data=e.map((e=>({name:e}))))}finally{s.value=[],p(!1)}};_();const m=n(a("Security.Anti.Index_23"),{getList:_});return(e,t)=>{const a=l,n=S,c=w,p=b,_=i;return R(),H("div",ge,[L(p,null,{toolsLeft:M((()=>[L(a,{type:"primary",onClick:r},{default:M((()=>[z(K(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:M((()=>[L(n,{"checked-row-keys":D(s),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>B(s)?s.value=e:null),loading:D(d),"loading-num":3,"max-height":340,data:D(o).data,columns:D(u)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:M((()=>[L(c,null,{default:M((()=>[G("li",null,K(e.$t("Security.Anti.Index_24")),1),G("li",null,K(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),L(_,{show:D(m).show,"onUpdate:show":t[1]||(t[1]=e=>D(m).show=e),title:D(m).title,data:D(m).data,width:500,footer:!0,component:ye},null,8,["show","title","data"])])}}}),xe={class:"color-#ff3333"},fe=P({__name:"index",setup(e,{expose:a}){const{t:l}=U(),o=d(),{systemHardening:u}=ae(o),r=n(),c=n(),_=n(),{keys:m,table:y,columns:g}=k([{key:"name",width:"10%",title:l("Site.TableRow.Name")},{key:"ps",title:l("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},j({key:"open",title:l("Site.TableRow.Status"),onClick:async(e,a)=>{if(!u.value)return p.error(l("Security.Hardening.Index_6")),void f();var s;await(s={s_key:a.key},t.post("/plugin?name=syssafe&action=a&s=set_safe_status",s,{requestOptions:{loading:ie("Security.Api.Index_5"),successMessage:!0}}))}}),A({width:130,title:l("Site.TableRow.Operation"),options:e=>[{label:l("Site.TableOP.Set"),onClick:()=>"ssh"===e.key?(c.title="".concat(l("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(c.show=!0)):"process"===e.key?(_.title="".concat(l("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(_.show=!0)):(r.title="".concat(l("Security.Hardening.Index_7")," [").concat(e.name,"]"),r.data=e,void(r.show=!0))}]})]);W((()=>o.isRefresh),(e=>{e&&(o.setRefresh(!1),f())}));const{loading:h,setLoading:x}=I(),f=async()=>{try{x(!0);const{message:e}=await t.post("/plugin?name=syssafe&action=a&s=get_safe_status");s(e)&&(u.value=e.open,y.data=e.list)}finally{m.value=[],x(!1)}};return f(),a({init:f}),(e,t)=>{const a=S,s=b,n=w,l=i;return R(),H(F,null,[L(s,{feedback:!0},{table:M((()=>[L(a,{"checked-row-keys":D(m),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>B(m)?m.value=e:null),"row-key":"title",loading:D(h),data:D(y).data,columns:D(g)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),L(n,{class:"mt-16px"},{default:M((()=>[G("li",null,K(e.$t("Security.Hardening.Index_1")),1),G("li",null,K(e.$t("Security.Hardening.Index_2")),1),G("li",null,K(e.$t("Security.Hardening.Index_3")),1),G("li",xe,K(e.$t("Security.Hardening.Index_4")),1)])),_:1}),L(l,{show:D(r).show,"onUpdate:show":t[1]||(t[1]=e=>D(r).show=e),title:D(r).title,data:D(r).data,width:700,"min-height":500,footer:!1,component:ce},null,8,["show","title","data"]),L(l,{show:D(c).show,"onUpdate:show":t[2]||(t[2]=e=>D(c).show=e),title:D(c).title,data:D(c).data,width:800,footer:!1,component:_e},null,8,["show","title","data"]),L(l,{show:D(_).show,"onUpdate:show":t[3]||(t[3]=e=>D(_).show=e),title:D(_).title,data:D(_).data,width:700,"min-height":580,footer:!1,component:he},null,8,["show","title","data"])],64)}}}),ve=P({__name:"index",setup(e,{expose:s}){const{t:n}=U(),{loading:i,setLoading:o}=I(),u=q(""),r=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:d,table:m,columns:y}=k([{key:"address",title:n("Security.Anti.Index_15"),width:"70%"},{key:"end",title:n("Security.History.Index_12"),render:e=>0==e.end?n("Security.Anti.Index_18"):e.end},A({width:130,title:n("Site.TableRow.Operation"),options:e=>[{label:n("Security.Anti.Index_19"),onClick:async()=>{var a;await(a={ip:e.address},t.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",a,{requestOptions:{loading:ie("Security.Api.Index_3"),successMessage:!0}})),h()}}]})]),g=async()=>{var e;r.test(u.value)?(await(e={ip:u.value},t.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:ie("Security.Api.Index_4"),successMessage:!0}})),h(),u.value=""):p.error(n("Security.Anti.Index_20"))},h=async()=>{try{o(!0);const{message:e}=await t.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");c(e)&&(m.data=e)}finally{d.value=[],o(!1)}};return h(),s({init:h}),(e,t)=>{const s=a,n=l,o=_,r=S,c=b,p=w;return R(),H("div",null,[L(c,null,{toolsLeft:M((()=>[L(o,{class:"flex-nowrap!"},{default:M((()=>[L(s,{value:D(u),"onUpdate:value":t[0]||(t[0]=e=>B(u)?u.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),L(n,{type:"primary",onClick:g},{default:M((()=>[z(K(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:M((()=>[L(r,{"checked-row-keys":D(d),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>B(d)?d.value=e:null),"row-key":"address",loading:D(i),"max-height":440,data:D(m).data,columns:D(y)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),L(p,{class:"mt-16px"},{default:M((()=>[G("li",null,K(e.$t("Security.Anti.Index_16")),1),G("li",null,K(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),we=P({__name:"index",setup(e,{expose:a}){const{t:n}=U(),{keys:l,table:i,columns:o}=k([{key:"addtime",title:n("Public.Table.Date"),width:"20%"},{key:"log",title:n("Security.Anti.Index_21")}]),u=O({p:1,limit:10,search:"System hardening"}),{loading:r,setLoading:c}=I(),d=async()=>{try{c(!0);const{message:a}=await(e=E(u),t.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));s(a)&&(i.data=a.data,i.total=m(a.page))}finally{l.value=[],c(!1)}var e};return d(),a({init:d}),(e,t)=>{const a=S,s=se,n=b;return R(),N(n,{feedback:!0},{table:M((()=>[L(a,{"checked-row-keys":D(l),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>B(l)?l.value=e:null),"row-key":"addtime",loading:D(r),data:D(i).data,columns:D(o)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:M((()=>[L(s,{page:D(u).p,"onUpdate:page":t[1]||(t[1]=e=>D(u).p=e),"page-size":D(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>D(u).limit=e),"item-count":D(i).total,"store-key":"security-log",onRefresh:d},null,8,["page","page-size","item-count"])])),_:1})}}}),be=P({__name:"index",setup(e){const{t:t}=U(),a=q("protection"),s=[{key:"protection",label:t("Security.Tabs.Index_8"),component:fe},{key:"block",label:t("Security.Tabs.Index_9"),component:ve},{key:"operation",label:t("Security.Tabs.Index_10"),component:we}];return(e,t)=>{const n=v;return R(),N(n,{value:D(a),"onUpdate:value":t[0]||(t[0]=e=>B(a)?a.value=e:null),options:s},null,8,["value"])}}}),ke=e=>(J("data-v-ec798fd8"),e=e(),X(),e),Se={class:"pt-40px pb-40px"},Ie=ke((()=>G("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1))),Ae={class:"mb-16px"},je={class:"ul-style"},$e=ke((()=>G("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))),Ce=ke((()=>G("span",null,"Harden the system security configuration",-1))),Te={class:"text-center my-24px"},Pe={class:"flex justify-center"},Ue={class:"item"},qe=["onClick"],Oe=r(P({__name:"conversion",setup(e){const t=q(0),a=["Protection","Block IP","Operation logs"],s=()=>{y({source:102})};return(e,n)=>{const i=g,o=l,u=ne,r=h;return R(),N(r,null,{default:M((()=>[G("div",Se,[Ie,G("div",Ae,[G("ul",je,[G("li",null,[L(i,{name:"security-system",size:"18"}),$e]),G("li",null,[L(i,{name:"security-surety",size:"30"}),Ce])])]),G("div",Te,[L(o,{type:"primary",class:"h-36px text-14px",onClick:s},{default:M((()=>[z(K(e.$t("WP.Transition.index_7")),1)])),_:1})]),G("div",Pe,[G("div",Ue,[G("ul",null,[(R(),H(F,null,Q(a,((e,a)=>G("li",{class:Y({active:D(t)==a}),key:a,onClick:e=>t.value=a},K(e),11,qe))),64))])]),V(L(u,{width:"100%",src:D("/static/vite/images/protection.png")},null,8,["src"]),[[Z,0==D(t)]]),V(L(u,{width:"100%",src:D("/static/vite/images/block.png")},null,8,["src"]),[[Z,1==D(t)]]),V(L(u,{width:"100%",src:D("/static/vite/images/log.png")},null,8,["src"]),[[Z,2==D(t)]])])])])),_:1})}}}),[["__scopeId","data-v-ec798fd8"]]),Re={key:0},He=P({__name:"index",setup(e){const a=x(),{isPro:s}=ae(a),n=d(),{systemHardening:l}=ae(n),i=q(l.value),o=ee((()=>l.value));W(o,(e=>{i.value=e}));const u=async()=>{await t.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:ie("Security.Api.Index_5"),successMessage:!0}}),await n.setRefresh(!0)};return(async()=>{s.value&&await f("syssafe")})(),(e,t)=>{const a=le,n=_,l=h;return D(s)?(R(),H("div",Re,[L(l,{class:"my-15px"},{default:M((()=>[L(n,{class:"p-15px items-center"},{default:M((()=>[G("span",null,K(e.$t("Security.Anti.Index_14")),1),L(a,{value:D(i),"onUpdate:value":[t[0]||(t[0]=e=>B(i)?i.value=e:null),u],"rubber-band":!1},null,8,["value"])])),_:1})])),_:1}),L(l,{class:"p-15px"},{default:M((()=>[L(be)])),_:1})])):(R(),N(Oe,{key:1}))}}});export{He as default};
