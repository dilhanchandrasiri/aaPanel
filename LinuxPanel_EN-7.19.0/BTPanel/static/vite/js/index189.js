import{_ as e}from"./index96.js?v=1732601582185";import{_ as a}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{_ as i}from"./index187.js?v=1732601582185";import{d as l,W as t,t as n,r as c,e as s,j as o,$ as d,O as _,P as r,M as u,Y as f,Q as m,R as p,k as x,Z as v,v as b,c as g,F as y}from"./vue.js?v=1732601582185";import{f as C,m as S,I as W}from"./page_layout.js?v=1732601582185";import{a as w}from"./public.js?v=1732601582185";import{d as $}from"./setting.js?v=1732601582185";import{f as h,h as j,i as U,j as k}from"./site3.js?v=1732601582185";import{bL as P,bG as E,bl as N,aa as O,bU as R}from"./naive.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./common.js?v=1732601582185";const T={class:"p-20px"},A={class:"flex-1"},B={class:"w-160px"},D={class:"w-160px mr-8px"},F={class:"text-#666"},G={class:"mb-4px"},H={class:"mb-10px"},I={class:"mb-4px"},J={class:"mb-10px"},L={class:"mb-4px"},M={class:"mb-10px"},Q={class:"mb-4px"},Y={class:"w-160px mr-8px"},Z={class:"text-desc"},q={class:"w-160px mr-8px"},z={class:"text-desc"},K={class:"w-160px mr-8px"},V={class:"text-desc"},X={class:"w-160px"},ee={class:"w-240px"},ae={class:"flex-1"},ie={class:"w-160px"},le={class:"text-error"},te={class:"text-error"},ne={class:"text-error"},ce={class:"text-error"},se={class:"text-error"},oe={class:"text-error"},de={class:"text-error"},_e=l({__name:"index",props:{siteName:{},config:{}},emits:["refresh"],setup(l,{expose:_e,emit:re}){const ue=l,fe=re,{t:me}=t(),pe=n(ue,"siteName"),xe=c(null),ve=s((()=>void 0===pe.value)),be=o({cc_mode:1,cc_type_status:2,cycle:60,limit:120,endtime:1800,is_cc_url:1,cc_enhance_mode:1,increase_wu_heng:1,country:[],cc_increase_type:"js"}),ge={cycle:{trigger:["blur","input"],validator:()=>be.cycle?!(be.cycle<30)||new Error(me("Waf.Site.Config.index_35")):new Error(me("Waf.Site.Config.index_34"))},limit:{trigger:["blur","input"],validator:()=>be.limit?!(be.limit<30)||new Error(me("Waf.Site.Config.index_35")):new Error(me("Waf.Site.Config.index_36"))},endtime:{trigger:["blur","input"],validator:()=>!!be.endtime||new Error(me("Waf.Site.Config.index_37"))}},ye=[{label:me("Waf.Site.Config.index_38"),value:1},{label:me("Waf.Site.Config.index_39"),value:2}],Ce=[{label:me("Waf.Site.Config.index_40"),value:1},{label:me("Waf.Site.Config.index_41"),value:2},{label:me("Waf.Site.Config.index_42"),value:3},{label:me("Waf.Site.Config.index_43"),value:4}],Se=[{label:me("Public.Status.Enable"),value:1},{label:me("Public.Status.Disable"),value:0}],We=c([{label:me("Waf.Site.Config.index_46"),value:"browser"},{label:me("Waf.Site.Config.index_47"),value:"js"},{label:me("Waf.Site.Config.index_48"),value:"code"},{label:me("Waf.Site.Config.index_49"),value:"renji"},{label:me("Waf.Site.Config.index_50"),value:"huadong"}]),we=c([]),$e=()=>{be.country=we.value.map((e=>"".concat(e.value)))},he=()=>{be.country=[]};let je=!1;const Ue=async e=>{if("renji"===e&&!je){const{message:e}=await h();je=!0,C(e)&&e.result&&(be.cc_increase_type="js",We.value[3].disabled=!0,We.value[4].disabled=!0,S.error(me("Waf.Site.Config.index_51")))}},ke=async()=>{const{close:e}=S.loading(me("Waf.Site.Config.index_52",[ve.value?me("Waf.Site.Config.index_99"):me("Waf.Site.Config.index_100")]));try{const e=(()=>{const e=1===be.cc_mode?{country:be.country.join(","),is_cc_url:be.is_cc_url}:{};return{cc_mode:1===be.cc_mode?1:be.cc_enhance_mode?3:4,cycle:be.cycle,limit:be.limit,endtime:be.endtime,is_open_global:void 0===pe.value?1:0,increase:0===be.cc_enhance_mode?0:1,increase_wu_heng:be.increase_wu_heng,cc_increase_type:be.cc_increase_type,cc_type_status:be.cc_type_status,...e}})();3!==e.cc_mode&&await U(),ve.value?await $(e):await k({...e,siteName:pe.value||""}),fe("refresh")}finally{e()}};return(async()=>{const{message:e}=await j();W(e)&&(we.value=e.map((e=>({label:e,value:e}))))})(),(()=>{const{config:e}=ue;e&&(be.cc_mode=e.cc_mode<=1?1:2,be.cc_type_status=e.cc_type_status,be.cycle=e.cc.cycle,be.limit=e.cc.limit,be.endtime=e.cc.endtime,be.is_cc_url=e.cc.is_cc_url?1:0,be.cc_increase_type=e.cc.cc_increase_type||"js",be.country=Object.keys(e.cc.countrys))})(),_e({onConfirm:async({hide:e})=>{var a;if(await(null==(a=xe.value)?void 0:a.validate()),2===be.cc_mode)return w({title:me("Public.Confirm.Title"),content:()=>u(y,null,[me("Waf.Site.Config.desc_9"),u("br",null,null),me("Waf.Site.Config.desc_10"),u("br",null,null),me("Waf.Site.Config.desc_11")]),onConfirm:async({hide:a})=>(await ke(),a(),e(),!1)}),!1;await ke()}}),(l,t)=>{const n=P,c=E,s=i,o=N,y=O,C=R,S=a,W=d("i18n-t"),w=e;return _(),r("div",T,[u(S,{ref_key:"formRef",ref:xe,model:p(be),rules:ge,"label-width":"160"},{default:f((()=>[u(c,{label:l.$t("Waf.Site.Config.index_11")},{default:f((()=>[m("div",A,[m("div",B,[u(n,{value:p(be).cc_mode,"onUpdate:value":t[0]||(t[0]=e=>p(be).cc_mode=e),options:ye},null,8,["value"])]),x(m("div",{class:"w-320px mt-6px text-desc leading-20px"},v(l.$t("Waf.Site.Config.index_12")),513),[[b,2===p(be).cc_mode]])])])),_:1},8,["label"]),u(c,{label:l.$t("Waf.Site.Config.index_13")},{default:f((()=>[m("div",D,[u(n,{value:p(be).cc_type_status,"onUpdate:value":t[1]||(t[1]=e=>p(be).cc_type_status=e),options:Ce,"consistent-menu-width":!1},null,8,["value"])]),u(s,null,{default:f((()=>[m("div",F,[m("div",G,[m("b",null,v(l.$t("Waf.Site.Config.desc_1")),1)]),m("div",H,v(l.$t("Waf.Site.Config.desc_2")),1),m("div",I,[m("b",null,v(l.$t("Waf.Site.Config.desc_3")),1)]),m("div",J,v(l.$t("Waf.Site.Config.desc_4")),1),m("div",L,[m("b",null,v(l.$t("Waf.Site.Config.desc_5")),1)]),m("div",M,v(l.$t("Waf.Site.Config.desc_6")),1),m("div",Q,[m("b",null,v(l.$t("Waf.Site.Config.desc_7")),1)]),m("div",null,v(l.$t("Waf.Site.Config.desc_8")),1)])])),_:1})])),_:1},8,["label"]),u(c,{label:l.$t("Waf.Site.Config.index_14"),path:"cycle"},{default:f((()=>[m("div",Y,[u(o,{value:p(be).cycle,"onUpdate:value":t[2]||(t[2]=e=>p(be).cycle=e),min:30,"show-button":!1},null,8,["value"])]),m("span",Z,v(l.$t("Public.Unit.Second",p(be).cycle)),1)])),_:1},8,["label"]),u(c,{label:l.$t("Waf.Site.Config.index_16"),path:"limit"},{default:f((()=>[m("div",q,[u(o,{value:p(be).limit,"onUpdate:value":t[3]||(t[3]=e=>p(be).limit=e),min:30,"show-button":!1},null,8,["value"])]),m("span",z,v(l.$t("Public.Unit.Time",p(be).limit)),1)])),_:1},8,["label"]),u(c,{label:l.$t("Waf.Site.Config.index_18"),path:"endtime"},{default:f((()=>[m("div",K,[u(o,{value:p(be).endtime,"onUpdate:value":t[4]||(t[4]=e=>p(be).endtime=e),min:1,"show-button":!1},null,8,["value"])]),m("span",V,v(l.$t("Public.Unit.Second",p(be).endtime)),1)])),_:1},8,["label"]),x(m("div",null,[u(c,{label:l.$t("Waf.Site.Config.index_19")},{default:f((()=>[m("div",X,[u(n,{value:p(be).is_cc_url,"onUpdate:value":t[5]||(t[5]=e=>p(be).is_cc_url=e),options:Se},null,8,["value"])])])),_:1},8,["label"]),u(c,{label:l.$t("Waf.Site.Config.index_20"),"show-feedback":!1},{default:f((()=>[m("div",ee,[u(n,{value:p(be).country,"onUpdate:value":t[6]||(t[6]=e=>p(be).country=e),options:p(we),multiple:!0,filterable:!0,"max-tag-count":"responsive",":placeholder":l.$t("Waf.Site.Config.index_21")},{header:f((()=>[u(C,{class:"w-full"},{default:f((()=>[u(y,{class:"flex-1",onClick:$e},{default:f((()=>[g(v(l.$t("Public.All")),1)])),_:1}),u(y,{class:"flex-1",onClick:he},{default:f((()=>[g(v(l.$t("Public.Btn.Cancel")),1)])),_:1})])),_:1})])),_:1},8,["value","options",":placeholder"])])])),_:1},8,["label"])],512),[[b,1===p(be).cc_mode]]),x(m("div",null,[u(c,{label:l.$t("Waf.Site.Config.index_22"),"show-feedback":!1},{default:f((()=>[m("div",ae,[m("div",ie,[u(n,{value:p(be).cc_increase_type,"onUpdate:value":[t[7]||(t[7]=e=>p(be).cc_increase_type=e),Ue],options:p(We)},null,8,["value","options"])]),x(m("div",{class:"mt-6px text-error"},v(l.$t("Waf.Site.Config.index_23")),513),[[b,"code"===p(be).cc_increase_type]])])])),_:1},8,["label"])],512),[[b,2===p(be).cc_mode]])])),_:1},8,["model"]),u(w,{class:"mt-20px"},{default:f((()=>[m("li",le,v(l.$t("Waf.Site.Config.index_24")),1),x(m("li",{class:"text-error"},v(l.$t("Waf.Site.Config.index_102")),513),[[b,2===p(be).cc_mode]]),u(W,{tag:"li",keypath:"Waf.Site.Config.index_97",scope:"global"},{index_1:f((()=>[m("span",te,v(p(be).limit),1)])),index_2:f((()=>[m("span",ne,v(p(be).cycle),1)])),index_3:f((()=>[m("span",ce,v(p(be).endtime),1)])),_:1}),x(m("li",{class:"text-error"},v(l.$t("Waf.Site.Config.index_29")),513),[[b,1===p(be).cc_mode]]),u(W,{tag:"li",keypath:"Waf.Site.Config.index_98",scope:"global"},{index_1:f((()=>t[8]||(t[8]=[m("span",{class:"text-error"},"JS",-1)]))),index_2:f((()=>[m("span",se,v(p(be).cycle),1)])),index_3:f((()=>[m("span",oe,v(l.config.retry),1)])),index_4:f((()=>[m("span",de,v(p(be).endtime),1)])),_:1})])),_:1})])}}});export{_e as default};
