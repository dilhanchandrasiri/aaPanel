import{_ as e}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{_ as a,f as l,S as t}from"./page_layout.js?v=1732601582185";import{a as s}from"./file.js?v=1732601582185";import{d as i,b as n}from"./public.js?v=1732601582185";import{_ as o,bq as c,be as r,c1 as d,aa as p,bh as u}from"./naive.js?v=1732601582185";import{d as m,W as f,r as v,M as x,O as h,P as _,Y as y,c as k,Z as b,Q as g,R as C,F as w,L as P}from"./vue.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";const j={class:"flex flex-col h-full"},S={class:"flex-1 w-0 truncate"},z={class:"flex flex-1 overflow-hidden"},D={class:"w-160px py-12px overflow-auto"},I=["onClick"],E={class:"flex-1 ml-8px"},L={class:"flex-1","b-l":"1 solid #aaa"},F=m({__name:"index",props:{data:{}},setup(m,{expose:F}){const{t:H}=f(),O=m,{path:R,checkedType:T,callback:$}=O.data,q=v([]),A=v([]),K=v(R||"/"),{table:M,columns:Q}=i([{key:"checkbox",title:"",width:36,render:e=>T.includes(e.type)?x("div",{onClick:e=>{e.stopPropagation()}},[x(o,{checked:e.filename===A.value[0],onUpdateChecked:a=>{A.value=a?[e.filename]:[]}},null)]):""},{key:"filename",title:H("Component.SelectPath.index_3"),render:e=>x("div",{class:"flex"},[x("div",{class:"flex items-center flex-1 cursor-pointer",onClick:a=>{"dir"===e.type&&(a.preventDefault(),K.value+="".concat("/"===K.value?"":"/").concat(e.filename),B(),a.stopPropagation())}},[x("div",null,["dir"===e.type?x(a,{name:"base-dir",size:"16"},null):"","file"===e.type?x(a,{name:"base-file",size:"16",color:"#666"},null):""]),x("div",{class:"ml-6px flex-1 w-0"},[x(c,null,{default:()=>[e.filename]})])])])},{key:"time",title:H("Component.SelectPath.index_4"),width:146},{key:"permission",title:H("Component.SelectPath.index_5"),width:86},{key:"owner",title:H("Component.SelectPath.index_6"),width:72}]),U=e=>({onClick:()=>{if(T.includes(e.type)){const a=d(A.value,(a=>a===e.filename));A.value=-1!==a?[]:[e.filename]}},onDblclick:()=>{T.includes(e.type)&&(K.value+="".concat("/"===K.value?"":"/").concat(e.filename),B())}}),W=()=>{const e=K.value.substring(0,K.value.lastIndexOf("/"));K.value=""===e?"/":e,B()},{loading:Y,setLoading:Z}=n(),B=async()=>{try{Z(!0),M.data=[],A.value=[];const{message:e}=await s({path:K.value});if(l(e)){const a=[],l=r(e,"DIR",[]),t=r(e,"FILES",[]);l.forEach((e=>{a.push(G(e,"dir"))})),t.forEach((e=>{a.push(G(e,"file"))})),K.value=e.PATH,M.data=a,q.value=r(e,"DISK",[])}}finally{Z(!1)}},G=(e,a)=>{const l=e.split(";"),s=l[0],i=t(l[2]),n=l[3],o=l[4];return{path:("/"!==K.value?K.value+"/":"")+s,filename:s,time:i,permission:n,owner:o,type:a}};return B(),F({onConfirm:({hide:e})=>{const a=A.value.length>0?A.value[0]:"",l=("/"!==K.value?K.value+"/":"")+a,t=M.data.find((e=>e.filename===a));null==$||$(l,t),e()}}),(l,t)=>{const s=p,i=u,n=e;return h(),_("div",j,[x(i,{class:"items-center h-50px px-12px","b-b":"1 solid #aaa"},{default:y((()=>[x(s,{onClick:W},{default:y((()=>[k(b(l.$t("Component.SelectPath.index_1")),1)])),_:1}),g("div",S,b(l.$t("Component.SelectPath.index_2"))+": "+b(C(K)),1)])),_:1}),g("div",z,[g("div",D,[(h(!0),_(w,null,P(C(q),(e=>(h(),_("div",{key:e.path,class:"flex items-center p-8px pl-16px hover:bg-#ececec cursor-pointer transition-colors",onClick:a=>{return l=e.path,K.value=l,void B();var l}},[x(a,{name:"file-disk",size:"18",color:"#666"}),g("div",E,b(e.path)+" "+b(e.size[2]?"(".concat(e.size[2],")"):""),1)],8,I)))),128))]),g("div",L,[x(n,{loading:C(Y),"loading-num":10,bordered:!1,"virtual-scroll":!0,"max-height":456,data:C(M).data,columns:C(Q),"row-props":U},null,8,["loading","data","columns"])])])])}}});export{F as default};
