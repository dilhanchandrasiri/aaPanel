import{_ as e}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{bB as t,I as a}from"./page_layout.js?v=1732601582185";import{d as i,f as o}from"./public.js?v=1732601582185";import{g as s}from"./index73.js?v=1732601582185";import{s as l}from"./tools.js?v=1732601582185";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang15.js?v=1732601582185";import{d as n,t as p,W as c,aA as d,O as u,P as m,M as _,R as f,Q as x}from"./vue.js?v=1732601582185";import"./naive.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./rules.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import"./index99.js?v=1732601582185";const v={class:"h-full"},y=n({__name:"details-count",props:{data:{default:()=>({})}},setup(e){const t=p(e,"data"),{t:a}=c(),i=d({backgroundColor:"#fff",title:s(),tooltip:{trigger:"item",confine:!0,formatter(e){const t=e;return"".concat(t.marker," ").concat(t.name,": ").concat(t.value," (").concat(t.percent,"%)")}},series:l()}),o=["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"];function s(e=0){return{text:a("Waf.Report.index_17"),textStyle:{color:"#484848",fontSize:17},subtext:"".concat(e),subtextStyle:{color:"#717171",fontSize:15},itemGap:20,left:"center",top:"42%"}}function l(e=[]){return[{type:"pie",data:e,radius:["50%","60%"],center:["50%","50%"],clockwise:!0,avoidLabelOverlap:!0,label:{show:!0,position:"outside",color:"#999",lineHeight:18,formatter:e=>""!==e.name?0===e.percent?"":a("Waf.Overview.index_33",[e.name,e.value,e.percent]):""},labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},itemStyle:{labelLine:{length:30,length2:30,lineStyle:{width:1,color:"#CDCDCD"}},color:e=>o[e.dataIndex]},emphasis:{scaleSize:15}}]}return(()=>{let e=0;const a=[];Object.entries(t.value).forEach((([t,i])=>{e+=i,a.push({name:t,value:i})})),i.title=s(e),i.series=l(a)})(),(e,t)=>(u(),m("div",v,[_(r,{type:"pie",height:"100%",option:f(i)},null,8,["option"])]))}}),h={class:"h-full"},b=n({__name:"details-uri",props:{data:{default:()=>[]}},setup(e){const a=p(e,"data"),{t:i}=c(),o=d({backgroundColor:"#fff",tooltip:{trigger:"item",axisPointer:{type:"shadow",label:{color:"#fff",fontSize:"26"}},formatter(e){const a=e;return'<div style="max-width: 400px;">'.concat(a.marker," ").concat(t(a.seriesName||""),"</div>\n\t\t\t<div>").concat(i("Waf.Report.index_16",[a.data]),"</div>")}},legend:{top:"0%",data:a.value.slice(0,4).map((e=>e.name)),textStyle:{fontSize:12,color:"#808080"},icon:"rect"},grid:{top:60,left:60,right:0,bottom:50},xAxis:[{type:"category",axisLabel:{color:"#4D4D4D",fontSize:14,fontWeight:"bold"},data:[i("Waf.Report.index_15")]}],yAxis:[{type:"value",axisLine:{show:!1},axisTick:{show:!1},splitNumber:4,axisLabel:{color:"#8C8C8C"},splitLine:{lineStyle:{type:"dashed"}}}],color:["#4fa8f9","#6ec71e","#f56e6a","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"],series:a.value.slice(0,4).map((e=>({name:e.name,type:"bar",label:{show:!0,position:"top"},barMaxWidth:60,data:[e.value]})))});return(e,t)=>(u(),m("div",h,[_(r,{type:"bar",height:"100%",option:f(o)},null,8,["option"])]))}}),g={class:"p-20px"},j={class:"flex h-280px mb-16px"},w={class:"w-410px"},S={class:"w-500px"},k=n({__name:"details",props:{row:{}},setup(r){const n=p(r,"row"),{t:d}=c(),{table:v,columns:h}=i([{key:"time_localtime",title:d("Waf.Report.index_13"),width:140},{key:"server_name",title:d("Waf.Report.index_14"),ellipsis:{tooltip:!0}},{key:"ip_country",title:d("Waf.Report.index_8"),render:e=>e.ip_country||"--"},{key:"URI",title:"URI",ellipsis:{tooltip:!0},render:e=>t(e.uri)||"--"},{key:"filter_rule",title:d("Waf.Report.index_34"),width:140},o({width:80,options:e=>[{label:d("Public.Btn.Details"),onClick:async()=>{const{message:t}=await s({id:e.id});a(t)&&t.length>0&&l(t[0])}}]})]);v.data=n.value.data.list;const k=n.value.data.uri.map((e=>({name:e[0],value:e[1]})));return(t,a)=>{const i=e;return u(),m("div",g,[x("div",j,[x("div",w,[_(y,{data:f(n).data.type},null,8,["data"])]),x("div",S,[_(b,{data:f(k)},null,8,["data"])])]),_(i,{"max-height":300,data:f(v).data,columns:f(h)},null,8,["data","columns"])])}}});export{k as default};
