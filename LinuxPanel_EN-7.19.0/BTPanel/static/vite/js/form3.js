import{_ as e}from"./index96.js?v=1732601582185";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{_ as l}from"./index99.js?v=1732601582185";import{d as a,W as t,r as o,j as i,O as s,P as p,M as u,Y as d,Q as n,R as c,k as _,v as m,Z as f}from"./vue.js?v=1732601582185";import{e as v,a as w}from"./index55.js?v=1732601582185";import{bL as y,bG as b,ad as h}from"./naive.js?v=1732601582185";import"./page_layout.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./public.js?v=1732601582185";import"./index121.js?v=1732601582185";import"./index102.js?v=1732601582185";import"./index.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang11.js?v=1732601582185";import"./file.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";const P={class:"p-20px"},S={class:"w-240px"},x={class:"w-240px"},F={class:"w-240px"},j={class:"w-240px"},g={class:"w-240px"},$={class:"w-240px"},U={class:"w-240px"},E={class:"w-240px"},T=a({__name:"form",props:{row:{},isEdit:{type:Boolean,default:!1}},emits:["refresh"],setup(a,{expose:T,emit:I}){const C=a,k=I,{t:A}=t(),{isEdit:O,row:D}=C,N=o(null),R=i({protocol:"tcp",port:"",choose:"all",address:"",domain:"",types:"accept",chain:"INPUT",brief:""}),B={port:{trigger:["blur","input"],validator:()=>{const e=R.port.split(","),r=/^\d+$/;for(let l of e)if(r.test(l)){const e=parseInt(l,10);if(e<1||e>65535)return new Error(A("Security.Firewall.Port.form_15"))}else{if(!l.includes("-"))return""==l?new Error(A("Security.Firewall.Port.form_16")):new Error(A("Security.Firewall.Port.form_15"));{const e=l.split("-"),r=parseInt(e[0],10),a=parseInt(e[1],10);if(r<1||a>65535||r>a)return new Error(A("Security.Firewall.Port.form_15"))}}return!0}},address:{trigger:["blur","input"],validator:()=>!!("point"!==R.choose||""!==R.address.trim()&&R.address)||new Error(A("Security.Firewall.Port.form_18"))},domain:{trigger:["blur","input"],validator:()=>!!("domain"!==R.choose||""!==R.domain.trim()&&R.domain)||new Error(A("Security.Firewall.Port.form_19"))}},G=[{label:"TCP",value:"tcp"},{label:"UDP",value:"udp"},{label:"TCP/UDP",value:"all"}],H=[{label:A("Security.Firewall.Port.form_20"),value:"all"},{label:A("Security.Firewall.Port.form_5"),value:"point"}],L=[{label:A("Security.Firewall.Port.form_21"),value:"accept"},{label:A("Security.Firewall.Port.form_22"),value:"drop"}],M=[{label:A("Security.Firewall.Port.form_23"),value:"INPUT"},{label:A("Security.Firewall.Port.form_24"),value:"OUTPUT"}];return O&&D&&(R.protocol=D.Protocol,R.port=D.Port,R.choose="all"===D.Address?"all":""===D.domain?"point":"domain",R.address="all"===D.Address?"":D.Address,R.domain=D.domain,R.types=D.Strategy,R.chain=D.Chain,R.brief=D.brief),T({onConfirm:async()=>{var e;await(null==(e=N.value)?void 0:e.validate());const r=(()=>{let e={protocol:R.protocol,port:R.port,choose:R.choose,domain:"domain"===R.choose?R.domain:"",types:R.types,strategy:R.types,chain:R.chain,brief:R.brief};return"point"===e.choose&&(e=Object.assign(e,{address:R.address})),e})();O&&D?await v({new_data:r,old_data:D}):await w(r),k("refresh")}}),(a,t)=>{const o=y,i=b,v=h,w=l,T=r,I=e;return s(),p("div",P,[u(T,{ref_key:"formRef",ref:N,model:c(R),rules:B},{default:d((()=>[u(i,{label:a.$t("Security.Firewall.Port.form_1"),path:"protocol"},{default:d((()=>[n("div",S,[u(o,{value:c(R).protocol,"onUpdate:value":t[0]||(t[0]=e=>c(R).protocol=e),options:G},null,8,["value"])])])),_:1},8,["label"]),u(i,{label:a.$t("Security.Firewall.Port.form_2"),path:"port"},{default:d((()=>[n("div",x,[u(v,{value:c(R).port,"onUpdate:value":t[1]||(t[1]=e=>c(R).port=e),disabled:c(O),placeholder:a.$t("Security.Firewall.Port.form_3")},null,8,["value","disabled","placeholder"])])])),_:1},8,["label"]),u(i,{label:a.$t("Security.Firewall.Port.form_4"),path:"choose"},{default:d((()=>[n("div",F,[u(o,{value:c(R).choose,"onUpdate:value":t[2]||(t[2]=e=>c(R).choose=e),options:H},null,8,["value"])])])),_:1},8,["label"]),_(u(i,{label:a.$t("Security.Firewall.Port.form_5"),path:"address"},{default:d((()=>[n("div",j,[u(w,{value:c(R).address,"onUpdate:value":t[3]||(t[3]=e=>c(R).address=e),rows:3,placeholder:a.$t("Security.Firewall.Port.form_6")},null,8,["value","placeholder"])])])),_:1},8,["label"]),[[m,"point"===c(R).choose]]),_(u(i,{label:a.$t("Security.Firewall.Port.form_7"),path:"domain"},{default:d((()=>[n("div",g,[u(w,{value:c(R).domain,"onUpdate:value":t[4]||(t[4]=e=>c(R).domain=e),rows:3,placeholder:a.$t("Security.Firewall.Port.form_8")},null,8,["value","placeholder"])])])),_:1},8,["label"]),[[m,"domain"===c(R).choose]]),u(i,{label:a.$t("Security.Firewall.Port.form_9"),path:"types"},{default:d((()=>[n("div",$,[u(o,{value:c(R).types,"onUpdate:value":t[5]||(t[5]=e=>c(R).types=e),options:L},null,8,["value"])])])),_:1},8,["label"]),u(i,{label:a.$t("Security.Firewall.Port.form_10"),path:"types"},{default:d((()=>[n("div",U,[u(o,{value:c(R).chain,"onUpdate:value":t[6]||(t[6]=e=>c(R).chain=e),options:M},null,8,["value"])])])),_:1},8,["label"]),u(i,{label:a.$t("Security.Firewall.Port.form_11"),path:"brief","show-feedback":!1},{default:d((()=>[n("div",E,[u(v,{value:c(R).brief,"onUpdate:value":t[7]||(t[7]=e=>c(R).brief=e),placeholder:a.$t("Security.Firewall.Port.form_12")},null,8,["value","placeholder"])])])),_:1},8,["label"])])),_:1},8,["model"]),u(I,{class:"mt-20px ml-40px"},{default:d((()=>[n("li",null,f(a.$t("Security.Firewall.Port.form_13")),1),n("li",null,f(a.$t("Security.Firewall.Port.form_14")),1)])),_:1})])}}});export{T as default};
