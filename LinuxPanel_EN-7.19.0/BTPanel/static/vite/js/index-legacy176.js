System.register(["./page_layout-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1732601582185","./index-legacy99.js?v=1732601582185","./vue-legacy.js?v=1732601582185","./public-legacy.js?v=1732601582185","./mail-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy16.js?v=1732601582185","./upload-legacy.js?v=1732601582185","./naive-legacy.js?v=1732601582185","./common-legacy.js?v=1732601582185","./__commonjsHelpers__-legacy.js?v=1732601582185"],(function(e,a){"use strict";var t,l,n,s,i,u,d,r,c,o,_,p,v,f,m,b,M,x,h,w,g,y,$,j,k,U,E,T,C,B,H,P,R,S,O,Q,q,z,D,F,G,I,W;return{setters:[e=>{t=e.f,l=e.c,n=e.ar,s=e.j},e=>{i=e._},e=>{u=e._},e=>{d=e.d,r=e.ap,c=e.aq,o=e.O,_=e.P,p=e.Q,v=e.M,f=e.Y,m=e.c,b=e.Z,M=e.ad,x=e.m,h=e.W,w=e.r,g=e.X,y=e.R,$=e.j,j=e.k,k=e.v,U=e.a6,E=e.F},e=>{T=e.u},e=>{C=e.a6,B=e.a7,H=e.a8,P=e.a9,R=e.aa},e=>{S=e._},e=>{O=e.o},e=>{Q=e.aa,q=e.bR,z=e.ad,D=e.bG,F=e.b$,G=e.bQ,I=e.bo,W=e.bl},null,null],execute:function(){const X={class:"flex items-center mb-8px"},Y={class:"ml-40px"},Z=d({__name:"import",props:r({path:{default:""},accept:{default:()=>[]}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const a=e,{path:t,accept:l}=a,n=c(e,"value"),s=()=>{O({path:t,size:5,uploadData:{accept:l.map((e=>`.${e}`)).join(","),multiple:!1},onUploadSuccess:e=>{n.value=e[0].name}})};return(e,a)=>{const t=Q;return o(),_("div",null,[p("div",X,[v(t,{onClick:s},{default:f((()=>[m(b(e.$t("Public.Btn.Import")),1)])),_:1}),p("div",Y,[m(b(e.$t("Mail.Mass.index_43"))+" ",1),p("span",{class:M(n.value?"text-primary":"text-error")},b(n.value||e.$t("Mail.Mass.index_44")),3)])]),x(e.$slots,"default")])}}}),A=d({__name:"table",props:{data:{default:()=>[]}},setup(e){const{t:a}=h(),t=w([{key:"domain",title:a("Mail.Mass.index_45"),ellipsis:!0},{key:"count",title:a("Mail.Mass.index_46"),width:240}]);return(e,a)=>{const l=q;return o(),g(l,{"max-height":240,data:e.data,columns:y(t)},null,8,["data","columns"])}}}),J={class:"p-20px"},K={class:"w-320px"},L={class:"w-320px"},N={class:"w-320px"},V={class:"w-320px"},ee={class:"w-60px ml-24px"},ae={class:"w-530px"};e("default",d({__name:"index",props:{isEdit:{type:Boolean,default:!1},row:{}},emits:["refresh"],setup(e,{expose:d,emit:r}){const c=e,M=r,{t:x}=h(),g=w(null),O=$({task_name:"",addresser:null,file_recipient:"",subject:"",forward_user:"",up_content:1,file_content:"",content:"",is_record:0,unsubscribe:0,threadsType:0,threads:1,ip:"",port:null}),q={task_name:{trigger:["blur","input"],validator:()=>""!==O.task_name.trim()||new Error(x("Mail.Mass.index_38"))},file_recipient:{validator:()=>""!==O.file_recipient||new Error(x("Mail.Mass.index_39"))},subject:{validator:()=>""!==O.file_recipient||new Error(x("Mail.Mass.index_40"))},file_content:{validator:()=>1!==O.up_content||""!==O.file_content||new Error(x("Mail.Mass.index_41"))},content:{validator:()=>0!==O.up_content||""!==O.content.trim()||new Error(x("Mail.Mass.index_41"))}},X=w([]),Y=w(5),te=async(e,a=!0)=>{if(!e)return;a&&await C({file:e});const{message:l}=await B({file:e});if(t(l)){let e=0;X.value=Object.entries(l).map((([a,{count:t,etc:l}])=>(e+=t,{domain:a,count:t,etc:l}))),Y.value=e>=1e4?10:5}},le=()=>{T({title:x("Mail.Mass.index_54"),width:450,minHeight:196,component:U((()=>l((()=>a.import("./unsubscribe-legacy.js?v=1732601582185")),void 0)))})},ne=()=>{T({title:x("Mail.Mass.index_42"),width:554,minHeight:604,content:()=>v(E,null,[v("img",{src:"/static/vite/images/unsubscribe.png"},null)])})},se=e=>{const a=e.split("/");return a[a.length-1]};return(()=>{const{row:e,isEdit:a}=c;if(e){O.task_name=a?e.task_name:`${e.task_name}_${n(4)}`,O.addresser=e.addresser,O.file_recipient=se(e.email_info.recipient_primordial),O.subject=e.email_info.subject,O.is_record=e.is_record,O.unsubscribe=e.unsubscribe,O.threadsType=0===e.threads?0:1,O.threads=e.threads;const l=se(e.email_info.content);(e=>{const a=e.split(".");return 1===a.length||""===a[a.length-1]})(l)?(O.up_content=0,O.file_content=l,(async e=>{const{message:a}=await R({id:e});t(a)&&(O.content=a.content.replace(/^"|"$/g,""))})(e.email_info.id)):(O.up_content=1,O.file_content=l),te(O.file_recipient,!a)}})(),d({onConfirm:async()=>{await(g.value?.validate());const e={task_name:O.task_name,addresser:O.addresser||"",file_recipient:O.file_recipient,subject:O.subject,up_content:O.up_content,file_content:O.file_content,content:O.content,is_record:O.is_record,unsubscribe:O.unsubscribe,threads:0===O.threadsType?0:O.threads},{isEdit:a,row:t}=c;a&&t?await H({...e,id:t.id}):await P(e),M("refresh")}}),(e,a)=>{const t=z,l=D,n=F,d=G,r=u,c=I,M=Q,x=s,h=W,w=i;return o(),_("div",J,[v(w,{ref_key:"formRef",ref:g,model:y(O),rules:q},{default:f((()=>[v(l,{label:e.$t("Mail.Mass.index_20"),path:"task_name"},{default:f((()=>[p("div",K,[v(t,{value:y(O).task_name,"onUpdate:value":a[0]||(a[0]=e=>y(O).task_name=e),placeholder:e.$t("Mail.Mass.index_21")},null,8,["value","placeholder"])])])),_:1},8,["label"]),v(l,{label:e.$t("Mail.Mass.index_4"),path:"addresser"},{default:f((()=>[p("div",L,[v(S,{value:y(O).addresser,"onUpdate:value":a[1]||(a[1]=e=>y(O).addresser=e),"is-init":!0},null,8,["value"])])])),_:1},8,["label"]),v(l,{label:e.$t("Mail.Mass.index_5"),path:"file_recipient"},{default:f((()=>[v(Z,{value:y(O).file_recipient,"onUpdate:value":[a[2]||(a[2]=e=>y(O).file_recipient=e),te],path:"/www/server/panel/data/mail/in_bulk/recipient",accept:["txt","json"]},{default:f((()=>[p("div",null,[a[11]||(a[11]=p("span",{class:"text-error"},"*",-1)),m(" "+b(e.$t("Mail.Mass.index_22")),1)])])),_:1},8,["value"])])),_:1},8,["label"]),v(l,{label:e.$t("Mail.Mass.index_23"),path:"subject"},{default:f((()=>[p("div",N,[v(t,{value:y(O).subject,"onUpdate:value":a[3]||(a[3]=e=>y(O).subject=e),placeholder:e.$t("Mail.Mass.index_24")},null,8,["value","placeholder"])])])),_:1},8,["label"]),v(l,{class:"mb-12px",label:e.$t("Mail.Mass.index_25"),"show-feedback":!1},{default:f((()=>[v(d,{value:y(O).up_content,"onUpdate:value":a[4]||(a[4]=e=>y(O).up_content=e)},{default:f((()=>[v(n,{value:1},{default:f((()=>[m(b(e.$t("Mail.Mass.index_26")),1)])),_:1}),v(n,{value:0},{default:f((()=>[m(b(e.$t("Mail.Mass.index_27")),1)])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),j(v(l,{label:" ",path:"file_content"},{default:f((()=>[v(Z,{value:y(O).file_content,"onUpdate:value":a[5]||(a[5]=e=>y(O).file_content=e),path:"/www/server/panel/data/mail/in_bulk/content",accept:["txt","html"]},{default:f((()=>[p("div",null,[a[12]||(a[12]=p("span",{class:"text-error"},"*",-1)),m(" "+b(e.$t("Mail.Mass.index_28")),1)])])),_:1},8,["value"])])),_:1},512),[[k,1===y(O).up_content]]),j(v(l,{label:" ",path:"content"},{default:f((()=>[p("div",V,[v(r,{value:y(O).content,"onUpdate:value":a[6]||(a[6]=e=>y(O).content=e),rows:4,placeholder:e.$t("Mail.Mass.index_29")},null,8,["value","placeholder"])])])),_:1},512),[[k,0===y(O).up_content]]),v(l,{label:e.$t("Mail.Mass.index_30")},{default:f((()=>[v(c,{value:y(O).is_record,"onUpdate:value":a[7]||(a[7]=e=>y(O).is_record=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"]),v(l,{label:e.$t("Mail.Mass.index_31")},{default:f((()=>[v(c,{value:y(O).unsubscribe,"onUpdate:value":a[8]||(a[8]=e=>y(O).unsubscribe=e),"checked-value":1,"unchecked-value":0},null,8,["value"]),v(M,{class:"ml-16px",onClick:le},{default:f((()=>[m(b(e.$t("Public.Btn.Set")),1)])),_:1}),v(x,{class:"ml-16px",onClick:ne},{default:f((()=>[m(b(e.$t("Mail.Mass.index_32")),1)])),_:1})])),_:1},8,["label"]),v(l,{label:e.$t("Mail.Mass.index_33"),path:"threads"},{default:f((()=>[v(d,{value:y(O).threadsType,"onUpdate:value":a[9]||(a[9]=e=>y(O).threadsType=e)},{default:f((()=>[v(n,{value:0},{default:f((()=>[m(b(e.$t("Mail.Mass.index_34")),1)])),_:1}),v(n,{value:1},{default:f((()=>[m(b(e.$t("Mail.Mass.index_35")),1)])),_:1})])),_:1},8,["value"]),j(p("div",ee,[v(h,{value:y(O).threads,"onUpdate:value":a[10]||(a[10]=e=>y(O).threads=e),min:1,max:y(Y),"show-button":!1,placeholder:e.$t("Mail.Mass.index_36")},null,8,["value","max","placeholder"])],512),[[k,1===y(O).threadsType]])])),_:1},8,["label"]),v(l,{label:" ","show-feedback":!1},{default:f((()=>[p("div",ae,[v(A,{data:y(X)},null,8,["data"])])])),_:1})])),_:1},8,["model"])])}}}))}}}));
