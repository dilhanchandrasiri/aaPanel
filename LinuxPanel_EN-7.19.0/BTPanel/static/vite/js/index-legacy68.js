System.register(["./index-legacy102.js?v=1732601582185","./page_layout-legacy.js?v=1732601582185","./index-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy9.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy11.js?v=1732601582185","./public-legacy.js?v=1732601582185","./tools-legacy.js?v=1732601582185","./vue-legacy.js?v=1732601582185","./naive-legacy.js?v=1732601582185","./common-legacy.js?v=1732601582185","./__commonjsHelpers__-legacy.js?v=1732601582185","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1732601582185","./rules-legacy.js?v=1732601582185"],(function(e,t){"use strict";var l,a,i,n,o,d,c,r,u,s,_,p,y,k,f,x,m,W,h,v,B,g,w,b,C,$,q,j,S,U,M,P,R,z,D,L,A,E,O,Q,Y,F,H,I,J,N,T,X,Z,G,K,V,ee,te,le,ae;return{setters:[e=>{l=e._},e=>{a=e.a7,i=e.o,n=e.bk,o=e.k,d=e.S,c=e.bB,r=e.f,u=e.c,s=e.bm,_=e.m},e=>{p=e._},e=>{y=e._},e=>{k=e._},e=>{f=e._},e=>{x=e._},e=>{m=e.h,W=e.d,h=e.f,v=e.a},e=>{B=e.a,g=e.b,w=e.s,b=e.g,C=e.u,$=e.c,q=e.r,j=e.d,S=e.e,U=e.f},e=>{M=e.d,P=e.ap,R=e.W,z=e.r,D=e.aq,L=e.y,A=e.O,E=e.P,O=e.M,Q=e.Y,Y=e.F,F=e.L,H=e.c,I=e.Z,J=e.R,N=e.ac,T=e.e,X=e.Q,Z=e.j,G=e.a6,K=e.X},e=>{V=e.bP,ee=e.bQ,te=e.aa,le=e.bJ},e=>{ae=e.j},null,null,null],execute:function(){var ie=document.createElement("style");ie.textContent=".bt-radio[data-v-bf5d25af] .n-radio-button:last-child{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}.bt-date-picker[data-v-bf5d25af] .n-input{border-top-left-radius:0;border-bottom-left-radius:0}\n",document.head.appendChild(ie);const ne={class:"flex"},oe=o(M({__name:"query-date",props:{value:{default:()=>"all"},valueModifiers:{}},emits:P(["search"],["update:value"]),setup(e,{emit:t}){const l=t,{t:o}=R(),d=z("all"),c=z(null),r=D(e,"value"),u=[{label:o("Public.All"),value:"all"},{label:o("Public.Search.Today"),value:"today"},{label:o("Public.Search.Yesterday"),value:"yesterday"}],s=e=>{c.value=null,r.value=e,l("search")},_=e=>{d.value=e?"":"all",r.value=a(e)?e:"all",l("search")};return L((()=>{a(r.value)?(d.value="",c.value=r.value):i(r.value)&&(d.value=r.value||"",c.value=null)})),(e,t)=>{const l=V,a=ee,i=n;return A(),E("div",ne,[O(a,{value:J(d),"onUpdate:value":[t[0]||(t[0]=e=>N(d)?d.value=e:null),s],class:"bt-radio"},{default:Q((()=>[(A(),E(Y,null,F(u,(e=>O(l,{key:e.value,value:e.value},{default:Q((()=>[H(I(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),O(i,{value:J(c),"onUpdate:value":[t[1]||(t[1]=e=>N(c)?c.value=e:null),_],type:"date",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-bf5d25af"]]),de={class:"mt-4px mb-20px text-center"},ce={class:"text-18px"},re={class:"mt-4px text-desc text-13px"},ue=M({__name:"query-total",props:{total:{default:0},date:{default:"all"},isRule:{type:Boolean,default:!1}},setup(e){const t=e,{t:l}=R(),a=T((()=>{const{date:e}=t;return"all"===e?l("Public.All"):i("today"===e?new Date:"yesterday"===e?ae(new Date,-1):new Date(e))})),i=e=>`${d(e,"yyyy-MM-dd")} 00:00:00-23:59:59`;return(e,t)=>(A(),E("div",de,[X("div",ce,I(e.$t("Waf.Block.index_4",[e.total])),1),X("div",re,[e.isRule?(A(),E(Y,{key:1},[H(I(e.$t("Waf.Block.index_6")),1)],64)):(A(),E(Y,{key:0},[H(I(e.$t("Waf.Block.index_5",[J(a)])),1)],64))])]))}}),se=M({__name:"index",setup(e){const l=G((()=>u((()=>t.import("./clear-legacy.js?v=1732601582185")),void 0))),{t:i}=R(),n=()=>{const e=s();window.open(`${e}/btwaf/export_logs.json?siteName=all`)},o=m(i("Waf.Block.index_10")),_=()=>{o.show=!0},{table:v,columns:C,setLoading:$}=W([{key:"time_localtime",title:i("Waf.Block.index_12"),minWidth:150,width:"12%",render:e=>d(e.time_localtime)},{key:"ip",title:i("Waf.Block.index_13"),minWidth:120,width:"10%",ellipsis:{tooltip:!0}},{key:"server_name",title:i("Waf.Block.index_14"),minWidth:120,width:"12%",ellipsis:{tooltip:!0}},{key:"type",title:i("Waf.Block.index_15"),minWidth:60,width:"6%",ellipsis:{tooltip:!0}},{key:"uri",title:i("Waf.Block.index_16"),minWidth:140,ellipsis:{tooltip:{contentStyle:{maxWidth:"500px"}}},render:e=>c(e.uri)},{key:"status",title:i("Waf.Block.index_17"),minWidth:60,width:"6%",render:()=>i("Waf.Block.index_18")},{key:"ip_country",title:i("Waf.Block.index_19"),minWidth:140,width:"14%",render:e=>e.ip_country===i("Waf.Block.index_20")?e.ip_country:(e=>e.ip_country)(e)},{key:"filter_rule",title:i("Waf.Block.index_21"),minWidth:120,width:"10%",ellipsis:{tooltip:!0}},h({width:200,options:e=>[{label:i("Waf.Block.index_22"),onClick:()=>{B(e)}},{label:i("Waf.Block.index_23"),onClick:()=>{g(e,-1!==e.uri.indexOf("?")&&-1!==e.uri.indexOf("="))}},{label:i("Waf.Block.index_24"),onClick:()=>{w(e)}}]})]),q=Z({p:1,limit:10,keyword:"",query_data:"all"}),j=()=>{const e=(()=>{if(a(q.query_data))return d(new Date(q.query_data),"yyyy-MM-dd");if("today"===q.query_data)return d(new Date,"yyyy-MM-dd");if("yesterday"===q.query_data){const e=new Date,t=ae(e,-1);return d(t,"yyyy-MM-dd")}return""})();return{p:q.p,limit:q.limit,...e?{query_data:e}:{},...q.keyword?{keyword:q.keyword}:{}}},S=async()=>{try{$(!0);const e=j(),{message:t}=await b(e);r(t)&&(v.data=t.data,v.total=t.total)}finally{$(!1)}},U=()=>{q.p=1,S()};return S(),(e,t)=>{const a=x,i=te,d=f,c=k,r=y,u=p;return A(),E("div",null,[O(r,null,{toolsLeft:Q((()=>[O(a,{value:J(q).keyword,"onUpdate:value":t[0]||(t[0]=e=>J(q).keyword=e),width:"300",placeholder:e.$t("Waf.Block.index_8"),onSearch:U},null,8,["value","placeholder"]),O(i,{type:"primary",onClick:U},{default:Q((()=>[H(I(e.$t("Public.Btn.Search")),1)])),_:1}),O(i,{onClick:n},{default:Q((()=>[H(I(e.$t("Public.Btn.Export")),1)])),_:1}),O(i,{onClick:_},{default:Q((()=>[H(I(e.$t("Waf.Block.index_9")),1)])),_:1})])),toolsRight:Q((()=>[O(oe,{value:J(q).query_data,"onUpdate:value":t[1]||(t[1]=e=>J(q).query_data=e),onSearch:U},null,8,["value"])])),table:Q((()=>[O(ue,{total:J(v).total,date:J(q).query_data},null,8,["total","date"]),O(d,{loading:J(v).loading,data:J(v).data,columns:J(C)},null,8,["loading","data","columns"])])),pageRight:Q((()=>[O(c,{page:J(q).p,"onUpdate:page":t[2]||(t[2]=e=>J(q).p=e),"page-size":J(q).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>J(q).limit=e),"item-count":J(v).total,"store-key":"waf-block-record",onRefresh:S},null,8,["page","page-size","item-count"])])),_:1}),O(u,{show:J(o).show,"onUpdate:show":t[4]||(t[4]=e=>J(o).show=e),title:J(o).title,width:460,"min-height":96,footer:!0,component:J(l)},null,8,["show","title","component"])])}}}),_e={class:"mb-10px"},pe=M({__name:"index",setup(e){const{t:t}=R(),l=()=>{const e=s();window.open(`${e}/btwaf/index?export=export`)},i=()=>{v({title:t("Waf.Block.index_31"),content:t("Waf.Block.index_32"),onConfirm:async()=>{await q({safe_logs:1,site_all:0,site_logs:[]}),M()}})},n=()=>{v({title:t("Waf.Block.index_33"),content:t("Waf.Block.index_34"),onConfirm:async()=>{await j(),M()}})},{table:o,columns:u,setLoading:p}=W([{key:"time",title:t("Waf.Block.index_12"),minWidth:150,width:"12%",render:e=>d(e.time)},{key:"ip",title:t("Waf.Block.index_13"),minWidth:120,width:"10%",ellipsis:{tooltip:!0},render:e=>c(e.ip)},{key:"server_name",title:t("Waf.Block.index_25"),minWidth:120,width:"12%",ellipsis:{tooltip:!0}},{key:"uri",title:t("Waf.Block.index_16"),minWidth:140,ellipsis:{tooltip:{contentStyle:{maxWidth:"500px"}}},render:e=>c(e.uri)},{key:"blockade",title:t("Waf.Block.index_35"),minWidth:120,width:"10%",render:e=>"cc"==e.blockade&&e.incoming_value===t("Waf.Block.index_36")?t("Waf.Block.index_37"):"cc"==e.blockade&&e.incoming_value.startsWith(t("Waf.Block.index_38"))?t("Waf.Block.index_38"):"cc"==e.blockade&&e.incoming_value.startsWith(t("Waf.Block.index_39"))?t("Waf.Block.index_39"):"php"==e.blockade&&e.filter_rule.startsWith(t("Waf.Block.index_40"))?t("Waf.Block.index_40"):"upload"===e.blockade?t("Waf.Block.index_41"):"xss"===e.blockade?t("Waf.Block.index_42"):"sql"===e.blockade?t("Waf.Block.index_43"):"scan"===e.blockade?t("Waf.Block.index_44"):"user_agent"===e.blockade?t("Waf.Block.index_45"):"inc"===e.blockade&&e.incoming_value.startsWith(t("Waf.Block.index_46"))?t("Waf.Block.index_46"):"drop_abroad"===e.blockade&&e.incoming_value.startsWith(t("Waf.Block.index_47"))?t("Waf.Block.index_48"):"inc"===e.blockade?t("Waf.Block.index_49"):"cc"===e.blockade?"CC":t("Waf.Block.index_49")},{key:"blocking_time",title:t("Waf.Block.index_50"),minWidth:70,width:"6%",render:e=>t("Waf.Block.index_51",[e.blocking_time])},{key:"is_feng",title:t("Waf.Block.index_17"),minWidth:60,width:"6%",render:e=>e.is_feng?O("span",{class:"text-error"},[t("Waf.Block.index_56")]):t("Waf.Block.index_18")},{key:"ip_country",title:t("Waf.Block.index_19"),minWidth:140,width:"14%",render:e=>e.ip_country===t("Waf.Block.index_20")?e.ip_country:(e=>e.ip_country)(e)},h({width:240,options:e=>[{label:t("Waf.Block.index_52"),onClick:()=>{g(e,!1)}},{label:t("Waf.Block.index_22"),onClick:()=>{B(e)}},{label:t("Waf.Block.index_53"),onClick:()=>{m(e)}},{label:t("Waf.Block.index_24"),onClick:()=>{w(e)}}]})]),m=e=>{e.is_feng?v({title:t("Waf.Block.index_33"),content:t("Waf.Block.index_54",[e.ip]),onConfirm:async()=>{await C({ip:e.ip}),U()}}):_.success(t("Waf.Block.index_55"))},b=Z({p:1,limit:10,keyword:"",query_data:"all"}),S=()=>{const e=(()=>{if(a(b.query_data))return d(new Date(b.query_data),"yyyy-MM-dd");if("today"===b.query_data)return d(new Date,"yyyy-MM-dd");if("yesterday"===b.query_data){const e=new Date,t=ae(e,-1);return d(t,"yyyy-MM-dd")}return""})();return{p:b.p,limit:b.limit,...e?{query_data:e}:{},...b.keyword?{keyword:b.keyword}:{}}},U=async()=>{try{p(!0);const e=S(),{message:t}=await $(e);r(t)&&(o.data=t.data,o.total=t.count)}finally{p(!1)}},M=()=>{b.p=1,U()};return U(),(e,t)=>{const a=x,d=te,c=f,r=k,s=y;return A(),E("div",null,[O(s,null,{toolsLeft:Q((()=>[O(a,{value:J(b).keyword,"onUpdate:value":t[0]||(t[0]=e=>J(b).keyword=e),width:"300",placeholder:e.$t("Waf.Block.index_8"),onSearch:M},null,8,["value","placeholder"]),O(d,{type:"primary",onClick:M},{default:Q((()=>[H(I(e.$t("Public.Btn.Search")),1)])),_:1}),O(d,{onClick:l},{default:Q((()=>[H(I(e.$t("Public.Btn.Export")),1)])),_:1}),O(d,{onClick:i},{default:Q((()=>[H(I(e.$t("Waf.Block.index_9")),1)])),_:1})])),toolsRight:Q((()=>[O(oe,{value:J(b).query_data,"onUpdate:value":t[1]||(t[1]=e=>J(b).query_data=e),onSearch:M},null,8,["value"])])),table:Q((()=>[O(ue,{total:J(o).total,date:J(b).query_data},null,8,["total","date"]),X("div",_e,[O(d,{onClick:n},{default:Q((()=>[H(I(e.$t("Waf.Block.index_30")),1)])),_:1})]),O(c,{loading:J(o).loading,data:J(o).data,columns:J(u)},null,8,["loading","data","columns"])])),pageRight:Q((()=>[O(r,{page:J(b).p,"onUpdate:page":t[2]||(t[2]=e=>J(b).p=e),"page-size":J(b).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>J(b).limit=e),"item-count":J(o).total,"store-key":"waf-ip-record",onRefresh:U},null,8,["page","page-size","item-count"])])),_:1})])}}}),ye=M({__name:"index",setup(e){const l=G((()=>u((()=>t.import("./config-legacy4.js?v=1732601582185")),void 0))),{t:a}=R(),i=()=>{v({title:a("Waf.Block.index_60"),content:a("Waf.Block.index_61"),onConfirm:async()=>{await U(),g()}})},n=m(a("Waf.Block.index_57")),o=()=>{n.show=!0},{table:c,columns:s,setLoading:_}=W([{key:"timestimp",title:a("Waf.Block.index_12"),minWidth:150,width:"14%",render:e=>d(e.timestimp)},{key:"status",title:a("Waf.Block.index_17"),minWidth:80,width:"6%",render:e=>O("span",{class:e.status===a("Waf.Block.index_58")?"text-error":""},[e.status])},{key:"rule_ps",title:a("Waf.Block.index_62"),minWidth:120,ellipsis:{tooltip:!0},render:e=>O("span",{class:"text-primary"},[`${e.key}-${e.rule_ps}`])},{key:"server_name",title:a("Waf.Block.index_14"),minWidth:140,width:"14%",ellipsis:{tooltip:{contentStyle:{maxWidth:"500px"}}}},{key:"ip",title:a("Waf.Block.index_63"),minWidth:140,width:"14%",ellipsis:{tooltip:!0}},{key:"ip_country",title:a("Waf.Block.index_64"),minWidth:140,width:"14%",render:e=>O("span",null,[e.ip_country])}]),h=Z({p:1,limit:10,filter:"all",keyword:""}),B=async()=>{try{_(!0);const e={p:1,limit:10,..."all"!==h.filter?{filter:h.filter}:{},...h.keyword?{keyword:h.keyword}:{}},{message:t}=await S(e);r(t)&&(c.data=t.list,c.total=t.total)}finally{_(!1)}},g=()=>{h.p=1,B()};return B(),(e,t)=>{const a=x,d=te,r=V,u=ee,_=f,m=k,W=y,v=p;return A(),E("div",null,[O(W,null,{toolsLeft:Q((()=>[O(a,{value:J(h).keyword,"onUpdate:value":t[0]||(t[0]=e=>J(h).keyword=e),width:"300",placeholder:e.$t("Waf.Block.index_8"),onSearch:g},null,8,["value","placeholder"]),O(d,{type:"primary",onClick:g},{default:Q((()=>[H(I(e.$t("Public.Btn.Search")),1)])),_:1}),O(d,{onClick:i},{default:Q((()=>[H(I(e.$t("Waf.Block.index_9")),1)])),_:1}),O(d,{onClick:o},{default:Q((()=>[H(I(e.$t("Waf.Block.index_57")),1)])),_:1})])),toolsRight:Q((()=>[O(u,{value:J(h).filter,"onUpdate:value":[t[1]||(t[1]=e=>J(h).filter=e),g]},{default:Q((()=>[O(r,{value:"all"},{default:Q((()=>[H(I(e.$t("Public.All")),1)])),_:1}),O(r,{value:"refuse"},{default:Q((()=>[H(I(e.$t("Waf.Block.index_58")),1)])),_:1}),O(r,{value:"accept"},{default:Q((()=>[H(I(e.$t("Waf.Block.index_59")),1)])),_:1})])),_:1},8,["value"])])),table:Q((()=>[O(ue,{total:J(c).total,"is-rule":!0},null,8,["total"]),O(_,{loading:J(c).loading,data:J(c).data,columns:J(s)},null,8,["loading","data","columns"])])),pageRight:Q((()=>[O(m,{page:J(h).p,"onUpdate:page":t[2]||(t[2]=e=>J(h).p=e),"page-size":J(h).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>J(h).limit=e),"item-count":J(c).total,"store-key":"waf-rule-record",onRefresh:B},null,8,["page","page-size","item-count"])])),_:1}),O(v,{show:J(n).show,"onUpdate:show":t[4]||(t[4]=e=>J(n).show=e),title:J(n).title,data:J(n).data,width:400,"min-height":370,footer:!0,component:J(l)},null,8,["show","title","data","component"])])}}});e("default",M({__name:"index",setup(e){const{t:t}=R(),a=z("block"),i=[{key:"block",label:t("Waf.Block.index_1"),component:se},{key:"ip",label:t("Waf.Block.index_2"),component:pe},{key:"rule",label:t("Waf.Block.index_3"),component:ye}];return(e,t)=>{const n=l,o=le;return A(),K(o,{class:"p-16px"},{default:Q((()=>[O(n,{value:J(a),"onUpdate:value":t[0]||(t[0]=e=>N(a)?a.value=e:null),options:i},null,8,["value"])])),_:1})}}}))}}}));
