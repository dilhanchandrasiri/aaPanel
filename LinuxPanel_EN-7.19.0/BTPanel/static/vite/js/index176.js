const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/unsubscribe.js?v=1732601582185","js/index.js?v=1732601582185","js/vue.js?v=1732601582185","js/__commonjsHelpers__.js?v=1732601582185","js/common.js?v=1732601582185","js/public.js?v=1732601582185","js/page_layout.js?v=1732601582185","js/naive.js?v=1732601582185","css/page_layout.css?v=1732601582185","css/public.css?v=1732601582185","css/index80.css?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang.js?v=1732601582185","js/mail.js?v=1732601582185"])))=>i.map(i=>d[i]);
import{f as e,c as a,ar as t,j as l}from"./page_layout.js?v=1732601582185";import{_ as s}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{_ as n}from"./index99.js?v=1732601582185";import{d as i,ap as r,aq as u,O as d,P as o,Q as c,M as _,Y as p,c as m,Z as f,ad as v,m as b,W as M,r as x,X as h,R as w,j,k,v as $,a6 as g,F as y}from"./vue.js?v=1732601582185";import{u as U}from"./public.js?v=1732601582185";import{a6 as E,a7 as T,a8 as C,a9 as P,aa as R}from"./mail.js?v=1732601582185";import{_ as B}from"./index.vue_vue_type_script_setup_true_lang16.js?v=1732601582185";import{o as H}from"./upload.js?v=1732601582185";import{aa as O,bR as D,ad as I,bG as Q,b$ as S,bQ as q,bo as z,bl as A}from"./naive.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";const F={class:"flex items-center mb-8px"},G={class:"ml-40px"},L=i({__name:"import",props:r({path:{default:""},accept:{default:()=>[]}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const a=e,{path:t,accept:l}=a,s=u(e,"value"),n=()=>{H({path:t,size:5,uploadData:{accept:l.map((e=>".".concat(e))).join(","),multiple:!1},onUploadSuccess:e=>{s.value=e[0].name}})};return(e,a)=>{const t=O;return d(),o("div",null,[c("div",F,[_(t,{onClick:n},{default:p((()=>[m(f(e.$t("Public.Btn.Import")),1)])),_:1}),c("div",G,[m(f(e.$t("Mail.Mass.index_43"))+" ",1),c("span",{class:v(s.value?"text-primary":"text-error")},f(s.value||e.$t("Mail.Mass.index_44")),3)])]),b(e.$slots,"default")])}}}),V=i({__name:"table",props:{data:{default:()=>[]}},setup(e){const{t:a}=M(),t=x([{key:"domain",title:a("Mail.Mass.index_45"),ellipsis:!0},{key:"count",title:a("Mail.Mass.index_46"),width:240}]);return(e,a)=>{const l=D;return d(),h(l,{"max-height":240,data:e.data,columns:w(t)},null,8,["data","columns"])}}}),W={class:"p-20px"},X={class:"w-320px"},Y={class:"w-320px"},Z={class:"w-320px"},J={class:"w-320px"},K={class:"w-60px ml-24px"},N={class:"w-530px"},ee=i({__name:"index",props:{isEdit:{type:Boolean,default:!1},row:{}},emits:["refresh"],setup(i,{expose:r,emit:u}){const v=i,b=u,{t:h}=M(),H=x(null),D=j({task_name:"",addresser:null,file_recipient:"",subject:"",forward_user:"",up_content:1,file_content:"",content:"",is_record:0,unsubscribe:0,threadsType:0,threads:1,ip:"",port:null}),F={task_name:{trigger:["blur","input"],validator:()=>""!==D.task_name.trim()||new Error(h("Mail.Mass.index_38"))},file_recipient:{validator:()=>""!==D.file_recipient||new Error(h("Mail.Mass.index_39"))},subject:{validator:()=>""!==D.file_recipient||new Error(h("Mail.Mass.index_40"))},file_content:{validator:()=>1!==D.up_content||""!==D.file_content||new Error(h("Mail.Mass.index_41"))},content:{validator:()=>0!==D.up_content||""!==D.content.trim()||new Error(h("Mail.Mass.index_41"))}},G=x([]),ee=x(5),ae=async(a,t=!0)=>{if(!a)return;t&&await E({file:a});const{message:l}=await T({file:a});if(e(l)){let e=0;G.value=Object.entries(l).map((([a,{count:t,etc:l}])=>(e+=t,{domain:a,count:t,etc:l}))),ee.value=e>=1e4?10:5}},te=()=>{U({title:h("Mail.Mass.index_54"),width:450,minHeight:196,component:g((()=>a((()=>import("./unsubscribe.js?v=1732601582185")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))))})},le=()=>{U({title:h("Mail.Mass.index_42"),width:554,minHeight:604,content:()=>_(y,null,[_("img",{src:"/static/vite/images/unsubscribe.png"},null)])})},se=e=>{const a=e.split("/");return a[a.length-1]};return(()=>{const{row:a,isEdit:l}=v;if(a){D.task_name=l?a.task_name:"".concat(a.task_name,"_").concat(t(4)),D.addresser=a.addresser,D.file_recipient=se(a.email_info.recipient_primordial),D.subject=a.email_info.subject,D.is_record=a.is_record,D.unsubscribe=a.unsubscribe,D.threadsType=0===a.threads?0:1,D.threads=a.threads;const s=se(a.email_info.content);(e=>{const a=e.split(".");return 1===a.length||""===a[a.length-1]})(s)?(D.up_content=0,D.file_content=s,(async a=>{const{message:t}=await R({id:a});e(t)&&(D.content=t.content.replace(/^"|"$/g,""))})(a.email_info.id)):(D.up_content=1,D.file_content=s),ae(D.file_recipient,!l)}})(),r({onConfirm:async()=>{var e;await(null==(e=H.value)?void 0:e.validate());const a={task_name:D.task_name,addresser:D.addresser||"",file_recipient:D.file_recipient,subject:D.subject,up_content:D.up_content,file_content:D.file_content,content:D.content,is_record:D.is_record,unsubscribe:D.unsubscribe,threads:0===D.threadsType?0:D.threads},{isEdit:t,row:l}=v;t&&l?await C({...a,id:l.id}):await P(a),b("refresh")}}),(e,a)=>{const t=I,i=Q,r=S,u=q,v=n,b=z,M=O,x=l,h=A,j=s;return d(),o("div",W,[_(j,{ref_key:"formRef",ref:H,model:w(D),rules:F},{default:p((()=>[_(i,{label:e.$t("Mail.Mass.index_20"),path:"task_name"},{default:p((()=>[c("div",X,[_(t,{value:w(D).task_name,"onUpdate:value":a[0]||(a[0]=e=>w(D).task_name=e),placeholder:e.$t("Mail.Mass.index_21")},null,8,["value","placeholder"])])])),_:1},8,["label"]),_(i,{label:e.$t("Mail.Mass.index_4"),path:"addresser"},{default:p((()=>[c("div",Y,[_(B,{value:w(D).addresser,"onUpdate:value":a[1]||(a[1]=e=>w(D).addresser=e),"is-init":!0},null,8,["value"])])])),_:1},8,["label"]),_(i,{label:e.$t("Mail.Mass.index_5"),path:"file_recipient"},{default:p((()=>[_(L,{value:w(D).file_recipient,"onUpdate:value":[a[2]||(a[2]=e=>w(D).file_recipient=e),ae],path:"/www/server/panel/data/mail/in_bulk/recipient",accept:["txt","json"]},{default:p((()=>[c("div",null,[a[11]||(a[11]=c("span",{class:"text-error"},"*",-1)),m(" "+f(e.$t("Mail.Mass.index_22")),1)])])),_:1},8,["value"])])),_:1},8,["label"]),_(i,{label:e.$t("Mail.Mass.index_23"),path:"subject"},{default:p((()=>[c("div",Z,[_(t,{value:w(D).subject,"onUpdate:value":a[3]||(a[3]=e=>w(D).subject=e),placeholder:e.$t("Mail.Mass.index_24")},null,8,["value","placeholder"])])])),_:1},8,["label"]),_(i,{class:"mb-12px",label:e.$t("Mail.Mass.index_25"),"show-feedback":!1},{default:p((()=>[_(u,{value:w(D).up_content,"onUpdate:value":a[4]||(a[4]=e=>w(D).up_content=e)},{default:p((()=>[_(r,{value:1},{default:p((()=>[m(f(e.$t("Mail.Mass.index_26")),1)])),_:1}),_(r,{value:0},{default:p((()=>[m(f(e.$t("Mail.Mass.index_27")),1)])),_:1})])),_:1},8,["value"])])),_:1},8,["label"]),k(_(i,{label:" ",path:"file_content"},{default:p((()=>[_(L,{value:w(D).file_content,"onUpdate:value":a[5]||(a[5]=e=>w(D).file_content=e),path:"/www/server/panel/data/mail/in_bulk/content",accept:["txt","html"]},{default:p((()=>[c("div",null,[a[12]||(a[12]=c("span",{class:"text-error"},"*",-1)),m(" "+f(e.$t("Mail.Mass.index_28")),1)])])),_:1},8,["value"])])),_:1},512),[[$,1===w(D).up_content]]),k(_(i,{label:" ",path:"content"},{default:p((()=>[c("div",J,[_(v,{value:w(D).content,"onUpdate:value":a[6]||(a[6]=e=>w(D).content=e),rows:4,placeholder:e.$t("Mail.Mass.index_29")},null,8,["value","placeholder"])])])),_:1},512),[[$,0===w(D).up_content]]),_(i,{label:e.$t("Mail.Mass.index_30")},{default:p((()=>[_(b,{value:w(D).is_record,"onUpdate:value":a[7]||(a[7]=e=>w(D).is_record=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1},8,["label"]),_(i,{label:e.$t("Mail.Mass.index_31")},{default:p((()=>[_(b,{value:w(D).unsubscribe,"onUpdate:value":a[8]||(a[8]=e=>w(D).unsubscribe=e),"checked-value":1,"unchecked-value":0},null,8,["value"]),_(M,{class:"ml-16px",onClick:te},{default:p((()=>[m(f(e.$t("Public.Btn.Set")),1)])),_:1}),_(x,{class:"ml-16px",onClick:le},{default:p((()=>[m(f(e.$t("Mail.Mass.index_32")),1)])),_:1})])),_:1},8,["label"]),_(i,{label:e.$t("Mail.Mass.index_33"),path:"threads"},{default:p((()=>[_(u,{value:w(D).threadsType,"onUpdate:value":a[9]||(a[9]=e=>w(D).threadsType=e)},{default:p((()=>[_(r,{value:0},{default:p((()=>[m(f(e.$t("Mail.Mass.index_34")),1)])),_:1}),_(r,{value:1},{default:p((()=>[m(f(e.$t("Mail.Mass.index_35")),1)])),_:1})])),_:1},8,["value"]),k(c("div",K,[_(h,{value:w(D).threads,"onUpdate:value":a[10]||(a[10]=e=>w(D).threads=e),min:1,max:w(ee),"show-button":!1,placeholder:e.$t("Mail.Mass.index_36")},null,8,["value","max","placeholder"])],512),[[$,1===w(D).threadsType]])])),_:1},8,["label"]),_(i,{label:" ","show-feedback":!1},{default:p((()=>[c("div",N,[_(V,{data:w(G)},null,8,["data"])])])),_:1})])),_:1},8,["model"])])}}});export{ee as default};
