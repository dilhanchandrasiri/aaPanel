import{_ as a}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{aa as e,bU as l,bL as t,bZ as s,ad as o,bn as i,bK as n,bH as u,bI as r,bG as c,bh as d}from"./naive.js?v=1732601582185";import{d as p,ap as v,aq as m,O as _,X as f,Y as b,M as x,c as y,Z as h,u as g,ar as j,P as k,F as w,L as A,Q as C,ad as $,ao as L,m as W,r as U,x as I,e as M,R as P,ac as R,W as z,j as D}from"./vue.js?v=1732601582185";import{ba as E,k as H,f as O,a0 as Z,I as q}from"./page_layout.js?v=1732601582185";import{g as B,a as F}from"./index70.js?v=1732601582185";import{T as G}from"./common.js?v=1732601582185";import{b as K}from"./public.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./index.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import"./useModal3.js?v=1732601582185";const Q=p({__name:"index",props:v({options:{default:()=>[]},placeholder:{}},{value:{type:Array,default:()=>[]},valueModifiers:{}}),emits:["update:value"],setup(a){const s=a,o=m(a,"value"),i=()=>{const{options:a}=s;o.value=a.map((a=>a.value))},n=()=>{o.value=[]};return(a,s)=>{const u=e,r=l,c=t;return _(),f(c,g({value:o.value,"onUpdate:value":s[0]||(s[0]=a=>o.value=a)},a.$attrs,{multiple:!0,filterable:!0,options:a.options,placeholder:a.placeholder,"max-tag-count":"responsive"}),{header:b((()=>[x(r,{class:"w-full"},{default:b((()=>[x(u,{class:"flex-1",onClick:i},{default:b((()=>[y(h(a.$t("Public.All")),1)])),_:1}),x(u,{class:"flex-1",onClick:n},{default:b((()=>[y(h(a.$t("Public.Btn.Cancel")),1)])),_:1})])),_:1})])),_:1},16,["value","options","placeholder"])}}}),T=["title","onClick"],X={key:0,class:"area-name"},Y=H(p({__name:"area-list",props:{data:{default:()=>[]},selectData:{default:()=>[]}},emits:["click"],setup(a,{emit:e}){const l=a,t=e,o=!!j().label;return(a,e)=>{const i=s,n=E;return _(),f(n,{cols:6,"x-gap":6,"y-gap":6},{default:b((()=>[(_(!0),k(w,null,A(a.data,(e=>(_(),f(i,{key:e.code},{default:b((()=>{return[C("div",{class:$(["area-item",{active:(s=e.code,l.selectData.some((a=>a.code===s)))}]),title:e.label,onClick:a=>(a=>{t("click",a)})(e)},[o?L("",!0):(_(),k("span",X,h(e.label),1)),W(a.$slots,"label",{data:e},void 0,!0)],10,T)];var s})),_:2},1024)))),128))])),_:3})}}}),[["__scopeId","data-v-f119016e"]]),J={class:"flex-1"},N={class:"w-200px h-full"},S={class:"area-tit"},V={class:"area-tit"},aa={class:"max-w-100% truncate"},ea={class:"min-h-244px"},la=H(p({__name:"area",props:{value:{default:()=>[]},valueModifiers:{}},emits:["update:value"],setup(a){const e=m(a,"value"),l=U("all"),t=U([]),s=I({list:{},relations:{},category:{district:[],provinces:[],continents:[],hotRegion:[]}}),c=U([]),d=U([]),p=U(""),v=U([]),g=a=>{if(""===a.trim())return void(v.value=[]);const{list:e}=s.value;v.value=Object.keys(e).filter((l=>e[l][1].includes(a))).map((a=>({key:a,label:e[a][1],props:{onClick:()=>{j(a,e[a][1])}}}))).splice(0,11)},j=(a,l)=>{const{category:t}=s.value,{continents:o}=t;o.includes(a)?D({code:a,label:l}):e.value.some((e=>e.code===a))||z({code:a,label:l})},$=M((()=>{const a={},{category:l,relations:t}=s.value,{continents:o}=l;return o.forEach((l=>{a[l]=t[l].filter((a=>e.value.some((e=>e.code===a)))).length})),a})),W=a=>{"all"===a&&(t.value=[])},z=a=>{e.value.some((e=>e.code===a.code))?e.value=e.value.filter((e=>e.code!==a.code)):e.value.push(a)},D=a=>{const{list:e,relations:o}=s.value,i=o[a.code].map((a=>({code:a,label:e[a][1]})));t.value.push({name:a.code,tab:a.label,areaList:i}),l.value=a.code},{loading:E,setLoading:H}=K(),q=()=>{const{list:a,category:e}=s.value,{hotRegion:l}=e;c.value=l.map((e=>({code:e,label:a[e][1]})))},B=()=>{const{list:a,category:e}=s.value,{continents:l}=e;d.value=l.map((e=>({code:e,label:a[e][1]})))};return(async()=>{try{H(!0);const{data:a}=await G.get("/static/vite/data/area.json");O(a)&&(s.value=a,q(),B())}finally{H(!1)}})(),(a,s)=>{const m=o,j=i,U=n,I=Z,M=u,H=r;return _(),k("div",J,[x(H,{value:P(l),"onUpdate:value":[s[1]||(s[1]=a=>R(l)?l.value=a:null),W],type:"card",class:"area-tabs"},{suffix:b((()=>[C("div",N,[x(j,{trigger:"focus",style:{width:"200px"},options:P(v)},{default:b((()=>[x(m,{value:P(p),"onUpdate:value":s[0]||(s[0]=a=>R(p)?p.value=a:null),class:"area-input",size:"small",placeholder:a.$t("Waf.Area.index_19"),onInput:g},null,8,["value","placeholder"])])),_:1},8,["options"])])])),default:b((()=>[x(M,{name:"all",tab:a.$t("Public.All")},{default:b((()=>[x(I,{class:"min-h-244px",show:P(E)},{default:b((()=>[C("div",S,h(a.$t("Waf.Area.index_21")),1),x(Y,{class:"mb-16px",data:P(c),"select-data":e.value,onClick:z},null,8,["data","select-data"]),C("div",V,h(a.$t("Waf.Area.index_22")),1),x(Y,{data:P(d),onClick:D},{label:b((a=>[C("div",aa,h(a.data.label),1),P($)[a.data.code]>0?(_(),f(U,{key:0,type:"primary",class:"ml-4px px-5px h-18px"},{default:b((()=>[y(h(P($)[a.data.code]),1)])),_:2},1024)):L("",!0)])),_:1},8,["data"])])),_:1},8,["show"])])),_:1},8,["tab"]),(_(!0),k(w,null,A(P(t),(a=>(_(),f(M,{key:a.name,name:a.name,tab:a.tab},{default:b((()=>[C("div",ea,[x(Y,{data:a.areaList,"select-data":e.value,onClick:z},null,8,["data","select-data"])])])),_:2},1032,["name","tab"])))),128))])),_:1},8,["value"])])}}}),[["__scopeId","data-v-219b3335"]]),ta={class:"py-24px px-32px"},sa={class:"mr-20px"},oa={class:"w-220px"},ia={class:"w-240px"},na=p({__name:"index",emits:["refresh"],setup(e,{expose:l,emit:s}){const o=s,{t:i}=z(),u=U(null),r=D({types:"refuse",site:[],areaList:[]}),p={site:{trigger:"change",validator:()=>0!==r.site.length||new Error(i("Waf.Area.index_17"))}},v=[{label:i("Waf.Area.index_15"),value:"refuse"},{label:i("Waf.Area.index_14"),value:"accept"}],m=U([]);return(async()=>{const{message:a}=await B();q(a)&&(m.value=a.map((a=>({label:a.name,value:a.name}))))})(),l({onConfirm:async()=>{var a;await(null==(a=u.value)?void 0:a.validate());const e={region:r.areaList.map((a=>a.label)).join(","),types:r.types,site:r.site.join(",")};await F(e),o("refresh")}}),(e,l)=>{const s=t,o=c,i=Q,g=d,j=n,$=a;return _(),k("div",ta,[x($,{ref_key:"formRef",ref:u,model:P(r),rules:p},{default:b((()=>[x(g,{class:"mb-4px"},{default:b((()=>[x(o,null,{default:b((()=>[C("span",sa,h(e.$t("Waf.Area.index_13")),1),C("div",oa,[x(s,{value:P(r).types,"onUpdate:value":l[0]||(l[0]=a=>P(r).types=a),options:v},null,8,["value"])])])),_:1}),x(o,{label:e.$t("Waf.Area.index_11"),"label-width":"80"},{default:b((()=>[C("div",ia,[x(i,{value:P(r).site,"onUpdate:value":l[1]||(l[1]=a=>P(r).site=a),options:P(m),placeholder:e.$t("Waf.Area.index_17")},null,8,["value","options","placeholder"])])])),_:1},8,["label"])])),_:1}),x(g,{class:"min-h-28px mb-10px items-center",size:[10,4]},{default:b((()=>[C("div",null,h(e.$t("Waf.Area.index_18")),1),(_(!0),k(w,null,A(P(r).areaList,((a,e)=>(_(),f(j,{key:a.code,type:"primary",round:!0,closable:!0,onClose:a=>(a=>{r.areaList.splice(a,1)})(e)},{default:b((()=>[y(h(a.label),1)])),_:2},1032,["onClose"])))),128))])),_:1}),x(la,{value:P(r).areaList,"onUpdate:value":l[2]||(l[2]=a=>P(r).areaList=a)},null,8,["value"])])),_:1},8,["model"])])}}});export{na as default};
