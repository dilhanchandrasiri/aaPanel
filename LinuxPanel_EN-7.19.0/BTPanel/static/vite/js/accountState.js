import{a3 as t,W as a,M as e,F as o,j as l,u as c,r as n,d as u,f as i,w as s,t as r,i as d,c as m}from"./vue.js?v=1732601582185";import{b as p,a as _,f as b}from"./public.js?v=1732601582185";import{bR as k,f as g,bS as v,bT as h,h as A,m as y,bU as w,bV as x,bW as F,bX as f,i as S,bk as V}from"./page_layout.js?v=1732601582185";import{bo as D,bl as q,bV as H,bG as L,_ as j,bL as U,ad as P}from"./naive.js?v=1732601582185";const M=t("accountStore",(()=>{const t=T(),{t:l}=a(),c=async()=>{try{u(!0);const{message:a}=await k(t.search);g(a)&&(t.table.data=a.list,t.table.total=a.page.count)}finally{u(!1)}},{loading:n,setLoading:u}=p(),i=async()=>{const{message:a}=await v();g(a)&&(t.packageSourceList=a.list,t.packageList=a.list.map((t=>({label:t.package_name,value:t.package_id}))),a.list.length>0&&(t.expendFormState.package_id=a.list[0].package_id,r(t.expendFormState.package_id)))},s=async()=>{const a=await h();if(g(a)){let e={};t.diskMountSourceList=a.message,t.diskMountPointList=a.message.map((t=>(t.is_default&&(e=t),{label:"".concat(t.mountpoint).concat(" ","(").concat(A(t.used),"/").concat(A(t.total),")").concat(" ").concat(l("Account.Account.whm_account_533924-7"),":").concat(t.is_group_quota?l("Account.Account.whm_account_533924-5"):l("Account.Account.whm_account_533924-6")),value:t.mountpoint}))),a.message.length>0&&(t.expendFormState.mountpoint=e.mountpoint||a.message[0].mountpoint,t.currentChangeDisk=0===Object.keys(e).length?a.message[0]:e)}},r=async a=>{const e=t.packageSourceList.find((t=>t.package_id===a));if(e){const{package_name:a,disk_space_quota:o,monthly_bandwidth_limit:l,max_site_limit:c,max_database:n,php_start_children:u,php_max_children:i,remark:s}=e;t.wpForData.package_name=a,t.wpForData.disk_space_quota=0==o?{value:"",unlimited:!0}:{value:o/1024/1024,unlimited:!1},t.wpForData.monthly_bandwidth_limit=0==l?{value:"",unlimited:!0}:{value:l/1024/1024,unlimited:!1},t.wpForData.max_site_limit=0===c?{value:"",unlimited:!0}:{value:c,unlimited:!1},t.wpForData.max_database=0==n?{value:"",unlimited:!0}:{value:n,unlimited:!1},t.wpForData.php_start_children=u,t.wpForData.php_max_children=i,t.wpForData.remark=s}};const d=()=>{t.acForData.username="",t.acForData.password="",t.acForData.email="",t.acForData.expire_date="0000-00-00",t.expendFormState.package_id=void 0,m()},m=()=>{t.wpForData.package_name="",t.wpForData.disk_space_quota={value:"",unlimited:!1},t.wpForData.monthly_bandwidth_limit={value:"",unlimited:!1},t.wpForData.max_site_limit={value:"",unlimited:!1},t.wpForData.max_database={value:"",unlimited:!1},t.wpForData.php_start_children=1,t.wpForData.php_max_children=1,t.wpForData.remark=""};return{init:c,addHost:async()=>{if(console.log(t.table.total,"xx"),t.table.total>=30)return y.error(l("Account.Account.whm_account_533924-9",[30])),!1;d(),await i(),await s(),t.addVisible=!0,t.isEdit=!1},setLoading:u,loading:n,onLogin:async t=>{const{message:a}=await w({account_id:t});g(a)&&window.open(a.login_url+"?token="+a.token)},modifyStatus:async t=>{const{status:a,username:e}=t;_({title:"".concat(l(0===a?"Site.PHP.index_21_2":"Site.PHP.index_21_3")," ").concat(l("Account.Account.whm_account_533924-0",[e])),content:l(0===a?"Account.Account.whm_account_533924-1":"Account.Account.whm_account_533924-2"),onConfirm:async()=>{await x({...t,status:0===a?1:0}),t.status=0===a?1:0}})},removeAccount:async t=>{_({title:l("Account.Account.account_673836-0",[t.username]),content:()=>e(o,null,[e("div",null,[l("Account.Account.account_673836-1")])]),onConfirm:async()=>{await f({account_id:t.account_id,is_del_resources:!0}),c()}})},form_save:async()=>{var a;await(null==(a=t.accountFormRef)?void 0:a.validate());const e=function(){const{package_id:a,mountpoint:e}=t.expendFormState,{username:o,password:l,email:c,expire_date:n,remark:u}=t.acForData,{disk_space_quota:i,monthly_bandwidth_limit:s,max_site_limit:r,max_database:d,php_start_children:m,php_max_children:p}=t.wpForData;return Object.assign({},{username:o,password:l,email:c,expire_date:n,package_id:a,mountpoint:e,disk_space_quota:i.unlimited?0:String(1024*Number(i.value)*1024),monthly_bandwidth_limit:s.unlimited?0:String(1024*Number(s.value)*1024),max_site_limit:r.unlimited?0:r.value,max_email_account:0,max_database:d.unlimited?0:d.value,php_start_children:m,php_max_children:p,remark:u})}();if(Number(e.disk_space_quota)>0&&!t.isEdit){const{is_group_quota:a,free:o}=t.currentChangeDisk;if(!a)return y.error(l("Account.Account.whm_account_533924-3")),!1;if(o<Number(e.disk_space_quota))return y.error(l("Account.Account.whm_account_533924-4")),!1}try{t.isEdit?(delete e.mountpoint,await x({account_id:t.current_account_id,...e}),d(),c()):(await F(e),d(),c())}catch(o){return Promise.reject(o)}},form_reset:d,package_form_reset:m,getPackageList:i,getDiskList:s,changePackage:r}}));const N=u({props:{options:Array,modelValue:Object,rules:Object,exclude:Array},setup(t,{attrs:a,slots:u,expose:s}){const r=n(null),d=l({});return s(d),i((()=>{var t,a;Object.assign(d,{validate:null==(t=r.value)?void 0:t.validate,restoreValidation:null==(a=r.value)?void 0:a.restoreValidation})})),()=>e(o,null,[e(H,c(a,{model:t.modelValue,ref:r,rules:t.rules}),{default:()=>{var l;return e(o,null,[null==(l=t.options)?void 0:l.filter((a=>{var e;return!(null==(e=t.exclude)?void 0:e.includes(a.key))})).map((o=>function(t,a,o,l){const{label:n,key:u,type:i,options:s}=t;switch(i){case"input":return e(L,c({label:n,path:u},o),{default:()=>[e(P,{value:a[u],"onUpdate:value":t=>a[u]=t},null)]});case"select":return e(L,c({label:n,path:t.key},o),{default:()=>[e(U,{options:s,value:a[u],"onUpdate:value":t=>a[u]=t},null)]});case"checkbox":return e(L,c({label:n,path:t.key},o),{default:()=>[e(j,{checked:a[u],"onUpdate:checked":t=>a[u]=t},null)]});case"date-picker":return e(L,c({label:n,path:t.key},o),{default:()=>[e(V,{"formatted-value":a[u],"onUpdate:formatted-value":t=>a[u]=t,type:"date","value-format":"yyyy-MM-dd"},null)]});case"input-number":return e(L,c({label:n,path:t.key},o),{default:()=>[e(B,{value:a[u],"onUpdate:value":t=>a[u]=t},null)]});case"custom-item":return e(L,c({label:n,path:t.key},o,{disabled:o.disabled}),{default:()=>{var a;return[null==(a=t.slots)?void 0:a.default(o)]}});case"custom-slot":return e(L,c({label:n,path:t.key},o,{disabled:o.disabled}),{default:()=>{var a;return[l&&(null==(a=l[t.key])?void 0:a.call(l))]}})}}(o,t.modelValue,a,u)))])}})])}});function C(){const t=[{type:"input",label:S.global.t("Account.Account.FormHooks-122755-1"),key:"username"},{type:"input",label:S.global.t("Account.Account.FormHooks-122755-2"),key:"password"},{type:"input",label:S.global.t("Account.Account.FormHooks-122755-4"),key:"email"},{type:"custom-slot",label:S.global.t("Account.Account.FormHooks-122755-5"),key:"expire_date"},{type:"input",label:S.global.t("Account.Account.FormHooks-122755-14"),key:"remark"}],a=l({username:"",password:"",email:"",expire_date:"0000-00-00",remark:""}),o=l({username:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-7"),trigger:"blur"}],password:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-8"),trigger:"blur"}],email:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-10"),trigger:"blur"}]});return[u({props:{isEdit:Boolean},setup(u,{attrs:s,expose:r,slots:m}){const p=n(),_=l({});return r(_),i((()=>{var t,a;Object.assign(_,{validate:null==(t=p.value)?void 0:t.validate,restoreValidation:null==(a=p.value)?void 0:a.restoreValidation})})),()=>{return e(N,c({options:t,modelValue:a,"onUpdate:modelValue":t=>a=t,"label-placement":"left","label-width":"130px"},s,{rules:o,ref:p}),"function"==typeof(l=m)||"[object Object]"===Object.prototype.toString.call(l)&&!d(l)?m:{default:()=>[m]});var l}}}),a]}const O=u({props:{modelValue:Object},setup(t,{attrs:a}){var o,c,n,u;const i=l({value:(null==(o=t.modelValue)?void 0:o.value)?null==(c=t.modelValue)?void 0:c.value:0,unlimited:!!(null==(n=t.modelValue)?void 0:n.unlimited)&&(null==(u=t.modelValue)?void 0:u.unlimited)});return s(i,(a=>{t.modelValue.value=a.value,t.modelValue.unlimited=a.unlimited})),()=>{var o;return e("div",{class:"inline-item"},[e("div",{class:"left-item"},[e(B,{value:i.value,"onUpdate:value":t=>i.value=t,disabled:(null==(o=t.modelValue)?void 0:o.unlimited)||a.disabled},null)]),e("div",{class:"right-item"},[e(D,{value:i.unlimited,"onUpdate:value":t=>i.unlimited=t,disabled:a.disabled},{checked:()=>S.global.t("Account.Account.FormHooks-122755-12"),unchecked:()=>S.global.t("Account.Account.FormHooks-122755-12")})])])}}});function E(){const t=[{type:"input",label:S.global.t("Account.Account.FormHooks-122755-13"),key:"package_name"},{type:"input",label:S.global.t("Account.Account.FormHooks-122755-14"),key:"remark"},{type:"custom-item",label:S.global.t("Account.Account.FormHooks-122755-15"),key:"disk_space_quota",slots:{default:t=>e(O,c({modelValue:a.disk_space_quota,"onUpdate:modelValue":t=>a.disk_space_quota=t},t),null)}},{type:"custom-item",label:S.global.t("Account.Account.FormHooks-122755-16"),key:"monthly_bandwidth_limit",slots:{default:t=>e(O,c({modelValue:a.monthly_bandwidth_limit,"onUpdate:modelValue":t=>a.monthly_bandwidth_limit=t},t),null)}},{type:"custom-item",label:S.global.t("Account.Account.FormHooks-122755-17"),key:"max_site_limit",slots:{default:t=>e(O,c({modelValue:a.max_site_limit,"onUpdate:modelValue":t=>a.max_site_limit=t},t),null)}},{type:"input-number",label:S.global.t("Account.Account.FormHooks-122755-18"),key:"php_start_children"},{type:"input-number",label:S.global.t("Account.Account.FormHooks-122755-19"),key:"php_max_children"},{type:"custom-item",label:S.global.t("Account.Account.FormHooks-122755-21"),key:"max_database",slots:{default:t=>e(O,c({modelValue:a.max_database,"onUpdate:modelValue":t=>a.max_database=t},t),null)}}],a=l({package_name:"",remark:"",disk_space_quota:{value:0,unlimited:!0},monthly_bandwidth_limit:{value:0,unlimited:!0},max_site_limit:{value:0,unlimited:!0},php_start_children:1,php_max_children:3,max_database:{value:0,unlimited:!0}}),r=l({package_name:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-22"),trigger:"blur"}],disk_space_quota:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-24"),trigger:"blur",validator:(t,a)=>!!a.unlimited||!!(a.value&&a.value>0)}],monthly_bandwidth_limit:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-25"),trigger:"blur",validator:(t,a)=>!!a.unlimited||!!(a.value&&a.value>0)}],max_site_limit:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-26"),trigger:"blur",validator:(t,a)=>!!a.unlimited||!!(a.value&&a.value>0)}],php_start_children:[{required:!0,validator:(t,a)=>!!a||new Error(S.global.t("Account.Account.FormHooks-122755-27"))}],php_max_children:[{required:!0,validator:(t,a)=>a>0||new Error(S.global.t("Account.Account.FormHooks-122755-28"))}],max_database:[{required:!0,message:S.global.t("Account.Account.FormHooks-122755-30"),trigger:"blur",validator:(t,a)=>!!a.unlimited||!!(a.value&&a.value>0)}]}),d=n();return[u({props:{isDisable:Boolean,exclude:Array},setup(c,{expose:u}){const m=l({}),p=n(!1);return u(m),i((()=>{var t,a;Object.assign(m,{validate:null==(t=d.value)?void 0:t.validate,restoreValidation:null==(a=d.value)?void 0:a.restoreValidation})})),s(c,(t=>{"isDisable"in t&&(p.value=t.isDisable)}),{immediate:!0}),()=>e(o,null,[e(N,{exclude:c.exclude,options:t,modelValue:a,"onUpdate:modelValue":t=>a=t,"label-placement":"left","label-width":"130px",rules:r,ref:d,disabled:p.value},null)])}}),a]}const B=u({props:{value:Number},emits:["update:value"],setup(t,{emit:a,attrs:o}){const l=r(t,"value"),u=n(t.value);function i(t){isNaN(Number(t))?(u.value=0,a("update:value",1)):(u.value=Math.round(t),a("update:value",Number(Math.floor(t))))}return s(l,(t=>{u.value=t})),()=>e(q,c(o,{value:u.value,clearable:!0,"onUpdate:value":i,min:1}),null)}}),R="data:image/svg+xml,%3csvg%20class='icon'%20style='vertical-align:%20bottom;'%20viewBox='0%200%201300%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='4324'%20width='16'%20height='16'%3e%3cpath%20d='M1126.4%20512c0-113.152-91.648-204.8-204.8-204.8-61.952%200-115.2%2029.184-153.6%2082.432-38.4-53.248-91.136-82.432-153.6-82.432-113.152%200-204.8%2091.648-204.8%20204.8s91.648%20204.8%20204.8%20204.8c62.464%200%20115.2-29.184%20153.6-82.432%2038.4%2053.248%2091.648%2082.432%20153.6%2082.432%20113.152%200%20204.8-91.648%20204.8-204.8m102.4-307.2v614.4c0%2084.992-68.608%20153.6-153.6%20153.6H460.8c-84.992%200-153.6-68.608-153.6-153.6V204.8c0-84.992%2068.608-153.6%20153.6-153.6h614.4c84.992%200%20153.6%2068.608%20153.6%20153.6M614.4%20409.6c-56.32%200-102.4%2046.08-102.4%20102.4s46.08%20102.4%20102.4%20102.4c55.296%200%2084.992-52.736%20100.352-102.4-15.36-49.664-45.056-102.4-100.352-102.4m409.6%20102.4c0%2056.32-46.08%20102.4-102.4%20102.4-55.296%200-84.992-52.736-100.352-102.4%2015.36-49.664%2045.056-102.4%20100.352-102.4%2056.32%200%20102.4%2046.08%20102.4%20102.4'%20fill='%2320a53a'%20p-id='4325'%3e%3c/path%3e%3c/svg%3e",T=t("accountStateStore",(()=>{const t=M(),{t:o}=a(),c=n(!1),u=n(!1),i=n(null),s=l({data:[],total:0,loading:!1}),r=n([{title:o("Account.Account.accountState-721844-0"),key:"username",width:130,render:a=>e("span",{class:"text-primary cursor-pointer",onClick:()=>t.onLogin(a.account_id)},[a.username])},{title:o("Account.Account.accountState-721844-1"),key:"package_name",width:100},{title:o("Account.Account.accountState-721844-2"),key:"email"},{key:"quota",title:o("Account.Account.accountState-721844-3"),render:t=>e("span",{class:0===t.disk_space_status?"text-error":""},[0===t.disk_space_used&&0===t.disk_space_quota?"-":A(t.disk_space_used,!0,0),m(" /")," ",0===t.disk_space_quota?e("img",{class:"icon",title:"",src:R},null):A(t.disk_space_quota,!0,0)])},{key:"bandwidth",title:o("Account.Account.accountState-721844-7"),render:t=>e("span",{class:0===t.monthly_bandwidth_status?"text-error":""},[A(t.monthly_bandwidth_used,!0,0),m(" /")," ",0===t.monthly_bandwidth_limit?e("img",{class:"icon",title:"",src:R},null):A(t.monthly_bandwidth_limit,!0,0)])},{title:o("Account.Account.accountState-721844-8"),key:"status",width:68,render:a=>{const l=new Map([[-1,o("Account.Account.accountState-721844-9")],[0,o("Account.Account.accountState-721844-10")],[1,o("Account.Account.accountState-721844-11")],[2,o("Account.Account.accountState-721844-12")]]);return e("span",{onClick:()=>t.modifyStatus(a),class:"cursor-pointer ".concat(1===a.status||-1===a.status?"text-primary":"text-error")},[l.get(a.status)])}},{title:o("Account.Account.accountState-721844-13"),key:"expire_date",width:106,render:t=>"0000-00-00"===t.expire_date?o("Account.Account.whm_account_index_10"):t.expire_date},{title:o("Account.Account.accountState-721844-14"),key:"remark",render:t=>t.remark?t.remark:"--"},b({title:o("Public.Table.Action"),align:"right",width:200,options:a=>[{label:o("Account.Account.accountState-721844-15"),onClick:async()=>{t.onLogin(a.account_id)}},{label:o("Account.Account.accountState-721844-16"),onClick:async()=>{await t.getPackageList(),await t.getDiskList(),_.value=Number(a.account_id),u.value=!0,w.username=a.username,w.password=a.init_password,w.email=a.email,w.expire_date=a.expire_date,w.remark=a.remark,x.value.package_id=Number(a.package_id),x.value.mountpoint=a.mountpoint,t.changePackage(a.package_id),c.value=!0}},{label:o("Account.Account.accountState-721844-17"),onClick:async()=>{t.removeAccount(a)}}]})]),d=n([]),p=l({p:1,rows:10,type_id:-1,search_value:""}),_=n(null),k=n([]),g=n([]),v=n([]),h=n([]),[y,w]=C(),x=n({package_id:-1,mountpoint:""}),F=n(),[f,S]=E();return{addVisible:c,search:p,table:s,columns:r,keys:d,isEdit:u,accountFormRef:i,acForData:w,expendFormState:x,wpForData:S,packageList:k,packageSourceList:g,diskMountPointList:v,diskMountSourceList:h,current_account_id:_,currentChangeDisk:F,initAccountForm:()=>y,initPackageForm:()=>f}}));export{M as a,E as b,R as q,T as u};
