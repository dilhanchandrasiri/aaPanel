const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/open2.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang.js?v=1732601582185","js/naive.js?v=1732601582185","js/vue.js?v=1732601582185","js/__commonjsHelpers__.js?v=1732601582185","js/common.js?v=1732601582185","js/index102.js?v=1732601582185","js/page_layout.js?v=1732601582185","js/public.js?v=1732601582185","css/public.css?v=1732601582185","css/page_layout.css?v=1732601582185","css/index15.css?v=1732601582185","js/index.js?v=1732601582185","css/index80.css?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang2.js?v=1732601582185","js/index97.js?v=1732601582185","css/index10.css?v=1732601582185","js/config3.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185","css/index14.css?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang11.js?v=1732601582185","js/view.js?v=1732601582185","js/index99.js?v=1732601582185","css/index11.css?v=1732601582185","js/index185.js?v=1732601582185","js/index215.js?v=1732601582185","css/index47.css?v=1732601582185","js/index96.js?v=1732601582185"])))=>i.map(i=>d[i]);
import{_ as e}from"./index102.js?v=1732601582185";import{a8 as s,i as t,f as a,c as i,a3 as l,m as n,bm as o,n as c,j as r,k as u,u as d,I as p,Y as _}from"./page_layout.js?v=1732601582185";import{d as S,W as y,r as x,e as g,O as m,P as v,M as f,Y as h,R as b,af as H,ac as w,Q as k,Z as L,c as $,X as B,a6 as j,V as O,j as A,ak as C,F as P,k as U,v as q,n as M}from"./vue.js?v=1732601582185";import{h as R,b as T,a as z,s as E,d as I}from"./public.js?v=1732601582185";import{_ as V}from"./index.js?v=1732601582185";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1732601582185";import{g as N}from"./config3.js?v=1732601582185";import{bo as F,bG as W,bl as G,aa as Q,bL as Y,aW as X,bP as Z,bQ as K,bJ as ee,bh as se}from"./naive.js?v=1732601582185";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1732601582185";const ne=(e,a=!0)=>s.post("/ssh_security?action=set_sshkey",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_3"),successMessage:a}}),oe=()=>s.post("/ssh_security?action=get_key"),ce=e=>s.post("/ssh_security?action=get_logs",e),re=()=>s.post("/ssh_security?action=get_login_send"),ue=(e,a)=>s.post("/ssh_security?action=".concat(e?"set_login_send":"clear_login_send"),a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_9"),successMessage:!0}}),de=()=>s.post("/ssh_security?action=return_ip"),pe=e=>s.post("/ssh_security?action=add_return_ip",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_10"),successMessage:!0}}),_e=e=>s.post("/ssh_security?action=del_return_ip",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_11"),successMessage:!0}}),Se={class:"px-16px pt-4px pb-16px"},ye={class:"mx-20px"},xe={class:"w-200px mr-6px"},ge={class:"ml-10px text-desc"},me={class:"my-24px"},ve={class:"w-360px"},fe={class:"flex w-260px"},he={class:"flex-1 mr-6px"},be={class:"ml-10px text-desc"},He={class:"ml-10px text-desc"},we={class:"my-24px"},ke={class:"ml-10px text-desc"},Le={class:"mt-20px text-desc"},$e=S({__name:"index",setup(e,{expose:u}){const d=j((()=>i((()=>import("./open2.js?v=1732601582185")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])))),p=j((()=>i((()=>import("./view.js?v=1732601582185")),__vite__mapDeps([24,25,3,4,7,2,5,8,9,10,26,6,11,12,13,1,14,15,16,17,18,19,20,21,22,23])))),_=j((()=>i((()=>import("./index185.js?v=1732601582185")),__vite__mapDeps([27,28,3,4,2,5,7,8,9,10,29,30,18,19,20,21,22,6,11,12,13,1,14,15,16,17,23])))),{t:S}=y(),O=x(!1),A=async e=>{var a;await(a={status:e},s.post("/ssh_security?action=".concat(a.status?"set_password":"stop_password"),a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_2"),successMessage:!0}}))},C=x(!1),P=R(S("Security.SSH.Basic.index_19"),{onRefresh:()=>{$e()}}),U=()=>{C.value=!1},q=async e=>{e?P.show=!0:(await s.post("/ssh_security?action=stop_key",{},{requestOptions:{loading:t.global.t("Security.SSH.Api.index_4"),successMessage:!0}}),$e())},M=x(22),E=async()=>{var e;l(M.value)?await(e={port:M.value},s.post("/firewall?action=SetSshPort",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_5"),successMessage:!0}})):n.error(S("Security.SSH.Basic.index_20"),{close:!0})},I=x(null),X=x([]),Z=async e=>{var a;await(a={p_type:e},s.post("/ssh_security?action=set_root",a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_6"),successMessage:!0}}))},K=x(""),ee=()=>{""!==K.value.trim()?z({title:S("Security.SSH.Basic.index_22"),content:S("Security.SSH.Basic.index_23"),onConfirm:async()=>{var e;await(e={username:"root",password:K.value},s.post("/ssh_security?action=set_root_password",e,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_7"),successMessage:!0}}))}}):n.error(S("Security.SSH.Basic.index_21"))},se=R(S("Security.SSH.Basic.index_2")),te=()=>{C.value?se.show=!0:n.error(S("Security.SSH.Basic.index_24"))},ae=async()=>{if(!C.value)return void n.error(S("Security.SSH.Basic.index_25"));const{close:e}=n.loading(S("Security.SSH.Basic.index_26"));try{await oe(),window.open("".concat(o(),"/ssh_security?action=download_key"))}finally{e()}},ie=x(""),le=x({}),ne=g((()=>void 0===Object.keys(le.value).find((e=>e===ie.value)))),ce=g((()=>{const e=le.value[ie.value];return e?e.title:""})),ue=R(S("Security.SSH.Basic.index_13"),{onSetName:e=>{ie.value=e}}),de=()=>{ue.data.config=le.value,ue.show=!0},pe=H(),_e=()=>{pe.push("/security/system-hardening")},$e=async()=>{const{message:e}=await s.post("/ssh_security?action=get_config");a(e)&&(O.value="yes"===e.password,C.value="yes"===e.pubkey,M.value=e.port,I.value=e.root_login_type,a(e.root_login_types)&&(X.value=Object.entries(e.root_login_types).map((([e,s])=>({label:s,value:e})))))},Be=async()=>{const{message:e}=await re();a(e)&&(ie.value=e.result)},je=async()=>{const{message:e}=await N();a(e)&&(le.value=e)},{setLoading:Oe}=T(!0);return(async()=>{try{Oe(!0),await Promise.all([$e(),Be(),je()])}finally{Oe(!1)}})(),u({init:()=>{Be(),$e()}}),(e,s)=>{const t=F,a=W,i=G,l=Q,n=c,o=Y,u=J,S=r,y=D,x=V;return m(),v("div",Se,[f(y,{"label-width":"140px"},{default:h((()=>[f(a,{label:e.$t("Security.SSH.Basic.index_1")},{default:h((()=>[f(t,{value:b(O),"onUpdate:value":[s[0]||(s[0]=e=>w(O)?O.value=e:null),A],size:"small"},null,8,["value"]),k("span",ye,L(e.$t("Security.SSH.Basic.index_2")),1),f(t,{value:b(C),"onUpdate:value":[s[1]||(s[1]=e=>w(C)?C.value=e:null),q],size:"small"},null,8,["value"])])),_:1},8,["label"]),f(a,{label:e.$t("Security.SSH.Basic.index_3"),"show-feedback":!1},{default:h((()=>[k("div",xe,[f(i,{value:b(M),"onUpdate:value":s[2]||(s[2]=e=>w(M)?M.value=e:null),min:1,max:65535,"show-button":!1},null,8,["value"])]),f(l,{type:"primary",onClick:E},{default:h((()=>[$(L(e.$t("Public.Btn.Save")),1)])),_:1}),k("div",ge,L(e.$t("Security.SSH.Basic.index_4")),1)])),_:1},8,["label"]),k("div",me,[f(n)]),f(a,{label:e.$t("Security.SSH.Basic.index_5")},{default:h((()=>[k("div",ve,[f(o,{value:b(I),"onUpdate:value":[s[3]||(s[3]=e=>w(I)?I.value=e:null),Z],options:b(X)},null,8,["value","options"])])])),_:1},8,["label"]),f(a,{label:e.$t("Security.SSH.Basic.index_6")},{default:h((()=>[k("div",fe,[k("div",he,[f(u,{value:b(K),"onUpdate:value":s[4]||(s[4]=e=>w(K)?K.value=e:null),default:!1},null,8,["value"])]),f(l,{type:"primary",onClick:ee},{default:h((()=>[$(L(e.$t("Public.Btn.Reset")),1)])),_:1})]),k("div",be,L(e.$t("Security.SSH.Basic.index_8")),1)])),_:1},8,["label"]),f(a,{label:e.$t("Security.SSH.Basic.index_9"),"show-feedback":!1},{default:h((()=>[f(l,{type:"primary",class:"btn-xs",onClick:te},{default:h((()=>[$(L(e.$t("Security.SSH.Basic.index_10")),1)])),_:1}),f(l,{class:"btn-xs ml-10px",onClick:ae},{default:h((()=>[$(L(e.$t("Public.Btn.Download")),1)])),_:1}),k("div",He,L(e.$t("Security.SSH.Basic.index_12")),1)])),_:1},8,["label"]),k("div",we,[f(n)]),f(a,{label:e.$t("Security.SSH.Basic.index_13"),"show-feedback":!1},{default:h((()=>[b(ne)?(m(),B(S,{key:0,type:"warning",onClick:de},{default:h((()=>[$(L(e.$t("Security.SSH.Basic.index_14")),1)])),_:1})):(m(),B(S,{key:1,onClick:de},{default:h((()=>[$(L(e.$t("Security.SSH.Basic.index_15",[b(ce)])),1)])),_:1})),f(l,{type:"primary",class:"btn-xs ml-10px",onClick:de},{default:h((()=>[$(L(e.$t("Public.Btn.Set")),1)])),_:1}),k("div",ke,L(e.$t("Security.SSH.Basic.index_12")),1)])),_:1},8,["label"]),k("div",Le,[$(L(e.$t("Security.SSH.Basic.index_17"))+" ",1),f(S,{onClick:_e},{default:h((()=>[$(">>"+L(e.$t("Security.SSH.Basic.index_18")),1)])),_:1})])])),_:1}),f(x,{show:b(P).show,"onUpdate:show":s[5]||(s[5]=e=>b(P).show=e),title:b(P).title,data:b(P).data,width:400,"min-height":124,footer:!0,component:b(d),onPublicClose:U},null,8,["show","title","data","component"]),f(x,{show:b(se).show,"onUpdate:show":s[6]||(s[6]=e=>b(se).show=e),title:b(se).title,width:400,"min-height":322,component:b(p)},null,8,["show","title","component"]),f(x,{show:b(ue).show,"onUpdate:show":s[7]||(s[7]=e=>b(ue).show=e),title:b(ue).title,data:b(ue).data,width:1e3,height:600,component:b(_)},null,8,["show","title","data","component"])])}}}),Be={class:"pt-40px pb-40px"},je={class:"mb-24px text-center text-22px font-bold"},Oe={class:"mb-16px"},Ae={class:"ul-style"},Ce={class:"ml-4px"},Pe={class:"text-center my-24px"},Ue={class:"flex justify-center"},qe={class:"w-76%"},Me=u(S({__name:"free",setup(e){const s=()=>{E({source:100})};return(e,t)=>{const a=Q,i=X;return m(),v("div",Be,[k("div",je,L(e.$t("Security.SSH.Logs.free_1")),1),k("div",Oe,[k("ul",Ae,[k("li",null,[k("span",Ce,L(e.$t("Security.SSH.Logs.free_2")),1)])])]),k("div",Pe,[f(a,{type:"primary",class:"h-36px text-14px",onClick:s},{default:h((()=>[$(L(e.$t("WP.Transition.index_7")),1)])),_:1})]),k("div",Ue,[k("div",qe,[f(i,{class:"flex justify-center w-full",src:b("/static/vite/images/ssh-logs.png")},null,8,["src"])])])])}}}),[["__scopeId","data-v-6bf43814"]]),Re=S({__name:"index",setup(e,{expose:i}){const{t:l}=y(),o=d(),{isPro:c}=O(o),{table:r,columns:u,setLoading:_}=I([{key:"address",title:l("Security.SSH.Logs.index_5"),render:e=>f("a",{class:"bt-link",href:"javascript:;",onClick:()=>{S(e)}},[e.address,$(":"),f("span",{class:"text-#666 cursor-default"},[e.port])])},{key:"area",title:l("Security.SSH.Logs.index_6"),render:e=>e.area.info||"--"},{key:"user",title:l("Security.SSH.Logs.index_7")},{key:"status",title:l("Security.SSH.Logs.index_8"),render:e=>f("span",{class:e.status?"text-primary":"text-error"},[e.status?l("Security.SSH.Logs.index_14"):l("Security.SSH.Logs.index_15")])},{key:"time",title:l("Security.SSH.Logs.index_9")}]),S=e=>{z({title:l("Security.SSH.Logs.index_10"),content:e.deny_status?l("Security.SSH.Logs.index_13"):l("Security.SSH.Logs.index_11"),onConfirm:async()=>{if(e.deny_status){const{message:i}=await(a={address:e.address},s.post("/safe/syslog/remove_ip_rules",{data:JSON.stringify(a)},{requestOptions:{loading:t.global.t("Security.SSH.Api.index_8")}}));p(i)&&i.length>0&&n.success(i[0].msg)}else{const{message:a}=await(e=>s.post("/safe/syslog/create_ip_rules",{data:JSON.stringify(e)},{requestOptions:{loading:t.global.t("Security.SSH.Api.index_8")}}))({address:e.address,types:"drop",brief:l("Security.SSH.Logs.index_12"),domain:"",choose:"address"});p(a)&&a.length>0&&n.success(a[0].msg)}var a;v()}})},x=A({p:1,limit:20,select:"ALL",search:""}),g=()=>{c.value&&(x.p=1,v())},v=async()=>{try{_(!0);const{message:t}=await(e=C(x),s.post("/safe/syslog/get_ssh_list",{data:JSON.stringify(e)}));a(t)&&(r.data=p(t.data)?t.data:[],r.total=r.data.length)}finally{_(!1)}var e};return g(),i({init:()=>{x.select="ALL",g()}}),(e,s)=>{const t=Q,a=Z,i=K,l=le,n=ie,o=ae,d=te;return b(c)?(m(),B(d,{key:0},{toolsLeft:h((()=>[f(t,{type:"primary",onClick:g},{default:h((()=>[$(L(e.$t("Public.Btn.Refresh")),1)])),_:1})])),toolsRight:h((()=>[f(i,{value:b(x).select,"onUpdate:value":[s[0]||(s[0]=e=>b(x).select=e),g]},{default:h((()=>[f(a,{value:"ALL"},{default:h((()=>[$(L(e.$t("Security.SSH.Logs.index_1")),1)])),_:1}),f(a,{value:"Accepted"},{default:h((()=>[$(L(e.$t("Security.SSH.Logs.index_2")),1)])),_:1}),f(a,{value:"Failed"},{default:h((()=>[$(L(e.$t("Security.SSH.Logs.index_3")),1)])),_:1})])),_:1},8,["value"]),f(l,{value:b(x).search,"onUpdate:value":s[1]||(s[1]=e=>b(x).search=e),width:"320",placeholder:e.$t("Security.SSH.Logs.index_4"),onSearch:g},null,8,["value","placeholder"])])),table:h((()=>[f(n,{loading:b(r).loading,data:b(r).data,columns:b(u)},null,8,["loading","data","columns"])])),pageRight:h((()=>[f(o,{page:b(x).p,"onUpdate:page":s[2]||(s[2]=e=>b(x).p=e),"page-size":b(x).limit,"onUpdate:pageSize":s[3]||(s[3]=e=>b(x).limit=e),"item-count":b(r).total,onRefresh:v},null,8,["page","page-size","item-count"])])),_:1})):(m(),B(Me,{key:1}))}}}),Te={class:"mr-10px"},ze={class:"mx-20px"},Ee=S({__name:"index",setup(i){const{t:l}=y(),n=A({status:!1,success:0,successToday:0,error:0,errorToday:0}),o=x(),u=x("basic"),d=[{key:"basic",label:l("Security.SSH.index_5"),component:$e},{key:"logs",label:l("Security.SSH.index_6"),data:{type:"ALL"},component:Re}],p=e=>{o.value.setValue("logs"),M((()=>{const s=o.value.getCompRef("logs");s&&s.init(e)}))},S=async()=>{const{message:e}=await s.post("/safe/ssh/GetSshInfo");a(e)&&(n.status=e.status)},g=async()=>{const{message:e}=await s.post("/safe/ssh/get_ssh_login_info");a(e)&&(n.success=e.success,n.successToday=e.today_success,n.error=e.error,n.errorToday=e.today_error)},H=e=>{z({title:l("Security.SSH.index_7"),content:l(e?"Security.SSH.index_8":"Security.SSH.index_9"),onConfirm:async()=>{var a;await(a={status:e?0:1},s.post("/firewall?action=SetSshStatus",a,{requestOptions:{loading:t.global.t("Security.SSH.Api.index_1"),successMessage:!0}})),S(),g()}})},{loading:B,setLoading:j}=T();return j(!0),Promise.all([S(),g()]).finally((()=>{j(!1)})),(s,t)=>{const a=_,i=F,l=c,S=r,y=se,x=ee,g=e;return m(),v(P,null,[f(x,{class:"mb-16px p-16px"},{default:h((()=>[U(f(a,{width:600,height:20,sharp:!1,size:"medium"},null,512),[[q,b(B)]]),U(f(y,{class:"items-center",size:0},{default:h((()=>[k("div",Te,L(s.$t("Security.SSH.index_1")),1),f(i,{value:b(n).status,"onUpdate:value":H},null,8,["value"]),k("div",ze,[f(l,{class:"mx-0! text-20px",vertical:""})]),k("div",null,[k("span",null,L(s.$t("Security.SSH.index_2")),1),f(S,{onClick:t[0]||(t[0]=e=>p("Accepted"))},{default:h((()=>[$(L(s.$t("Security.SSH.index_3",[b(n).success,b(n).successToday])),1)])),_:1}),t[3]||(t[3]=k("span",{class:"mx-10px"},"/",-1)),f(S,{type:"error",onClick:t[1]||(t[1]=e=>p("Failed"))},{default:h((()=>[$(L(s.$t("Security.SSH.index_4",[b(n).error,b(n).errorToday])),1)])),_:1})])])),_:1},512),[[q,!b(B)]])])),_:1}),f(x,{class:"p-16px"},{default:h((()=>[f(g,{ref_key:"tabsRef",ref:o,value:b(u),"onUpdate:value":t[2]||(t[2]=e=>w(u)?u.value=e:null),options:d},null,8,["value"])])),_:1})],64)}}}),Ie=Object.freeze(Object.defineProperty({__proto__:null,default:Ee},Symbol.toStringTag,{value:"Module"}));export{ce as a,re as b,de as c,_e as d,pe as e,oe as g,Ie as i,ne as o,ue as s};
