import{s as a,_ as e,f as l}from"./configStore.js?v=1732601582185";import{_ as s}from"./index99.js?v=1732601582185";import{m as t,a5 as n,a6 as i,_ as o,f as r,k as f}from"./page_layout.js?v=1732601582185";import{d as c,W as p,r as u,$ as v,O as d,P as m,Q as x,M as _,Z as g,Y as w,R as b,ac as C,k as S,v as y,c as h}from"./vue.js?v=1732601582185";import{r as $}from"./home.js?v=1732601582185";import{t as k,L as j,M as P,u as U}from"./global.js?v=1732601582185";import{bL as L,ad as K}from"./naive.js?v=1732601582185";const M={class:"px-40px py-24px"},O={class:"flex-center mb-20px"},R={class:"min-w-32px"},z={class:"ml-4px text-21px"},E={class:"text-error"},I={class:"bt-link",href:"https://www.aapanel.com/forum/d/167-common-problems-after-opening-the-panel-certificate",target:"_blank"},N={class:"flex"},Q={class:"form-label"},T={class:"w-280px"},W={class:"flex mt-16px"},Y={class:"form-label"},Z={class:"w-280px"},q={class:"flex mt-16px"},A={class:"form-label"},B={class:"w-280px"},D={class:"flex mt-16px"},F={class:"form-label"},G={class:"w-280px"},H={class:"flex justify-between mt-24px"},J={class:"bt-link",href:"https://www.aapanel.com/forum/d/167-common-problems-after-opening-the-panel-certificate",target:"_blank"},V=f(c({__name:"open",setup(f,{expose:c}){const{t:V}=p(),X=u(),aa=u(1),ea=u(""),la=u(""),sa=u(""),ta=[{label:V("Config.Safe.index_30"),value:1},{label:"Let's Encrypt",value:2},{label:V("Config.Safe.index_31"),value:3}],na=async()=>{const{message:a}=await P();r(a)&&(aa.value=a.cert_type?Number(a.cert_type):1,ea.value=a.email||"")},ia=async()=>{const{message:a}=await U();r(a)&&(la.value=a.privateKey||"",sa.value=a.certPem||"")};return(async()=>{const a=t.loading(V("Config.Safe.index_32"));try{await Promise.all([na(),ia()])}finally{a.close()}})(),c({onConfirm:async()=>{if(await X.value.validate(),2===aa.value&&""===ea.value.trim())return t.error(V("Config.Safe.index_33")),!1;if(2===aa.value&&!n(ea.value))return t.error(V("Config.Safe.index_34")),!1;if(3===aa.value&&(""===la.value.trim()||""===sa.value.trim()))return t.error(V("Config.Safe.index_35")),!1;const e=t.loading(V("Config.Safe.index_36"));try{3===aa.value&&await k({privateKey:la.value,certPem:sa.value}),await j((()=>{const a=2===aa.value?{email:ea.value}:{};return{cert_type:aa.value,...a}})(),!1),await $(),setTimeout((()=>{if(i){const e="http:"===location.protocol?"https":"http";window.location.href="".concat(e,"://").concat(window.location.host).concat(a.value.adminPath)}}),1500)}finally{e.close()}return!1}}),(a,t)=>{const n=o,i=v("i18n-t"),r=e,f=L,c=K,p=s,u=l;return d(),m("div",M,[x("div",O,[x("div",R,[_(n,{name:"scan-success",size:"32"})]),x("span",z,g(a.$t("Config.Safe.index_18")),1)]),_(r,{class:"mb-20px"},{default:w((()=>[x("li",E,g(a.$t("Config.Safe.index_19")),1),x("li",null,g(a.$t("Config.Safe.index_20")),1),_(i,{tag:"li",scope:"global",keypath:"Config.Safe.index_21"},{link_:w((()=>[x("a",I,g(a.$t("Config.Safe.index_22")),1)])),_:1})])),_:1}),x("div",N,[x("span",Q,g(a.$t("Config.Safe.index_24")),1),x("div",T,[_(f,{value:b(aa),"onUpdate:value":t[0]||(t[0]=a=>C(aa)?aa.value=a:null),options:ta},null,8,["value"])])]),S(x("div",W,[x("span",Y,g(a.$t("Config.Safe.index_25")),1),x("div",Z,[_(c,{value:b(ea),"onUpdate:value":t[1]||(t[1]=a=>C(ea)?ea.value=a:null),placeholder:a.$t("Config.Safe.index_26")},null,8,["value","placeholder"])])],512),[[y,2===b(aa)]]),S(x("div",q,[x("span",A,g(a.$t("Config.Safe.index_27")),1),x("div",B,[_(p,{value:b(la),"onUpdate:value":t[2]||(t[2]=a=>C(la)?la.value=a:null),rows:4,placeholder:""},null,8,["value"])])],512),[[y,3===b(aa)]]),S(x("div",D,[x("span",F,g(a.$t("Config.Safe.index_28")),1),x("div",G,[_(p,{value:b(sa),"onUpdate:value":t[3]||(t[3]=a=>C(sa)?sa.value=a:null),rows:4,placeholder:""},null,8,["value"])])],512),[[y,3===b(aa)]]),x("div",H,[_(u,{ref_key:"riskRef",ref:X},{default:w((()=>[h(g(a.$t("Config.Safe.index_29")),1)])),_:1},512),x("a",J,g(a.$t("Config.Safe.index_167")),1)])])}}}),[["__scopeId","data-v-02bc9a9f"]]);export{V as O};
