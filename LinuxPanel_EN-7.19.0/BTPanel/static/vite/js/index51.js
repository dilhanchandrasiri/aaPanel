const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index184.js?v=1732601582185","js/index.js?v=1732601582185","js/vue.js?v=1732601582185","js/__commonjsHelpers__.js?v=1732601582185","js/common.js?v=1732601582185","js/public.js?v=1732601582185","js/page_layout.js?v=1732601582185","js/naive.js?v=1732601582185","css/page_layout.css?v=1732601582185","css/public.css?v=1732601582185","css/index80.css?v=1732601582185","js/index96.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185","js/mail.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang.js?v=1732601582185","js/index171.js?v=1732601582185","css/index21.css?v=1732601582185"])))=>i.map(i=>d[i]);
import{k as t,bf as a,m as e,f as s,I as i,j as n,_ as l,u as o,c as d,bg as u}from"./page_layout.js?v=1732601582185";import{_ as r}from"./index121.js?v=1732601582185";import{d as p,O as c,P as _,Q as m,Z as v,m as x,W as g,r as f,X as h,Y as y,M as S,c as w,R as b,ac as k,j as M,V as $,e as C,af as P,$ as j,ad as U,ao as R,F as L,a6 as B}from"./vue.js?v=1732601582185";import{i as I}from"./soft.js?v=1732601582185";import{b as z,h as E,a as V,d as D,_ as O,f as Q,u as W}from"./public.js?v=1732601582185";import{P as T,Q as X,R as Y,S as Z,T as A,k as F,U as G,V as H,W as J,X as N,Y as q,Z as K,_ as tt,$ as at,a0 as et}from"./mail.js?v=1732601582185";import{b$ as st,bQ as it,bl as nt,bM as lt,bN as ot,aa as dt,ad as ut,bG as rt,bL as pt,_ as ct,bp as _t,bh as mt,bo as vt,bJ as xt}from"./naive.js?v=1732601582185";import{_ as gt}from"./index.js?v=1732601582185";import{_ as ft}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{b as ht}from"./site.js?v=1732601582185";import{_ as yt}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{_ as St}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./theme-chrome.js?v=1732601582185";import"./file.js?v=1732601582185";const wt={class:"setting-card"},bt={class:"setting-title"},kt=t(p({__name:"index",props:{title:{default:""}},setup:t=>(t,a)=>(c(),_("div",wt,[m("div",bt,v(t.title),1),x(t.$slots,"default",{},void 0,!0)]))}),[["__scopeId","data-v-7c578c97"]]),Mt={class:"flex items-center"},$t=p({__name:"index",setup(t){const{t:i}=g(),n=a(),l=f(0),o=f(null),d=async()=>{o.value||0===o.value?(await T({save_day:0===l.value?0:o.value}),u()):e.error(i("Mail.Setting.index_27"))},u=async()=>{const{message:t}=await X();s(t)&&(0===t.result?(l.value=0,o.value=null):(l.value=1,o.value=t.result))};return n.setup&&u(),(t,a)=>{const e=st,s=it,i=nt,n=lt,u=ot,r=dt;return c(),h(kt,{title:t.$t("Mail.Setting.index_24")},{default:y((()=>[m("div",Mt,[S(s,{value:b(l),"onUpdate:value":a[0]||(a[0]=t=>k(l)?l.value=t:null)},{default:y((()=>[S(e,{value:0},{default:y((()=>[w(v(t.$t("Mail.Setting.index_25")),1)])),_:1}),S(e,{class:"ml-24px",value:1},{default:y((()=>[w(v(t.$t("Mail.Setting.index_26")),1)])),_:1})])),_:1},8,["value"]),S(u,{class:"w-240px"},{default:y((()=>[S(i,{value:b(o),"onUpdate:value":a[1]||(a[1]=t=>k(o)?o.value=t:null),class:"flex-1 ml-16px",min:0,disabled:0===b(l),"show-button":!1,placeholder:t.$t("Mail.Setting.index_27")},null,8,["value","disabled","placeholder"]),S(n,null,{default:y((()=>[w(v(t.$t("Public.Unit.Day",null===b(o)?2:b(o))),1)])),_:1})])),_:1}),S(r,{class:"ml-24px",type:"primary",ghost:"",onClick:d},{default:y((()=>[w(v(t.$t("Public.Btn.Save")),1)])),_:1})])])),_:1},8,["title"])}}}),Ct={class:"p-20px pt-24px pb-8px"},Pt={class:"w-280px"},jt={class:"w-280px"},Ut=p({__name:"install",emits:["refresh"],setup(t,{expose:a,emit:e}){const i=e,{t:n}=g(),l=f(null),o=M({domain:"",php_version:null}),d={domain:{trigger:"change",validator:()=>""!==o.domain.trim()||new Error(n("Mail.Setting.index_20"))},php_version:{trigger:"change",validator:()=>null!==o.php_version||new Error(n("Mail.Setting.index_21"))}},u=f([]),r=async()=>{const{message:t}=await ht();if(s(t)){u.value=t.versions.reverse().map((t=>({label:t.name,value:t.version})));const a=t.versions.findIndex((t=>"74"===t.version));o.php_version=-1!==a?t.versions[a].version:t.versions[0].version}},{loading:p,setLoading:v}=z();return(async()=>{try{v(!0),await Promise.all([r()])}finally{v(!1)}})(),a({onConfirm:async()=>{var t;await(null==(t=l.value)?void 0:t.validate()),await Y({site_name:o.domain||"",php_version:o.php_version||""}),i("refresh")}}),(t,a)=>{const e=ut,s=rt,i=pt,n=ft;return c(),_("div",Ct,[S(n,{ref_key:"formRef",ref:l,model:b(o),rules:d},{default:y((()=>[S(s,{label:t.$t("Mail.Setting.index_18"),path:"domain"},{default:y((()=>[m("div",Pt,[S(e,{value:b(o).domain,"onUpdate:value":a[0]||(a[0]=t=>b(o).domain=t)},null,8,["value"])])])),_:1},8,["label"]),S(s,{label:t.$t("Mail.Setting.index_19"),path:"php_version"},{default:y((()=>[m("div",jt,[S(i,{value:b(o).php_version,"onUpdate:value":a[1]||(a[1]=t=>b(o).php_version=t),loading:b(p),options:b(u)},null,8,["value","loading","options"])])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),Rt={class:"p-20px pt-24px pb-8px"},Lt={class:"w-280px"},Bt=p({__name:"config",emits:["refresh"],setup(t,{expose:a,emit:e}){const n=e,{t:l}=g(),o=f(null),d=M({id:0,domain:null,path:""}),u={domain:{trigger:"change",validator:()=>null!==d.domain||new Error(l("Mail.Setting.index_23"))}},r=f([]),p=async()=>{const{message:t}=await A();i(t)&&(r.value=t.map((t=>({label:t.name,value:t.name,data:t}))),t.length&&(d.domain=t[0].name,d.path=t[0].path,d.id=t[0].id))},v=(t,a)=>{const{data:e}=a;s(e)&&(d.id=e.id,d.path=e.path)},{loading:x,setLoading:h}=z();return(async()=>{try{h(!0),await Promise.all([p()])}finally{h(!1)}})(),a({onConfirm:async()=>{var t;await(null==(t=o.value)?void 0:t.validate()),await Z({id:d.id,site_name:d.domain||"",path:d.path}),n("refresh")}}),(t,a)=>{const e=pt,s=rt,i=ft;return c(),_("div",Rt,[S(i,{ref_key:"formRef",ref:o,model:b(d),rules:u},{default:y((()=>[S(s,{label:t.$t("Mail.Setting.index_22"),path:"domain"},{default:y((()=>[m("div",Lt,[S(e,{value:b(d).domain,"onUpdate:value":[a[0]||(a[0]=t=>b(d).domain=t),v],loading:b(x),options:b(r)},null,8,["value","loading","options"])])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),It={class:"flex items-center mr-32px text-13px"},zt={class:"mr-4px"},Et={key:0,class:"mr-24px text-13px"},Vt={class:"mr-10px"},Dt=p({__name:"index",setup(t){const{t:e}=g(),i=a(),{setup:o}=$(i),d=M({id:0,site_name:"",status:!1,ssl_status:!1}),u=C((()=>"".concat(d.ssl_status?"https":"http","://").concat(d.site_name))),r=P(),p=()=>{r.push("/site/php")},x=async()=>{const{message:t}=await F();s(t)&&(d.id=t.id,d.status=t.status,d.site_name=t.site_name,d.ssl_status=t.ssl_status)},k=E(e("Mail.Setting.index_14"),{onRefresh:x}),B=()=>{k.show=!0},I=()=>{const t=f(!1);V({title:e("Mail.Setting.index_15"),width:420,content:()=>S(L,null,[S("div",{class:"mb-16px"},[e("Mail.Setting.index_16",[d.site_name])]),S(ct,{checked:t.value,onUpdateChecked:a=>{t.value=a}},{default:()=>[S("div",{class:"text-desc leading-[1.4]"},[e("Mail.Setting.index_17")])]})]),onConfirm:async()=>{await G({id:d.id,site_name:d.site_name,force:t.value?1:0}),x()}})},z=E(e("Mail.Setting.index_12"),{onRefresh:x}),D=()=>{z.show=!0};return o.value&&x(),(t,a)=>{const e=n,s=j("i18n-t"),i=dt,o=l,r=_t,x=mt,g=gt;return c(),h(kt,{title:"WebMail"},{default:y((()=>[S(x,{class:"items-center",size:0},{default:y((()=>[m("div",It,[m("span",zt,v(t.$t("Mail.Setting.index_6")),1),m("span",{class:U(b(d).status?"text-primary":"text-error")},v(b(d).status?t.$t("Mail.Setting.index_7"):t.$t("Mail.Setting.index_8")),3)]),b(d).status?(c(),_("div",Et,[m("span",Vt,v(t.$t("Mail.Setting.index_9")),1),S(e,{href:b(u),target:"_blank"},{default:y((()=>[w(v(b(u)),1)])),_:1},8,["href"]),b(d).ssl_status?R("",!0):(c(),h(s,{key:0,tag:"span",class:"ml-6px text-desc",keypath:"Mail.Setting.index_10",scope:"global"},{link_1:y((()=>[S(e,{onClick:p},{default:y((()=>[w(v(t.$t("Mail.Setting.index_11")),1)])),_:1})])),_:1}))])):R("",!0),b(d).status?(c(),h(i,{key:1,onClick:I},{default:y((()=>[w(v(t.$t("Public.Btn.Uninstall")),1)])),_:1})):(c(),_(L,{key:2},[S(i,{type:"primary",ghost:"",onClick:B},{default:y((()=>[w(v(t.$t("Public.Btn.Install")),1)])),_:1}),S(i,{class:"ml-10px",onClick:D},{default:y((()=>[m("span",null,v(t.$t("Mail.Setting.index_12")),1)])),_:1}),S(r,null,{trigger:y((()=>[S(o,{class:"ml-6px",name:"common-ask",size:"16"})])),default:y((()=>[w(v(t.$t("Mail.Setting.index_13")),1)])),_:1})],64))])),_:1}),S(g,{show:b(k).show,"onUpdate:show":a[0]||(a[0]=t=>b(k).show=t),title:b(k).title,data:b(k).data,width:480,footer:!0,"confirm-text":t.$t("Public.Btn.Install"),component:Ut},null,8,["show","title","data","confirm-text"]),S(g,{show:b(z).show,"onUpdate:show":a[1]||(a[1]=t=>b(z).show=t),title:b(z).title,data:b(z).data,width:480,footer:!0,component:Bt},null,8,["show","title","data"])])),_:1})}}}),Ot={class:"text-13px"},Qt=p({__name:"index",setup(t){const{t:e}=g(),s=a(),i=f(!1),n=async t=>{t?V({width:380,title:e("Mail.Setting.index_29"),content:e("Mail.Setting.index_30"),onConfirm:async()=>{await H()},onPublicClose:()=>{i.value=!t}}):await J()},{loading:l,setLoading:o}=z();return s.setup&&(async()=>{try{o(!0),await N(),i.value=!0}catch(t){i.value=!1,console.error(t)}finally{o(!1)}})(),(t,a)=>{const e=vt,s=mt;return c(),h(kt,{title:"Monitoring"},{default:y((()=>[S(s,{class:"items-center",size:24},{default:y((()=>[m("div",Ot,v(t.$t("Mail.Setting.index_28")),1),S(e,{value:b(i),"onUpdate:value":[a[0]||(a[0]=t=>k(i)?i.value=t:null),n],loading:b(l)},null,8,["value","loading"])])),_:1})])),_:1})}}}),Wt={class:"p-16px"},Tt=p({__name:"config",props:{row:{}},setup(t,{expose:a}){const e=t,{row:i}=e,n=f(""),l=f("utf-8"),{loading:o,setLoading:d}=z();return(async()=>{try{d(!0);const{message:t}=await q({service:i.key});s(t)&&(n.value=t.data,l.value=t.encoding)}finally{d(!1)}})(),a({onConfirm:async()=>{await K({service:i.key,data:n.value})}}),(t,a)=>(c(),_("div",Wt,[S(St,{value:b(n),"onUpdate:value":a[0]||(a[0]=t=>k(n)?n.value=t:null),encoding:b(l),"onUpdate:encoding":a[1]||(a[1]=t=>k(l)?l.value=t:null),height:550,load:b(o),"show-encoding":!0},null,8,["value","encoding","load"])]))}}),Xt=p({__name:"index",setup(t){const e=a(),{t:i}=g(),{table:n,columns:l}=D([{key:"name",title:i("Mail.Setting.index_31")},{key:"status",title:i("Mail.Setting.index_32"),render:t=>S(O,{value:t.status,checkedValue:!0,onClick:()=>{o(t)}},null)},Q({width:200,options:t=>[{label:t.status?i("Public.Status.Stop"):i("Public.Status.Start"),onClick:()=>{o(t)}},{label:i("Public.Status.Restart"),onClick:()=>{d(t)}},{label:i("Public.Btn.Repair"),onClick:()=>{u(t)}},{label:i("Public.Btn.Config"),onClick:()=>{p(t)}}]})]),o=t=>{V({title:i("Mail.Setting.index_33",[t.key,t.status?i("Public.Status.Stop"):i("Public.Status.Start")]),content:i("Mail.Setting.index_34",[t.key,t.status?i("Public.Status.Stop").toLowerCase():i("Public.Status.Start").toLowerCase()]),onConfirm:async()=>{await tt({service:t.key,type:t.status?"stop":"start"}),v()}})},d=t=>{V({title:i("Mail.Setting.index_33",[t.key,i("Public.Status.Restart")]),content:i("Mail.Setting.index_34",[t.key,i("Public.Status.Restart").toLowerCase()]),onConfirm:async()=>{await tt({service:t.key,type:"restart"}),v()}})},u=t=>{let a=i("Mail.Setting.index_34",[t.key,i("Public.Btn.Repair").toLowerCase()]);"dovecot"===t.key?a=i("Mail.Setting.index_35"):"postfix"===t.key&&(a=i("Mail.Setting.index_36")),V({title:i("Mail.Setting.index_33",[t.key,i("Public.Btn.Repair")]),content:a,onConfirm:async()=>{await at({service:t.key,type:"repair"}),v()}})},r=E(),p=t=>{r.data.row=t,r.title=i("Mail.Setting.index_37",["".concat(t.key,"_config_file")]),r.show=!0},{loading:_,setLoading:m}=z(),v=async()=>{try{m(!0);const{message:t}=await et();s(t)&&(n.data=[],n.data.push({key:"dovecot",name:"Dovecot",status:t.dovecot}),t.change_rspamd&&n.data.push({key:"opendkim",name:"Opendkim",status:t.opendkim}),n.data.push({key:"rspamd",name:"Rspamd",status:t.rspamd}),n.data.push({key:"postfix",name:"Postfix",status:t.postfix}))}finally{m(!1)}};return e.setup&&v(),(t,a)=>{const e=yt,s=gt;return c(),h(kt,{title:"Service Status"},{default:y((()=>[S(e,{loading:b(_),"loading-num":3,data:b(n).data,columns:b(l)},null,8,["loading","data","columns"]),S(s,{show:b(r).show,"onUpdate:show":a[0]||(a[0]=t=>b(r).show=t),title:b(r).title,data:b(r).data,width:800,height:624,footer:!0,"confirm-text":t.$t("Public.Btn.Save"),component:Tt},null,8,["show","title","data","confirm-text"])])),_:1})}}}),Yt={class:"mr-8px"},Zt={class:"mr-8px"},At=t(p({__name:"index",setup(t){const{t:e}=g(),s=a(),{setup:i,install:n,update:l,version:p,lastVersion:x}=$(s),f=o(),{userInfo:k}=$(f),M=()=>{n.value&&!l.value?W({title:e("Mail.Setting.index_5"),width:560,height:550,component:B((()=>d((()=>import("./index184.js?v=1732601582185")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]))))}):I("mail_sys")},C=()=>{u()};return(t,a)=>{const e=dt,s=xt,o=r;return c(),h(o,{install:b(i)},{desc:y((()=>[b(k).status?(c(),_(L,{key:1},[m("span",Zt,v(b(n)?b(l)?t.$t("Mail.Setting.index_4",[b(p),b(x)]):t.$t("Mail.Setting.index_5"):t.$t("Mail.Setting.index_3")),1),S(e,{class:"px-8px h-24px",type:"primary",size:"small",onClick:M},{default:y((()=>[w(v(t.$t("Public.Btn.Install")),1)])),_:1})],64)):(c(),_(L,{key:0},[m("span",Yt,v(t.$t("Mail.Setting.index_1")),1),S(e,{class:"px-8px h-24px",type:"primary",size:"small",onClick:C},{default:y((()=>[w(v(t.$t("Mail.Setting.index_2")),1)])),_:1})],64))])),default:y((()=>[S(s,{class:"p-16px"},{default:y((()=>[S(Dt),S($t),S(Qt),S(Xt)])),_:1})])),_:1},8,["install"])}}}),[["__scopeId","data-v-a5fba457"]]);export{At as default};
