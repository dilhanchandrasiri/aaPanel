import{d as e,f as t,b as a,h as s,E as n,s as l,F as i}from"./public.js?v=1732601582185";import{_ as o}from"./index102.js?v=1732601582185";import{_ as u}from"./index.js?v=1732601582185";import{_ as d}from"./index96.js?v=1732601582185";import{_ as r}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import{_ as c}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{i as p,a8 as _,f as y,n as m,k as g,I as x,bn as h,m as f,a4 as v,_ as w,u as b}from"./page_layout.js?v=1732601582185";import{_ as k}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1732601582185";import{d as I,W as A,r as $,j as C,O as U,P as H,M as j,Y as R,R as L,c as q,Z as O,ac as P,Q as T,ak as M,V as z,w as D,F as K,X as B,L as W,ad as F,k as E,v as G,e as J}from"./vue.js?v=1732601582185";import{bG as Q,bL as V,ad as X,aa as Y,bl as Z,bh as N,aW as ee,bJ as te,bo as ae}from"./naive.js?v=1732601582185";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185";import"./index97.js?v=1732601582185";const{t:ne}=p.global,le={class:"p-20px"},ie=I({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=A(),s=[{label:a("Security.Anti.Index_28"),value:"i"},{label:a("Security.Anti.Index_29"),value:"a"}],n=e,{getList:l}=n.data,{row:i}=n.data,o=$(null),u=C({path:"",chattr:"i",d_mode:""}),d={path:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]},d_mode:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=o.value)?void 0:t.validate()),await(a={...u,s_key:i.key},_.post("/plugin?name=syssafe&action=a&s=add_safe_path",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==l||l(),e()}}),(e,t)=>{const a=S,n=Q,l=V,i=X,r=k;return U(),H("div",le,[j(r,{ref_key:"formRef",ref:o,model:L(u),rules:d},{default:R((()=>[j(n,{label:e.$t("Site.DelSite.index_2"),path:"path"},{default:R((()=>[j(a,{class:"w-280px",value:L(u).path,"onUpdate:value":t[0]||(t[0]=e=>L(u).path=e),placeholder:e.$t("Security.Anti.Index_26")},null,8,["value","placeholder"])])),_:1},8,["label"]),j(n,{label:e.$t("Security.Hardening.Index_8")},{default:R((()=>[j(l,{class:"w-280px",value:L(u).chattr,"onUpdate:value":t[1]||(t[1]=e=>L(u).chattr=e),options:s},null,8,["value"])])),_:1},8,["label"]),j(n,{label:e.$t("Security.Hardening.Index_9"),path:"d_mode"},{default:R((()=>[j(i,{class:"w-280px!",value:L(u).d_mode,"onUpdate:value":t[2]||(t[2]=e=>L(u).d_mode=e),type:"text",placeholder:e.$t("Security.Anti.Index_27")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),oe={class:"p-20px"},ue=I({__name:"index",props:{data:{}},setup(n){const{t:l}=A(),i=n,{data:o}=i,{keys:p,table:m,columns:g}=e([{key:"path",title:l("Site.DelSite.index_2")},{key:"chattr",title:l("Security.Hardening.Index_8"),render:e=>"i"==e.chattr?l("Security.Anti.Index_28"):l("Security.Anti.Index_29")},{key:"s_mode",title:l("Security.Hardening.Index_9"),render:e=>e.s_mode!==e.d_mode?"".concat(e.s_mode," >> ").concat(e.d_mode):e.d_mode},{key:"state",title:l("Config.Safe.index_156"),render:e=>j("span",{style:{color:e.state?"#20a53a":"#ff0029"}},[e.state?l("Security.Anti.Index_35"):l("Security.Anti.Index_36")])},t({width:130,title:l("Public.Table.Operation"),options:e=>[{label:l("Public.Btn.Del"),onClick:async()=>{await(e=>_.post("/plugin?name=syssafe&action=a&s=remove_safe_path",e,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}}))({s_key:o.key,path:e.path}),await v()}}]})]),x=async()=>{w.data.row=o,w.show=!0},{loading:h,setLoading:f}=a(),v=async()=>{try{f(!0);const{message:e}=await(e=>_.post("/plugin?name=syssafe&action=a&s=get_safe_config",e))({s_key:o.key});y(e)&&(m.data=e.paths)}finally{p.value=[],f(!1)}};v();const w=s(l("Security.Anti.Index_30"),{getList:v});return(e,t)=>{const a=Y,s=c,n=d,l=r,i=u;return U(),H("div",oe,[j(l,null,{toolsLeft:R((()=>[j(a,{type:"primary",onClick:x},{default:R((()=>[q(O(e.$t("Security.Anti.Index_30")),1)])),_:1})])),table:R((()=>[j(s,{"checked-row-keys":L(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>P(p)?p.value=e:null),loading:L(h),"loading-num":3,"max-height":340,data:L(m).data,columns:L(g)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:R((()=>[j(n,null,{default:R((()=>[T("li",null,O(e.$t("Security.Anti.Index_31")),1),T("li",null,O(e.$t("Security.Anti.Index_32")),1),T("li",null,O(e.$t("Security.Anti.Index_33")),1),T("li",null,O(e.$t("Security.Anti.Index_34")),1)])),_:1})])),_:1}),j(i,{show:L(w).show,"onUpdate:show":t[1]||(t[1]=e=>L(w).show=e),title:L(w).title,data:L(w).data,width:500,footer:!0,component:ie},null,8,["show","title","data"])])}}}),de={class:"p-20px"},re={class:"leading-32px"},ce=g(I({__name:"index",setup(e){const{t:t}=A(),a=$(null),s=C({cycle:120,limit_count:3,limit:3600}),n={cycle:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit_count:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]},limit:{required:!0,type:"number",message:t("Security.Conf.Index_28"),trigger:["blur","input"]}},l=async()=>{var e,t;await(null==(e=a.value)?void 0:e.validate()),await(t=M(s),_.post("/plugin?name=syssafe&action=a&s=save_ssh_config",t,{requestOptions:{loading:ne("Security.Api.Index_6"),successMessage:!0}}))};return(async()=>{const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_ssh_config");y(e)&&(s.cycle=e.cycle,s.limit=e.limit,s.limit_count=e.limit_count)})(),(e,t)=>{const i=Z,o=Q,u=Y,r=k,c=m,p=d;return U(),H("div",de,[j(r,{ref_key:"formRef",ref:a,model:L(s),rules:n,inline:"","label-width":"auto",class:"form"},{default:R((()=>[j(o,{label:e.$t("Security.Anti.Index_37"),path:"cycle"},{default:R((()=>[j(i,{"show-button":!1,value:L(s).cycle,"onUpdate:value":t[0]||(t[0]=e=>L(s).cycle=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),j(o,{label:e.$t("Security.Anti.Index_38"),path:"limit_count"},{default:R((()=>[j(i,{"show-button":!1,value:L(s).limit_count,"onUpdate:value":t[1]||(t[1]=e=>L(s).limit_count=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),j(o,{label:e.$t("Security.Anti.Index_39"),path:"limit"},{default:R((()=>[j(i,{"show-button":!1,value:L(s).limit,"onUpdate:value":t[2]||(t[2]=e=>L(s).limit=e),class:"w-100px!"},null,8,["value"])])),_:1},8,["label"]),T("span",re,O(e.$t("Security.Anti.Index_40")),1),j(u,{type:"primary",class:"ml-auto",onClick:l},{default:R((()=>[q(O(e.$t("Site.Cert.index_60")),1)])),_:1})])),_:1},8,["model"]),j(c,{class:"mb-15px!"}),j(p,null,{default:R((()=>[T("li",null,O(e.$t("Security.Anti.Index_41")),1),T("li",null,O(e.$t("Security.Anti.Index_42")),1),T("li",null,O(e.$t("Security.Anti.Index_43")),1)])),_:1})])}}}),[["__scopeId","data-v-201446e2"]]),pe={class:"p-20px"},_e=I({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=A(),s=e,{getList:n}=s.data,l=$(null),i=C({process_name:""}),o={process_name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=l.value)?void 0:t.validate()),await(a=M(i),_.post("/plugin?name=syssafe&action=a&s=add_process_white",a,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),null==n||n(),e()}}),(e,t)=>{const a=X,s=Q,n=k;return U(),H("div",pe,[j(n,{ref_key:"formRef",ref:l,model:L(i),rules:o},{default:R((()=>[j(s,{label:e.$t("Home.index_24"),path:"process_name"},{default:R((()=>[j(a,{class:"w-280px!",value:L(i).process_name,"onUpdate:value":t[0]||(t[0]=e=>L(i).process_name=e),type:"text",placeholder:e.$t("Security.Anti.Index_22")},null,8,["value","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"])])}}}),ye={class:"p-20px"},me=I({__name:"index",setup(n){const{t:l}=A(),{keys:i,table:o,columns:p}=e([{key:"name",title:l("Home.index_24")},t({width:130,title:l("Public.Table.Operation"),options:e=>[{label:l("Public.Btn.Del"),onClick:async()=>{var t;await(t={process_name:e.name},_.post("/plugin?name=syssafe&action=a&s=remove_process_white",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),await h()}}]})]),y=async()=>{f.show=!0},{loading:m,setLoading:g}=a(),h=async()=>{try{g(!0);const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_process_white");x(e)&&(o.data=e.map((e=>({name:e}))))}finally{i.value=[],g(!1)}};h();const f=s(l("Security.Anti.Index_23"),{getList:h});return(e,t)=>{const a=Y,s=c,n=d,l=r,_=u;return U(),H("div",ye,[j(l,null,{toolsLeft:R((()=>[j(a,{type:"primary",onClick:y},{default:R((()=>[q(O(e.$t("Security.Anti.Index_23")),1)])),_:1})])),table:R((()=>[j(s,{"checked-row-keys":L(i),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>P(i)?i.value=e:null),loading:L(m),"loading-num":3,"max-height":340,data:L(o).data,columns:L(p)},null,8,["checked-row-keys","loading","data","columns"])])),pageLeft:R((()=>[j(n,null,{default:R((()=>[T("li",null,O(e.$t("Security.Anti.Index_24")),1),T("li",null,O(e.$t("Security.Anti.Index_25")),1)])),_:1})])),_:1}),j(_,{show:L(f).show,"onUpdate:show":t[1]||(t[1]=e=>L(f).show=e),title:L(f).title,data:L(f).data,width:500,footer:!0,component:_e},null,8,["show","title","data"])])}}}),ge={class:"color-#ff3333"},xe=I({__name:"index",setup(l,{expose:i}){const{t:o}=A(),p=h(),{systemHardening:m}=z(p),g=s(),x=s(),v=s(),{keys:w,table:b,columns:k}=e([{key:"name",width:"10%",title:o("Site.TableRow.index_2")},{key:"ps",title:o("Security.Hardening.Index_5"),ellipsis:{tooltip:{width:"trigger"}}},n({key:"open",title:o("Site.TableRow.index_14"),onClick:async(e,t)=>{if(!m.value)return f.error(o("Security.Hardening.Index_6")),void $();var a;await(a={s_key:t.key},_.post("/plugin?name=syssafe&action=a&s=set_safe_status",a,{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}))}}),t({width:130,title:o("Site.TableRow.index_30"),options:e=>[{label:o("Site.TableOP.index_3"),onClick:()=>"ssh"===e.key?(x.title="".concat(o("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(x.show=!0)):"process"===e.key?(v.title="".concat(o("Security.Hardening.Index_7")," [").concat(e.name,"]"),void(v.show=!0)):(g.title="".concat(o("Security.Hardening.Index_7")," [").concat(e.name,"]"),g.data=e,void(g.show=!0))}]})]);D((()=>p.isRefresh),(e=>{e&&(p.setRefresh(!1),$())}));const{loading:S,setLoading:I}=a(),$=async()=>{try{I(!0);const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_safe_status");y(e)&&(m.value=e.open,b.data=e.list)}finally{w.value=[],I(!1)}};return $(),i({init:$}),(e,t)=>{const a=c,s=r,n=d,l=u;return U(),H(K,null,[j(s,{feedback:!0},{table:R((()=>[j(a,{"checked-row-keys":L(w),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>P(w)?w.value=e:null),"row-key":"title",loading:L(S),data:L(b).data,columns:L(k)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),j(n,{class:"mt-16px"},{default:R((()=>[T("li",null,O(e.$t("Security.Hardening.Index_1")),1),T("li",null,O(e.$t("Security.Hardening.Index_2")),1),T("li",null,O(e.$t("Security.Hardening.Index_3")),1),T("li",ge,O(e.$t("Security.Hardening.Index_4")),1)])),_:1}),j(l,{show:L(g).show,"onUpdate:show":t[1]||(t[1]=e=>L(g).show=e),title:L(g).title,data:L(g).data,width:700,"min-height":500,footer:!1,component:ue},null,8,["show","title","data"]),j(l,{show:L(x).show,"onUpdate:show":t[2]||(t[2]=e=>L(x).show=e),title:L(x).title,data:L(x).data,width:800,footer:!1,component:ce},null,8,["show","title","data"]),j(l,{show:L(v).show,"onUpdate:show":t[3]||(t[3]=e=>L(v).show=e),title:L(v).title,data:L(v).data,width:700,"min-height":580,footer:!1,component:me},null,8,["show","title","data"])],64)}}}),he=I({__name:"index",setup(s,{expose:n}){const{t:l}=A(),{loading:i,setLoading:o}=a(),u=$(""),p=/^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/,{keys:y,table:m,columns:g}=e([{key:"address",title:l("Security.Anti.Index_15"),width:"70%"},{key:"end",title:l("Security.History.Index_12"),render:e=>0==e.end?l("Security.Anti.Index_18"):e.end},t({width:130,title:l("Site.TableRow.index_30"),options:e=>[{label:l("Security.Anti.Index_19"),onClick:async()=>{var t;await(t={ip:e.address},_.post("/plugin?name=syssafe&action=a&s=remove_ssh_limit",t,{requestOptions:{loading:ne("Security.Api.Index_3"),successMessage:!0}})),v()}}]})]),h=async()=>{var e;p.test(u.value)?(await(e={ip:u.value},_.post("/plugin?name=syssafe&action=a&s=add_ssh_limit",e,{requestOptions:{loading:ne("Security.Api.Index_4"),successMessage:!0}})),v(),u.value=""):f.error(l("Security.Anti.Index_20"))},v=async()=>{try{o(!0);const{message:e}=await _.post("/plugin?name=syssafe&action=a&s=get_ssh_limit_info");x(e)&&(m.data=e)}finally{y.value=[],o(!1)}};return v(),n({init:v}),(e,t)=>{const a=X,s=Y,n=N,l=c,o=r,p=d;return U(),H("div",null,[j(o,null,{toolsLeft:R((()=>[j(n,{class:"flex-nowrap!"},{default:R((()=>[j(a,{value:L(u),"onUpdate:value":t[0]||(t[0]=e=>P(u)?u.value=e:null),type:"text",placeholder:e.$t("Security.Anti.Index_15"),class:"w-280px!"},null,8,["value","placeholder"]),j(s,{type:"primary",onClick:h},{default:R((()=>[q(O(e.$t("Public.Btn.Add")),1)])),_:1})])),_:1})])),table:R((()=>[j(l,{"checked-row-keys":L(y),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>P(y)?y.value=e:null),"row-key":"address",loading:L(i),"max-height":440,data:L(m).data,columns:L(g)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),j(p,{class:"mt-16px"},{default:R((()=>[T("li",null,O(e.$t("Security.Anti.Index_16")),1),T("li",null,O(e.$t("Security.Anti.Index_17")),1)])),_:1})])}}}),fe=I({__name:"index",setup(t,{expose:s}){const{t:n}=A(),{keys:l,table:i,columns:o}=e([{key:"addtime",title:n("Site.Cert.index_68"),width:"20%"},{key:"log",title:n("Security.Anti.Index_21")}]),u=C({p:1,limit:10,search:"System hardening"}),{loading:d,setLoading:p}=a(),m=async()=>{try{p(!0);const{message:t}=await(e=M(u),_.post("/data?action=getData",{...e,table:"logs",order:"id desc"}));y(t)&&(i.data=t.data,i.total=v(t.page))}finally{l.value=[],p(!1)}var e};return m(),s({init:m}),(e,t)=>{const a=c,s=se,n=r;return U(),B(n,{feedback:!0},{table:R((()=>[j(a,{"checked-row-keys":L(l),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>P(l)?l.value=e:null),"row-key":"addtime",loading:L(d),data:L(i).data,columns:L(o)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:R((()=>[j(s,{page:L(u).p,"onUpdate:page":t[1]||(t[1]=e=>L(u).p=e),"page-size":L(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>L(u).limit=e),"item-count":L(i).total,"store-key":"security-log",onRefresh:m},null,8,["page","page-size","item-count"])])),_:1})}}}),ve=I({__name:"index",setup(e){const{t:t}=A(),a=$("protection"),s=[{key:"protection",label:t("Security.Tabs.Index_8"),component:xe},{key:"block",label:t("Security.Tabs.Index_9"),component:he},{key:"operation",label:t("Security.Tabs.Index_10"),component:fe}];return(e,t)=>{const n=o;return U(),B(n,{value:L(a),"onUpdate:value":t[0]||(t[0]=e=>P(a)?a.value=e:null),options:s},null,8,["value"])}}}),we={class:"pt-40px pb-40px"},be={class:"mb-16px"},ke={class:"ul-style"},Se={class:"text-center my-24px"},Ie={class:"flex justify-center"},Ae={class:"item"},$e=["onClick"],Ce=g(I({__name:"conversion",setup(e){const t=$(0),a=["Protection","Block IP","Operation logs"],s=()=>{l({source:102})};return(e,n)=>{const l=w,i=Y,o=ee,u=te;return U(),B(u,null,{default:R((()=>[T("div",we,[n[2]||(n[2]=T("div",{class:"mb-24px text-center text-22px font-bold"}," System Hardening prevention features ",-1)),T("div",be,[T("ul",ke,[T("li",null,[j(l,{name:"security-system",size:"18"}),n[0]||(n[0]=T("span",{class:"ml-8px"},"Prevents the system from being implanted with a Trojan",-1))]),T("li",null,[j(l,{name:"security-surety",size:"30"}),n[1]||(n[1]=T("span",null,"Harden the system security configuration",-1))])])]),T("div",Se,[j(i,{type:"primary",class:"h-36px text-14px",onClick:s},{default:R((()=>[q(O(e.$t("WP.Transition.index_7")),1)])),_:1})]),T("div",Ie,[T("div",Ae,[T("ul",null,[(U(),H(K,null,W(a,((e,a)=>T("li",{class:F({active:L(t)==a}),key:a,onClick:e=>t.value=a},O(e),11,$e))),64))])]),E(j(o,{width:"100%",src:L("/static/vite/images/protection.png")},null,8,["src"]),[[G,0==L(t)]]),E(j(o,{width:"100%",src:L("/static/vite/images/block.png")},null,8,["src"]),[[G,1==L(t)]]),E(j(o,{width:"100%",src:L("/static/vite/images/log.png")},null,8,["src"]),[[G,2==L(t)]])])])])),_:1})}}}),[["__scopeId","data-v-ec798fd8"]]),Ue={key:0},He=I({__name:"index",setup(e){const t=b(),{isPro:a}=z(t),s=h(),{systemHardening:n}=z(s),l=$(n.value),o=J((()=>n.value));D(o,(e=>{l.value=e}));const u=async()=>{await _.post("/plugin?name=syssafe&action=a&s=set_open",{},{requestOptions:{loading:ne("Security.Api.Index_5"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await i("syssafe")})(),(e,t)=>{const s=ae,n=N,i=te;return L(a)?(U(),H("div",Ue,[j(i,{class:"my-15px"},{default:R((()=>[j(n,{class:"p-15px items-center"},{default:R((()=>[T("span",null,O(e.$t("Security.Anti.Index_14")),1),j(s,{value:L(l),"onUpdate:value":[t[0]||(t[0]=e=>P(l)?l.value=e:null),u],"rubber-band":!1,size:"small"},null,8,["value"])])),_:1})])),_:1}),j(i,{class:"p-15px"},{default:R((()=>[j(ve)])),_:1})])):(U(),B(Ce,{key:1}))}}});export{He as default};
