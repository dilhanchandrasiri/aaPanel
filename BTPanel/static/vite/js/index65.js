import{_ as a}from"./index144.js?v=1723125373998";import{_ as e}from"./index73.js?v=1723125373998";import{cO as t,au as n,h as s,dj as l,n as i,cH as p,ao as d,b8 as o,dk as u,j as r,p as m,B as c,a as v,k as _,dl as h,G as b,dm as x,dn as y,dp as f,dq as w,dr as g,cn as D,ds as k,cG as $,ae as j}from"./index.js?v=1723125373998";import{A as C,a as S,l as P,ad as U,r as B,S as T,Z as q,_ as E,P as L,V as N,q as H,a3 as I,W as z,a5 as A,a6 as F,f as G,b as M,F as O,af as R,d as V}from"./vue.js?v=1723125373998";import{_ as W}from"./Checkbox.js?v=1723125373998";import{u as Z}from"./useLoading.js?v=1723125373998";import{ao as J}from"./site.js?v=1723125373998";import{_ as K}from"./Select.js?v=1723125373998";import{_ as Q,a as X}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1723125373998";import{_ as Y}from"./Switch.js?v=1723125373998";import"./Tabs.js?v=1723125373998";import"./omit.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./Tag.js?v=1723125373998";import"./Empty.js?v=1723125373998";const aa=Symbol("php-admin");function ea(a,e,t,n){return new Promise((s=>{const l="".concat(a,"/index.php?lang=en"),i=document.createElement("form"),p='\n\t\t\t<input type="text" name="pma_username" id="pma_username" value="'.concat(t,'" />\n\t\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(n,'" />\n\t\t\t<input type="text" name="server" value="1" />\n\t\t\t<input type="text" name="target" value="index.php" />\n\t\t\t<input type="text" name="db" id="db" value="').concat(e,'" />\n\t\t');i.action=l,i.setAttribute("public-data",l),i.method="post",i.target="_blank",i.style.display="none",i.innerHTML=p,document.body.appendChild(i),i.submit(),document.body.removeChild(i),s(i)}))}async function ta(a,e){const{data:n}=await t.get("/phpmyadmin/index.php?lang=en"),s={session:"",token:""},l=n.match(/"set_session"\s+value="(\w+)"/),i=n.match(/"token"\s+value="(\w+)"/);l&&l.length>1&&(s.session=l[1]||""),i&&i.length>1&&(s.token=i[1]||"");const p=document.createElement("form");p.action="/phpmyadmin/index.php",p.method="post",p.target="_blank",p.style.display="none";const d='\n\t\t<input  name="set_session" id="input_session" value="'.concat(s.session,'" />\n\t\t<input type="text" name="pma_username" id="pma_username" value="').concat(a,'" size="24" />\n\t\t<input type="password" name="pma_password" id="pma_password" value="').concat(e,'" size="24" />\n\t\t<input  name="token" id="input_token" value="').concat(s.token,'" />\n\t\t<input  name="target" id="input_target" value="index.php" />\n\t\t<input  name="server" value="1" id="input_server" />\n\t');p.innerHTML=d,document.body.appendChild(p),p.submit(),document.body.removeChild(p)}const na={class:"p-4px"},sa={class:"mb-16px"},la={class:"text-error"},ia={class:"mt-20px"},pa=(a=>(A("data-v-1a5b087a"),a=a(),F(),a))((()=>E("span",{class:"bg-recommend"},null,-1))),da="phpmyadmin",oa=v(P({__name:"index",setup(a,{expose:t}){const{t:v}=U(),_=n(),{mysqlInfo:h}=S(aa),b=B(!1),x=a=>{s({title:v("Database.phpadmin.index_12",[v(a?"Public.Status.Start":"Public.Status.Stop")]),content:v("Database.phpadmin.index_13",[v(a?"Public.Status.start":"Public.Status.stop")]),onConfirm:async()=>{await l({name:da,type:a?"start":"stop"}),f()}})},y=async a=>{const e=i.loading(v("Database.phpadmin.index_14"));try{const{message:t}=await p({sName:da}),n=d(t,"ext.url",""),s=d(t,"ext.auth",!1);if("panel"==a){if(s)return i.error(v("Database.phpadmin.index_15")),void e.close();if(_.isFree)return o({source:160}),void e.close();if(h.value)await ta(h.value.username,h.value.password);else{const{message:a}=await u(),e=d(a,"result","");await ta("root",e)}}else if(h.value)await ea(n,h.value.name,h.value.username,h.value.password);else{const{message:a}=await u(),e=d(a,"result","");await ea(n,"","root",e)}e.close()}catch(t){e.close(),console.error(t)}},f=async()=>{const{message:a}=await p({sName:da});r(a)&&(b.value=a.status)};return f(),t({init:f}),(a,t)=>{const n=W,s=e,l=m,i=c;return T(),q("div",na,[E("div",sa,[L(n,{checked:z(b),"onUpdate:checked":x},{default:N((()=>[H(I(a.$t("Database.phpadmin.index_4")),1)])),_:1},8,["checked"])]),L(s,{class:"mb-20px"},{default:N((()=>[E("li",la,I(a.$t("Database.phpadmin.index_5")),1)])),_:1}),L(l,{dashed:""}),E("div",ia,[L(i,{onClick:t[0]||(t[0]=a=>y("panel"))},{default:N((()=>[E("span",null,I(a.$t("Database.phpadmin.index_11")),1),pa])),_:1}),L(i,{class:"ml-24px",onClick:t[1]||(t[1]=a=>y())},{default:N((()=>[H(I(a.$t("Database.phpadmin.index_6")),1)])),_:1})]),L(s,{class:"mt-16px"},{default:N((()=>[E("li",null,I(a.$t("Database.phpadmin.index_7")),1),E("li",null,I(a.$t("Database.phpadmin.index_8")),1),E("li",null,I(a.$t("Database.phpadmin.index_9")),1),E("li",null,I(a.$t("Database.phpadmin.index_10")),1)])),_:1})])}}}),[["__scopeId","data-v-1a5b087a"]]),ua={class:"w-160px"},ra=P({__name:"index",setup(a,{expose:e}){const{t:t}=U(),n=G({php_version:null}),s=B([]),{loading:l,setLoading:o}=Z(),u=async()=>{try{o(!0);const[a,e]=await Promise.all([J(),p({sName:"phpmyadmin"})]),{message:t}=a;_(t)&&(s.value=t.map((a=>({label:a.name,value:a.version}))));const{message:l}=e;n.php_version=d(l,"ext.phpversion",null)}finally{o(!1)}},r=async()=>{const a=n.php_version;null!==a?(await h({phpversion:a}),u()):i.error(t("Database.phpadmin.index_32"))};return u(),e({init:u}),(a,e)=>{const t=K,i=c,p=b;return T(),q("div",null,[L(p,{class:"items-center"},{default:N((()=>[E("span",null,I(a.$t("Database.phpadmin.index_31")),1),E("div",ua,[L(t,{value:z(n).php_version,"onUpdate:value":e[0]||(e[0]=a=>z(n).php_version=a),loading:z(l),options:z(s)},null,8,["value","loading","options"])]),L(i,{type:"primary",onClick:r},{default:N((()=>[H(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})])}}}),ma={class:"p-4px"},ca={class:"w-142px mr-8px"},va={class:"w-142px mr-8px"},_a={class:"w-240px"},ha={class:"w-240px"},ba={class:"w-240px"},xa=P({__name:"index",setup(a,{expose:t}){const{t:n}=U(),l=B(null),o=B(!1),u=B(null),r=B(!1);let v=!1;const _=G({username:"",password:"",repass:""}),h=async()=>{const a=l.value;null!==a?(await x({port:a}),F()):i.error(n("Database.phpadmin.index_25"))},b=async a=>{await y({v:a?1:0}),W()},C=async()=>{const a=u.value;null!==a?(await f({port:a}),W()):i.error(n("Database.phpadmin.index_26"))},S=a=>{!a&&v?s({title:n("Public.Confirm.Title"),content:n("Database.phpadmin.index_27"),onConfirm:async()=>{await w(),F()}}):r.value=a},P=async()=>{""!==_.password.trim()&&""!==_.username.trim()?_.password.length<3||_.username.length<3?i.error(n("Database.phpadmin.index_29")):_.password===_.repass?(await g({username:_.username,password:_.password}),F()):i.error(n("Database.phpadmin.index_30")):i.error(n("Database.phpadmin.index_28"))},A=B(!1),F=async()=>{try{A.value=!0;const{message:a}=await p({sName:"phpmyadmin"}),e=d(a,"ext.port",null);l.value=e?D(e):null,r.value=d(a,"ext.auth",!1),v=r.value}finally{A.value=!1}},V=B(!1),W=async()=>{try{V.value=!0;const{message:a}=await k();o.value=d(a,"status",!1);const e=d(a,"port",null);u.value=e?D(e):null}finally{V.value=!1}},Z=()=>{Promise.all([F(),W()])};return Z(),t({init:Z}),(a,t)=>{const n=$,s=c,i=Q,p=m,d=Y,v=j,x=e,y=X;return T(),q("div",ma,[L(y,{"label-width":"160"},{default:N((()=>[L(i,{label:a.$t("Database.phpadmin.index_16")},{default:N((()=>[E("div",ca,[L(n,{value:z(l),"onUpdate:value":t[0]||(t[0]=a=>M(l)?l.value=a:null),min:0,max:66325,"show-button":!1,loading:z(A),placeholder:""},null,8,["value","loading"])]),L(s,{type:"primary",onClick:h},{default:N((()=>[H(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),L(p,{dashed:""}),L(i,{class:"mt-20px",label:a.$t("Database.phpadmin.index_17")},{default:N((()=>[L(d,{value:z(o),loading:z(V),"onUpdate:value":b},null,8,["value","loading"])])),_:1},8,["label"]),L(i,{label:a.$t("Database.phpadmin.index_18")},{default:N((()=>[E("div",va,[L(n,{value:z(u),"onUpdate:value":t[1]||(t[1]=a=>M(u)?u.value=a:null),min:0,max:66325,"show-button":!1,loading:z(V),placeholder:""},null,8,["value","loading"])]),L(s,{type:"primary",onClick:C},{default:N((()=>[H(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1},8,["label"]),L(p,{dashed:""}),L(i,{class:"mt-20px",label:a.$t("Database.phpadmin.index_19")},{default:N((()=>[L(d,{value:z(r),loading:z(A),"onUpdate:value":S},null,8,["value","loading"])])),_:1},8,["label"]),z(r)?(T(),q(O,{key:0},[L(i,{label:a.$t("Database.phpadmin.index_20")},{default:N((()=>[E("div",_a,[L(v,{value:z(_).username,"onUpdate:value":t[2]||(t[2]=a=>z(_).username=a),placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),L(i,{label:a.$t("Database.phpadmin.index_21")},{default:N((()=>[E("div",ha,[L(v,{value:z(_).password,"onUpdate:value":t[3]||(t[3]=a=>z(_).password=a),type:"password",placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),L(i,{label:a.$t("Database.phpadmin.index_22")},{default:N((()=>[E("div",ba,[L(v,{value:z(_).repass,"onUpdate:value":t[4]||(t[4]=a=>z(_).repass=a),type:"password",placeholder:a.$t("Database.phpadmin.index_23")},null,8,["value","placeholder"])])])),_:1},8,["label"]),L(i,{label:" "},{default:N((()=>[L(s,{type:"primary",onClick:P},{default:N((()=>[H(I(a.$t("Public.Btn.Save")),1)])),_:1})])),_:1})],64)):R("",!0),L(x,null,{default:N((()=>[E("li",null,I(a.$t("Database.phpadmin.index_24")),1)])),_:1})])),_:1})])}}}),ya={class:"h-580px"},fa=P({__name:"index",props:{row:{default:void 0}},setup(e){const t=V(e,"row"),{t:n}=U(),s=B("service"),l=[{key:"service",label:n("Database.phpadmin.index_1"),component:oa},{key:"php",label:n("Database.phpadmin.index_2"),component:ra},{key:"safe",label:n("Database.phpadmin.index_3"),component:xa}];return C(aa,{mysqlInfo:t}),(e,t)=>{const n=a;return T(),q("div",ya,[L(n,{value:z(s),"onUpdate:value":t[0]||(t[0]=a=>M(s)?s.value=a:null),ref:"tabsRef",data:l},null,8,["value"])])}}});export{fa as default};
