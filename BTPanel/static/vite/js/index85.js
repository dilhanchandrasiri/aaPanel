import{_ as e}from"./useTableData.js?v=1723125373998";import{u as t,N as a,dK as s,L as i,j as o,dL as l,k as n,dM as r}from"./index.js?v=1723125373998";import{c as d}from"./file2.js?v=1723125373998";import{u as m}from"./useLoading.js?v=1723125373998";import{a as p,_ as c}from"./index.vue_vue_type_script_setup_true_lang14.js?v=1723125373998";import{l as u,r as b,P as y,q as g,S as h,Z as f,V as v,W as j,_ as x,af as w}from"./vue.js?v=1723125373998";import{_}from"./Alert.js?v=1723125373998";import"./data.js?v=1723125373998";import"./Skeleton.js?v=1723125373998";import"./DataTable.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./Select.js?v=1723125373998";import"./Tag.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./omit.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./Progress.js?v=1723125373998";const D={class:"px-20px py-24px"},k=x("span",{class:"font-bold"},"Warning: ",-1),L=x("span",null," After deleting the database, all data in the database will be cleared and cannot be recovered. ",-1),T={class:"mt-16px text-error"},C=x("p",null,"Please read the above information carefully to prevent accidental deletion.",-1),P={key:0,class:"mt-4px"},S=u({__name:"index",props:{data:{}},emits:["close"],setup(u,{expose:S,emit:R}){const A=u,{ids:B}=A.data,E=R,M=t(),W=b(!0),q=b([]),z=e=>{let t="--";for(let a=0;a<M.remoteList.length;a++){const s=M.remoteList[a];if(s.id===e){t=s.ps||s.db_host;break}}return t},F=b([{key:"name",title:"Database name",ellipsis:{tooltip:{width:"trigger"}}},{key:"total",title:"Size",width:120,render:e=>a(e.total)},{key:"position",title:"Location"},{key:"addtime",title:"Creation time",width:160,render:e=>e.addtime},{key:"result",title:"Delete results",align:"right",width:140,render:e=>e.position!==M.remoteList[0].ps?y("div",{class:"text-error"},[g("Delete Permanently")]):y("div",{class:W.value?"":"text-error"},[W.value?"Move to recycle bin":"Delete Permanently"])}]),{loading:G,setLoading:K}=m(),N=async e=>await r(M.type,{name:e.name,id:e.id}),V=()=>{i({title:"Delete database",hideClose:!0,data:{title:"Delete database",api:N,data:q.value,callback:Z},component:p})},Z=e=>{E("close"),M.setRefresh(!0),i({title:"Batch delete database results",width:440,footer:!0,component:c,data:{title:"Delete database",data:e,status:"done",columns:[{key:"name",title:"Database name",ellipsis:{tooltip:{width:"trigger"}}}]}})};return(async()=>{await(async()=>{const{message:e}=await d();o(e)&&(W.value=e.status_db)})(),(async()=>{try{K(!0);const{message:e}=await l({ids:B});o(e)?q.value=n(e.data)?e.data.map((e=>({...e,position:z(e.sid)}))):[]:q.value=[]}finally{K(!1)}})()})(),S({onConfirm:()=>{s({text:"Delete database",title:"Two-step verification - delete database",content:W.value?"The deleted database will be moved to the Recycle Bin. Do you want to continue?":"The data will be completely deleted and cannot be recovered. Do you want to continue?",onConfirm:async({hide:e})=>{V(),e()}})}}),(t,a)=>{const s=_,i=e;return h(),f("div",D,[y(s,{type:"warning"},{default:v((()=>[k,L])),_:1}),y(i,{class:"mt-16px",loading:j(G),"loading-num":j(B).length,"max-height":300,data:j(q),columns:j(F)},null,8,["loading","loading-num","data","columns"]),x("div",T,[C,j(W)?w("",!0):(h(),f("p",P," The database recycle bin is not enabled, please operate with caution! Go to enable --\x3e File management --\x3e Recycle bin "))])])}}});export{S as default};
