System.register(["./index-legacy.js?v=1723125373998","./index-legacy70.js?v=1723125373998","./pinia-legacy.js?v=1723125373998","./mail-legacy.js?v=1723125373998","./vue-legacy.js?v=1723125373998","./DataTable-legacy.js?v=1723125373998","./InputGroupLabel-legacy.js?v=1723125373998","./InputGroup-legacy.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1723125373998","./useLoading-legacy.js?v=1723125373998","./site-legacy.js?v=1723125373998","./Select-legacy.js?v=1723125373998","./Checkbox-legacy.js?v=1723125373998","./Switch-legacy.js?v=1723125373998","./useTableData-legacy.js?v=1723125373998","./useTableColumns-legacy.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy12.js?v=1723125373998","./Ellipsis-legacy.js?v=1723125373998","./Empty-legacy.js?v=1723125373998","./omit-legacy.js?v=1723125373998","./Tag-legacy.js?v=1723125373998","./data-legacy.js?v=1723125373998","./Skeleton-legacy.js?v=1723125373998","./Progress-legacy.js?v=1723125373998","./file-legacy2.js?v=1723125373998","./Spin-legacy.js?v=1723125373998"],(function(e,t){"use strict";var a,s,l,n,i,o,u,r,c,d,p,m,v,y,f,g,h,_,x,w,b,k,C,P,S,j,$,R,U,I,M,L,A,B,T,z,D,E,W,N,G,H,V,O,q,F,J,K,Q,Z,X,Y,ee,te,ae,se,le,ne,ie,oe,ue,re,ce,de,pe,me,ve,ye,fe,ge,he,_e,xe,we,be,ke,Ce,Pe;return{setters:[e=>{a=e.n,s=e.cH,l=e.j,n=e.h,i=e.cI,o=e.am,u=e.a,r=e.cJ,c=e.cG,d=e.B,p=e.ae,m=e.k,v=e.g,y=e.e,f=e._,g=e.bt,h=e.G,_=e.q,x=e.au,w=e.L,b=e.cK,k=e.r,C=e.v},e=>{P=e._},e=>{S=e.s},e=>{j=e.H,$=e.I,R=e.J,U=e.K,I=e.L,M=e.h,L=e.M,A=e.N,B=e.O,T=e.P,z=e.Q,D=e.R,E=e.S,W=e.T,N=e.U},e=>{G=e.l,H=e.S,V=e.Z,O=e._,q=e.a3,F=e.D,J=e.r,K=e.U,Q=e.V,Z=e.P,X=e.q,Y=e.W,ee=e.b,te=e.f,ae=e.k,se=e.aj,le=e.af,ne=e.F,ie=e.ad,oe=e.a1,ue=e.a5,re=e.a6},e=>{ce=e.a,de=e.b},e=>{pe=e._},e=>{me=e._},e=>{ve=e._,ye=e.a},e=>{fe=e.u},e=>{ge=e.g},e=>{he=e._},e=>{_e=e._},e=>{xe=e._},e=>{we=e.u,be=e._},e=>{ke=e.g,Ce=e.b},e=>{Pe=e._},null,null,null,null,null,null,null,null,null],execute:function(){var Se=document.createElement("style");Se.textContent=".setting-card[data-v-61fff8e2]{padding:12px}.setting-card .setting-title[data-v-61fff8e2]{margin-bottom:12px;font-size:15px;--un-text-opacity:1;color:rgb(102 102 102 / var(--un-text-opacity));font-weight:700;line-height:28px}.setting-title[data-v-36ee251b]{font-size:18px;margin-bottom:12px}\n",document.head.appendChild(Se);const je={class:"setting-card"},$e={class:"setting-title"},Re=u(G({__name:"index",props:{title:{default:""}},setup:e=>(e,t)=>(H(),V("div",je,[O("div",$e,q(e.title),1),F(e.$slots,"default",{},void 0,!0)]))}),[["__scopeId","data-v-61fff8e2"]]),Ue={class:"flex items-center"},Ie=G({__name:"index",setup(e){const t=r(),s=J(0),n=J(null),i=async()=>{n.value||0===n.value?(await j({save_day:0===s.value?0:n.value}),o()):a.error("Please enter the save time")},o=async()=>{const{message:e}=await $();l(e)&&(0===e.result?(s.value=0,n.value=null):(s.value=1,n.value=e.result))};return t.setup&&o(),(e,t)=>{const a=ce,l=de,o=c,u=pe,r=me,p=d;return H(),K(Re,{title:"Mail save time"},{default:Q((()=>[O("div",Ue,[Z(l,{value:Y(s),"onUpdate:value":t[0]||(t[0]=e=>ee(s)?s.value=e:null)},{default:Q((()=>[Z(a,{value:0},{default:Q((()=>[X("Always keep")])),_:1}),Z(a,{class:"ml-24px",value:1},{default:Q((()=>[X("Customize")])),_:1})])),_:1},8,["value"]),Z(r,{class:"w-240px"},{default:Q((()=>[Z(o,{value:Y(n),"onUpdate:value":t[1]||(t[1]=e=>ee(n)?n.value=e:null),class:"flex-1 ml-16px",min:0,disabled:0===Y(s),"show-button":!1,placeholder:"Please enter the save time"},null,8,["value","disabled"]),Z(u,null,{default:Q((()=>[X("Days")])),_:1})])),_:1}),Z(p,{class:"ml-24px",type:"primary",ghost:"",onClick:i},{default:Q((()=>[X(q(e.$t("Public.Btn.Save")),1)])),_:1})])])),_:1})}}}),Me={class:"p-20px pt-24px pb-8px"},Le={class:"w-280px"},Ae={class:"w-280px"},Be=G({__name:"install",emits:["refresh"],setup(e,{expose:t,emit:a}){const s=a,n=J(null),i=te({domain:"",php_version:null}),o={domain:{trigger:"change",validator:()=>""!==i.domain.trim()||new Error("Please input domain")},php_version:{trigger:"change",validator:()=>null!==i.php_version||new Error("Please select PHP version")}},u=J([]),r=async()=>{const{message:e}=await ge();l(e)&&(u.value=e.versions.reverse().map((e=>({label:e.name,value:e.version}))),i.php_version=e.versions[0].version)},{loading:c,setLoading:d}=fe();return(async()=>{try{d(!0),await Promise.all([r()])}finally{d(!1)}})(),t({onConfirm:async()=>{await(n.value?.validate()),await R({site_name:i.domain||"",php_version:i.php_version||""}),s("refresh")}}),(e,t)=>{const a=p,s=ve,l=he,r=ye;return H(),V("div",Me,[Z(r,{ref_key:"formRef",ref:n,model:Y(i),rules:o},{default:Q((()=>[Z(s,{label:"Domain",path:"domain"},{default:Q((()=>[O("div",Le,[Z(a,{value:Y(i).domain,"onUpdate:value":t[0]||(t[0]=e=>Y(i).domain=e)},null,8,["value"])])])),_:1}),Z(s,{label:"PHP Version",path:"php_version"},{default:Q((()=>[O("div",Ae,[Z(l,{value:Y(i).php_version,"onUpdate:value":t[1]||(t[1]=e=>Y(i).php_version=e),loading:Y(c),options:Y(u)},null,8,["value","loading","options"])])])),_:1})])),_:1},8,["model"])])}}}),Te={class:"p-20px pt-24px pb-8px"},ze={class:"w-280px"},De=G({__name:"config",emits:["refresh"],setup(e,{expose:t,emit:a}){const s=a,n=J(null),i=te({id:0,domain:null,path:""}),o={domain:{trigger:"change",validator:()=>null!==i.domain||new Error("Please select site")}},u=J([]),r=async()=>{const{message:e}=await I();m(e)&&(u.value=e.map((e=>({label:e.name,value:e.name,data:e}))),e.length&&(i.domain=e[0].name,i.path=e[0].path,i.id=e[0].id))},c=(e,t)=>{const{data:a}=t;l(a)&&(i.id=a.id,i.path=a.path)},{loading:d,setLoading:p}=fe();return(async()=>{try{p(!0),await Promise.all([r()])}finally{p(!1)}})(),t({onConfirm:async()=>{await(n.value?.validate()),await U({id:i.id,site_name:i.domain||"",path:i.path}),s("refresh")}}),(e,t)=>{const a=he,s=ve,l=ye;return H(),V("div",Te,[Z(l,{ref_key:"formRef",ref:n,model:Y(i),rules:o},{default:Q((()=>[Z(s,{label:"Site",path:"domain"},{default:Q((()=>[O("div",ze,[Z(a,{value:Y(i).domain,"onUpdate:value":[t[0]||(t[0]=e=>Y(i).domain=e),c],loading:Y(d),options:Y(u)},null,8,["value","loading","options"])])])),_:1})])),_:1},8,["model"])])}}}),Ee={class:"flex items-center mr-32px text-13px"},We=O("span",{class:"mr-10px"},"Install status:",-1),Ne={key:0,class:"mr-32px text-13px"},Ge=O("span",{class:"mr-10px"},"URL:",-1),He=O("span",null,"Add deployed WebMail",-1),Ve=G({__name:"index",setup(e){const t=te({id:0,site_name:"",status:!1,ssl_status:!1}),a=ae((()=>`${t.ssl_status?"https":"http"}://${t.site_name}`)),s=async()=>{const{message:e}=await M();l(e)&&(t.id=e.id,t.status=e.status,t.site_name=e.site_name,t.ssl_status=e.ssl_status)},i=v("Install Web Mail",{onRefresh:s}),o=()=>{i.show=!0},u=()=>{const e=J(!1);n({title:"Uninstall Web Mail",width:420,content:()=>Z(ne,null,[Z("div",{class:"mb-16px"},[X("After uninstall WebMail, ["),t.site_name,X("] is deleted from the website list and cannot be accessed, Continue?")]),Z(_e,{checked:e.value,onUpdateChecked:t=>{e.value=t}},{default:()=>[Z("div",{class:"text-desc leading-[1.4]"},[X("FTP, Database, Document Root will be completely deleted after selection, Please be careful!")])]})]),onConfirm:async()=>{await L({id:t.id,site_name:t.site_name,force:e.value?1:0}),s()}})},r=v("Add deployed WebMail",{onRefresh:s}),c=()=>{r.show=!0};return s(),(e,s)=>{const l=y,n=d,p=f,m=g,v=h,x=_;return H(),K(Re,{title:"WebMail"},{default:Q((()=>[Z(v,{class:"items-center",size:0},{default:Q((()=>[O("div",Ee,[We,O("span",{class:se(Y(t).status?"text-primary":"text-error")},q(Y(t).status?"Install":"Not install"),3)]),Y(t).status?(H(),V("div",Ne,[Ge,Z(l,{href:Y(a),target:"_blank"},{default:Q((()=>[X(q(Y(a)),1)])),_:1},8,["href"])])):le("",!0),Y(t).status?(H(),K(n,{key:1,onClick:u},{default:Q((()=>[X(q(e.$t("Public.Btn.Uninstall")),1)])),_:1})):(H(),V(ne,{key:2},[Z(n,{type:"primary",ghost:"",onClick:o},{default:Q((()=>[X(q(e.$t("Public.Btn.Install")),1)])),_:1}),Z(n,{class:"ml-10px",onClick:c},{default:Q((()=>[He])),_:1}),Z(m,null,{trigger:Q((()=>[Z(p,{class:"ml-6px",name:"common-ask",size:"16"})])),default:Q((()=>[X(" If you have used Roundcube WebMail installed with one-click deployment, you can add it here ")])),_:1})],64))])),_:1}),Z(x,{show:Y(i).show,"onUpdate:show":s[0]||(s[0]=e=>Y(i).show=e),title:Y(i).title,data:Y(i).data,width:480,footer:!0,"confirm-text":e.$t("Public.Btn.Install"),component:Be},null,8,["show","title","data","confirm-text"]),Z(x,{show:Y(r).show,"onUpdate:show":s[1]||(s[1]=e=>Y(r).show=e),title:Y(r).title,data:Y(r).data,width:480,footer:!0,component:De},null,8,["show","title","data"])])),_:1})}}}),Oe=O("div",{class:"text-13px"},"Automatically start services",-1),qe=G({__name:"index",setup(e){const t=r(),a=J(!1),s=async e=>{e?n({title:"Enable Service Status Monitoring",width:380,content:"Checks the status of the post office service and restarts it automatically if it is stopped",onConfirm:async()=>{await A()},onPublicClose:()=>{a.value=!e}}):await B()},{loading:l,setLoading:i}=fe();return t.setup&&(async()=>{try{i(!0),await T(),a.value=!0}catch(e){a.value=!1}finally{i(!1)}})(),(e,t)=>{const n=xe,i=h;return H(),K(Re,{title:"Monitoring"},{default:Q((()=>[Z(i,{class:"items-center",size:24},{default:Q((()=>[Oe,Z(n,{value:Y(a),"onUpdate:value":[t[0]||(t[0]=e=>ee(a)?a.value=e:null),s],loading:Y(l)},null,8,["value","loading"])])),_:1})])),_:1})}}}),Fe={class:"p-16px"},Je=G({__name:"config",props:{row:{}},setup(e,{expose:t}){const a=e,{row:s}=a,n=J(""),i=J("utf-8"),{loading:o,setLoading:u}=fe();return(async()=>{try{u(!0);const{message:e}=await z({service:s.key});l(e)&&(n.value=e.data,i.value=e.encoding)}finally{u(!1)}})(),t({onConfirm:async()=>{await D({service:s.key,data:n.value})}}),(e,t)=>(H(),V("div",Fe,[Z(Pe,{value:Y(n),"onUpdate:value":t[0]||(t[0]=e=>ee(n)?n.value=e:null),encoding:Y(i),"onUpdate:encoding":t[1]||(t[1]=e=>ee(i)?i.value=e:null),height:550,load:Y(o),"show-encoding":!0},null,8,["value","encoding","load"])]))}}),Ke=G({__name:"index",setup(e){const t=r(),{t:a}=ie(),{table:s,columns:i}=we([{key:"name",title:"Service Name"},{key:"status",title:"Service Status",render:e=>Z(ke,{value:e.status,checkedValue:!0,onClick:()=>{o(e)}},null)},Ce({width:200,options:e=>[{label:e.status?a("Public.Status.Stop"):a("Public.Status.Start"),onClick:()=>{o(e)}},{label:a("Public.Status.Restart"),onClick:()=>{u(e)}},{label:a("Public.Btn.Repair"),onClick:()=>{c(e)}},{label:a("Public.Btn.Config"),onClick:()=>{p(e)}}]})]),o=e=>{n({title:e.status?`Stopping ${e.key} Service`:`Start ${e.key} Service`,content:e.status?`Are you sure to Stop ${e.key} service?`:`Are you sure to start ${e.key} service?`,onConfirm:async()=>{await E({service:e.key,type:e.status?"stop":"start"}),f()}})},u=e=>{n({title:`Restart ${e.key} service`,content:`Are you sure to restart ${e.key} service?`,onConfirm:async()=>{await E({service:e.key,type:"restart"}),f()}})},c=e=>{let t=`Are you sure to repair ${e.key} service?`;"dovecot"===e.key?t="Config will be restored to default, and invalidate these configuration: SSL. Confirm to continue?":"postfix"===e.key&&(t="Config will be restored to default, and invalidate these configuration: SSL, Anti spam, BCC, SMTP Relay, mail forward. Confirm to continue?"),n({title:`Repair ${e.key} service`,content:t,onConfirm:async()=>{await W({service:e.key,type:"repair"}),f()}})},d=v(),p=e=>{d.data.row=e,d.title=`Online Edit [${e.key}_config_file]`,d.show=!0},{loading:m,setLoading:y}=fe(),f=async()=>{try{y(!0);const{message:e}=await N();l(e)&&(s.data=[],s.data.push({key:"dovecot",name:"Dovecot",status:e.dovecot}),e.change_rspamd?s.data.push({key:"opendkim",name:"Opendkim",status:e.opendkim}):s.data.push({key:"rspamd",name:"Rspamd",status:e.rspamd}),s.data.push({key:"postfix",name:"Postfix",status:e.postfix}))}finally{y(!1)}};return t.setup&&f(),(e,t)=>{const a=be,l=_;return H(),K(Re,{title:"Service Status"},{default:Q((()=>[Z(a,{loading:Y(m),"loading-num":3,data:Y(s).data,columns:Y(i)},null,8,["loading","data","columns"]),Z(l,{show:Y(d).show,"onUpdate:show":t[0]||(t[0]=e=>Y(d).show=e),title:Y(d).title,data:Y(d).data,width:800,height:624,footer:!0,"confirm-text":e.$t("Public.Btn.Save"),component:Je},null,8,["show","title","data","confirm-text"])])),_:1})}}}),Qe=(e=>(ue("data-v-36ee251b"),e=e(),re(),e))((()=>O("span",{class:"mr-8px"}," This function can only be used after logging in to the aaPanel account ",-1))),Ze={class:"mr-8px"};e("default",u(G({__name:"index",setup(e){const u=r(),{setup:c,install:p,update:m,version:v,lastVersion:y}=S(u),f=x(),{userInfo:g}=S(f),h=()=>{p.value&&!m.value?w({title:"Restoring the mail server environment",width:560,height:550,component:oe((()=>C((()=>t.import("./index-legacy134.js?v=1723125373998")),void 0)))}):(async e=>{const{close:t}=a.loading("Processing, please wait...");try{const{message:t}=await s({sName:e});if(l(t)){const e=t.versions[0].full_version;n({title:"Install plugin",content:`Are you sure to install [${t.title} v${e}] plugin?`,onConfirm:async()=>{t.status?await i({sName:t.name,version:e,upgrade:e}):await i({sName:t.name,version:e}),o()}})}}finally{t()}})("mail_sys")},_=()=>{b()};return(e,t)=>{const a=d,s=k,l=P;return H(),K(l,{install:Y(c)},{desc:Q((()=>[Y(g).status?(H(),V(ne,{key:1},[O("span",Ze,q(Y(p)?Y(m)?`The mail server is v${Y(v)}, please upgrade to the version above v${Y(y)} to use`:"Restoring the mail server environment":"Mail server not installed"),1),Z(a,{class:"px-8px h-24px",type:"primary",size:"small",onClick:h},{default:Q((()=>[X(q(e.$t("Public.Btn.Install")),1)])),_:1})],64)):(H(),V(ne,{key:0},[Qe,Z(a,{class:"px-8px h-24px",type:"primary",size:"small",onClick:_},{default:Q((()=>[X(" Register for free now ")])),_:1})],64))])),default:Q((()=>[Z(s,{class:"p-16px"},{default:Q((()=>[Z(Ve),Z(Ie),Z(qe),Z(Ke)])),_:1})])),_:1},8,["install"])}}}),[["__scopeId","data-v-36ee251b"]]))}}}));
