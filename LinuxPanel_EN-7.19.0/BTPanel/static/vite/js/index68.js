const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/clear.js?v=1732601582185","js/index.vue_vue_type_script_setup_true_lang.js?v=1732601582185","js/naive.js?v=1732601582185","js/vue.js?v=1732601582185","js/__commonjsHelpers__.js?v=1732601582185","js/common.js?v=1732601582185","js/page_layout.js?v=1732601582185","js/public.js?v=1732601582185","css/public.css?v=1732601582185","css/page_layout.css?v=1732601582185","js/tools.js?v=1732601582185","js/rules.js?v=1732601582185","js/config4.js?v=1732601582185","css/config3.css?v=1732601582185"])))=>i.map(i=>d[i]);
import{_ as e}from"./index102.js?v=1732601582185";import{a7 as t,o as a,bk as l,k as i,S as o,bB as n,f as d,c as s,bm as c,m as r}from"./page_layout.js?v=1732601582185";import{_ as u}from"./index.js?v=1732601582185";import{_}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";import{_ as k}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{_ as f}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1732601582185";import{h as y,d as m,f as x,a as W}from"./public.js?v=1732601582185";import{a as h,b as B,s as v,g as w,u as b,c as g,r as C,d as q,e as j,f as $}from"./tools.js?v=1732601582185";import{d as S,ap as U,W as M,r as P,aq as R,y as D,O as z,P as L,M as E,Y as A,F as O,L as I,c as T,Z as Q,R as V,ac as Y,e as F,Q as H,j as J,a6 as N,X}from"./vue.js?v=1732601582185";import{bP as Z,bQ as G,aa as K,bJ as ee}from"./naive.js?v=1732601582185";import{j as te}from"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185";import"./rules.js?v=1732601582185";const ae={class:"flex"},le=i(S({__name:"query-date",props:{value:{default:()=>"all"},valueModifiers:{}},emits:U(["search"],["update:value"]),setup(e,{emit:i}){const o=i,{t:n}=M(),d=P("all"),s=P(null),c=R(e,"value"),r=[{label:n("Public.All"),value:"all"},{label:n("Public.Search.Today"),value:"today"},{label:n("Public.Search.Yesterday"),value:"yesterday"}],u=e=>{s.value=null,c.value=e,o("search")},_=e=>{d.value=e?"":"all",c.value=t(e)?e:"all",o("search")};return D((()=>{t(c.value)?(d.value="",s.value=c.value):a(c.value)&&(d.value=c.value||"",s.value=null)})),(e,t)=>{const a=Z,i=G,o=l;return z(),L("div",ae,[E(i,{value:V(d),"onUpdate:value":[t[0]||(t[0]=e=>Y(d)?d.value=e:null),u],class:"bt-radio"},{default:A((()=>[(z(),L(O,null,I(r,(e=>E(a,{key:e.value,value:e.value},{default:A((()=>[T(Q(e.label),1)])),_:2},1032,["value"]))),64))])),_:1},8,["value"]),E(o,{value:V(s),"onUpdate:value":[t[1]||(t[1]=e=>Y(s)?s.value=e:null),_],type:"date",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-bf5d25af"]]),ie={class:"mt-4px mb-20px text-center"},oe={class:"text-18px"},ne={class:"mt-4px text-desc text-13px"},de=S({__name:"query-total",props:{total:{default:0},date:{default:"all"},isRule:{type:Boolean,default:!1}},setup(e){const t=e,{t:a}=M(),l=F((()=>{const{date:e}=t;return"all"===e?a("Public.All"):i("today"===e?new Date:"yesterday"===e?te(new Date,-1):new Date(e))})),i=e=>"".concat(o(e,"yyyy-MM-dd")," 00:00:00-23:59:59");return(e,t)=>(z(),L("div",ie,[H("div",oe,Q(e.$t("Waf.Block.index_4",[e.total])),1),H("div",ne,[e.isRule?(z(),L(O,{key:1},[T(Q(e.$t("Waf.Block.index_6")),1)],64)):(z(),L(O,{key:0},[T(Q(e.$t("Waf.Block.index_5",[V(l)])),1)],64))])]))}}),se=S({__name:"index",setup(e){const a=N((()=>s((()=>import("./clear.js?v=1732601582185")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])))),{t:l}=M(),i=()=>{const e=c();window.open("".concat(e,"/btwaf/export_logs.json?siteName=all"))},r=y(l("Waf.Block.index_10")),W=()=>{r.show=!0},{table:b,columns:g,setLoading:C}=m([{key:"time_localtime",title:l("Waf.Block.index_12"),minWidth:150,width:"12%",render:e=>o(e.time_localtime)},{key:"ip",title:l("Waf.Block.index_13"),minWidth:120,width:"10%",ellipsis:{tooltip:!0}},{key:"server_name",title:l("Waf.Block.index_14"),minWidth:120,width:"12%",ellipsis:{tooltip:!0}},{key:"type",title:l("Waf.Block.index_15"),minWidth:60,width:"6%",ellipsis:{tooltip:!0}},{key:"uri",title:l("Waf.Block.index_16"),minWidth:140,ellipsis:{tooltip:{contentStyle:{maxWidth:"500px"}}},render:e=>n(e.uri)},{key:"status",title:l("Waf.Block.index_17"),minWidth:60,width:"6%",render:()=>l("Waf.Block.index_18")},{key:"ip_country",title:l("Waf.Block.index_19"),minWidth:140,width:"14%",render:e=>e.ip_country===l("Waf.Block.index_20")?e.ip_country:(e=>e.ip_country)(e)},{key:"filter_rule",title:l("Waf.Block.index_21"),minWidth:120,width:"10%",ellipsis:{tooltip:!0}},x({width:200,options:e=>[{label:l("Waf.Block.index_22"),onClick:()=>{h(e)}},{label:l("Waf.Block.index_23"),onClick:()=>{B(e,-1!==e.uri.indexOf("?")&&-1!==e.uri.indexOf("="))}},{label:l("Waf.Block.index_24"),onClick:()=>{v(e)}}]})]),q=J({p:1,limit:10,keyword:"",query_data:"all"}),j=()=>{const e=(()=>{if(t(q.query_data))return o(new Date(q.query_data),"yyyy-MM-dd");if("today"===q.query_data)return o(new Date,"yyyy-MM-dd");if("yesterday"===q.query_data){const e=te(new Date,-1);return o(e,"yyyy-MM-dd")}return""})();return{p:q.p,limit:q.limit,...e?{query_data:e}:{},...q.keyword?{keyword:q.keyword}:{}}},$=async()=>{try{C(!0);const e=j(),{message:t}=await w(e);d(t)&&(b.data=t.data,b.total=t.total)}finally{C(!1)}},S=()=>{q.p=1,$()};return $(),(e,t)=>{const l=f,o=K,n=k,d=p,s=_,c=u;return z(),L("div",null,[E(s,null,{toolsLeft:A((()=>[E(l,{value:V(q).keyword,"onUpdate:value":t[0]||(t[0]=e=>V(q).keyword=e),width:"300",placeholder:e.$t("Waf.Block.index_8"),onSearch:S},null,8,["value","placeholder"]),E(o,{type:"primary",onClick:S},{default:A((()=>[T(Q(e.$t("Public.Btn.Search")),1)])),_:1}),E(o,{onClick:i},{default:A((()=>[T(Q(e.$t("Public.Btn.Export")),1)])),_:1}),E(o,{onClick:W},{default:A((()=>[T(Q(e.$t("Waf.Block.index_9")),1)])),_:1})])),toolsRight:A((()=>[E(le,{value:V(q).query_data,"onUpdate:value":t[1]||(t[1]=e=>V(q).query_data=e),onSearch:S},null,8,["value"])])),table:A((()=>[E(de,{total:V(b).total,date:V(q).query_data},null,8,["total","date"]),E(n,{loading:V(b).loading,data:V(b).data,columns:V(g)},null,8,["loading","data","columns"])])),pageRight:A((()=>[E(d,{page:V(q).p,"onUpdate:page":t[2]||(t[2]=e=>V(q).p=e),"page-size":V(q).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>V(q).limit=e),"item-count":V(b).total,"store-key":"waf-block-record",onRefresh:$},null,8,["page","page-size","item-count"])])),_:1}),E(c,{show:V(r).show,"onUpdate:show":t[4]||(t[4]=e=>V(r).show=e),title:V(r).title,width:460,"min-height":96,footer:!0,component:V(a)},null,8,["show","title","component"])])}}}),ce={class:"mb-10px"},re=S({__name:"index",setup(e){const{t:a}=M(),l=()=>{const e=c();window.open("".concat(e,"/btwaf/index?export=export"))},i=()=>{W({title:a("Waf.Block.index_31"),content:a("Waf.Block.index_32"),onConfirm:async()=>{await C({safe_logs:1,site_all:0,site_logs:[]}),P()}})},s=()=>{W({title:a("Waf.Block.index_33"),content:a("Waf.Block.index_34"),onConfirm:async()=>{await q(),P()}})},{table:u,columns:y,setLoading:w}=m([{key:"time",title:a("Waf.Block.index_12"),minWidth:150,width:"12%",render:e=>o(e.time)},{key:"ip",title:a("Waf.Block.index_13"),minWidth:120,width:"10%",ellipsis:{tooltip:!0},render:e=>n(e.ip)},{key:"server_name",title:a("Waf.Block.index_25"),minWidth:120,width:"12%",ellipsis:{tooltip:!0}},{key:"uri",title:a("Waf.Block.index_16"),minWidth:140,ellipsis:{tooltip:{contentStyle:{maxWidth:"500px"}}},render:e=>n(e.uri)},{key:"blockade",title:a("Waf.Block.index_35"),minWidth:120,width:"10%",render:e=>"cc"==e.blockade&&e.incoming_value===a("Waf.Block.index_36")?a("Waf.Block.index_37"):"cc"==e.blockade&&e.incoming_value.startsWith(a("Waf.Block.index_38"))?a("Waf.Block.index_38"):"cc"==e.blockade&&e.incoming_value.startsWith(a("Waf.Block.index_39"))?a("Waf.Block.index_39"):"php"==e.blockade&&e.filter_rule.startsWith(a("Waf.Block.index_40"))?a("Waf.Block.index_40"):"upload"===e.blockade?a("Waf.Block.index_41"):"xss"===e.blockade?a("Waf.Block.index_42"):"sql"===e.blockade?a("Waf.Block.index_43"):"scan"===e.blockade?a("Waf.Block.index_44"):"user_agent"===e.blockade?a("Waf.Block.index_45"):"inc"===e.blockade&&e.incoming_value.startsWith(a("Waf.Block.index_46"))?a("Waf.Block.index_46"):"drop_abroad"===e.blockade&&e.incoming_value.startsWith(a("Waf.Block.index_47"))?a("Waf.Block.index_48"):"inc"===e.blockade?a("Waf.Block.index_49"):"cc"===e.blockade?"CC":a("Waf.Block.index_49")},{key:"blocking_time",title:a("Waf.Block.index_50"),minWidth:70,width:"6%",render:e=>a("Waf.Block.index_51",[e.blocking_time])},{key:"is_feng",title:a("Waf.Block.index_17"),minWidth:60,width:"6%",render:e=>e.is_feng?E("span",{class:"text-error"},[a("Waf.Block.index_56")]):a("Waf.Block.index_18")},{key:"ip_country",title:a("Waf.Block.index_19"),minWidth:140,width:"14%",render:e=>e.ip_country===a("Waf.Block.index_20")?e.ip_country:(e=>e.ip_country)(e)},x({width:240,options:e=>[{label:a("Waf.Block.index_52"),onClick:()=>{B(e,!1)}},{label:a("Waf.Block.index_22"),onClick:()=>{h(e)}},{label:a("Waf.Block.index_53"),onClick:()=>{j(e)}},{label:a("Waf.Block.index_24"),onClick:()=>{v(e)}}]})]),j=e=>{e.is_feng?W({title:a("Waf.Block.index_33"),content:a("Waf.Block.index_54",[e.ip]),onConfirm:async()=>{await b({ip:e.ip}),U()}}):r.success(a("Waf.Block.index_55"))},$=J({p:1,limit:10,keyword:"",query_data:"all"}),S=()=>{const e=(()=>{if(t($.query_data))return o(new Date($.query_data),"yyyy-MM-dd");if("today"===$.query_data)return o(new Date,"yyyy-MM-dd");if("yesterday"===$.query_data){const e=te(new Date,-1);return o(e,"yyyy-MM-dd")}return""})();return{p:$.p,limit:$.limit,...e?{query_data:e}:{},...$.keyword?{keyword:$.keyword}:{}}},U=async()=>{try{w(!0);const e=S(),{message:t}=await g(e);d(t)&&(u.data=t.data,u.total=t.count)}finally{w(!1)}},P=()=>{$.p=1,U()};return U(),(e,t)=>{const a=f,o=K,n=k,d=p,c=_;return z(),L("div",null,[E(c,null,{toolsLeft:A((()=>[E(a,{value:V($).keyword,"onUpdate:value":t[0]||(t[0]=e=>V($).keyword=e),width:"300",placeholder:e.$t("Waf.Block.index_8"),onSearch:P},null,8,["value","placeholder"]),E(o,{type:"primary",onClick:P},{default:A((()=>[T(Q(e.$t("Public.Btn.Search")),1)])),_:1}),E(o,{onClick:l},{default:A((()=>[T(Q(e.$t("Public.Btn.Export")),1)])),_:1}),E(o,{onClick:i},{default:A((()=>[T(Q(e.$t("Waf.Block.index_9")),1)])),_:1})])),toolsRight:A((()=>[E(le,{value:V($).query_data,"onUpdate:value":t[1]||(t[1]=e=>V($).query_data=e),onSearch:P},null,8,["value"])])),table:A((()=>[E(de,{total:V(u).total,date:V($).query_data},null,8,["total","date"]),H("div",ce,[E(o,{onClick:s},{default:A((()=>[T(Q(e.$t("Waf.Block.index_30")),1)])),_:1})]),E(n,{loading:V(u).loading,data:V(u).data,columns:V(y)},null,8,["loading","data","columns"])])),pageRight:A((()=>[E(d,{page:V($).p,"onUpdate:page":t[2]||(t[2]=e=>V($).p=e),"page-size":V($).limit,"onUpdate:pageSize":t[3]||(t[3]=e=>V($).limit=e),"item-count":V(u).total,"store-key":"waf-ip-record",onRefresh:U},null,8,["page","page-size","item-count"])])),_:1})])}}}),ue=S({__name:"index",setup(e){const t=N((()=>s((()=>import("./config4.js?v=1732601582185")),__vite__mapDeps([12,6,3,4,2,5,7,8,9,10,11,13])))),{t:a}=M(),l=()=>{W({title:a("Waf.Block.index_60"),content:a("Waf.Block.index_61"),onConfirm:async()=>{await $(),v()}})},i=y(a("Waf.Block.index_57")),n=()=>{i.show=!0},{table:c,columns:r,setLoading:x}=m([{key:"timestimp",title:a("Waf.Block.index_12"),minWidth:150,width:"14%",render:e=>o(e.timestimp)},{key:"status",title:a("Waf.Block.index_17"),minWidth:80,width:"6%",render:e=>E("span",{class:e.status===a("Waf.Block.index_58")?"text-error":""},[e.status])},{key:"rule_ps",title:a("Waf.Block.index_62"),minWidth:120,ellipsis:{tooltip:!0},render:e=>E("span",{class:"text-primary"},["".concat(e.key,"-").concat(e.rule_ps)])},{key:"server_name",title:a("Waf.Block.index_14"),minWidth:140,width:"14%",ellipsis:{tooltip:{contentStyle:{maxWidth:"500px"}}}},{key:"ip",title:a("Waf.Block.index_63"),minWidth:140,width:"14%",ellipsis:{tooltip:!0}},{key:"ip_country",title:a("Waf.Block.index_64"),minWidth:140,width:"14%",render:e=>E("span",null,[e.ip_country])}]),h=J({p:1,limit:10,filter:"all",keyword:""}),B=async()=>{try{x(!0);const e={p:1,limit:10,..."all"!==h.filter?{filter:h.filter}:{},...h.keyword?{keyword:h.keyword}:{}},{message:t}=await j(e);d(t)&&(c.data=t.list,c.total=t.total)}finally{x(!1)}},v=()=>{h.p=1,B()};return B(),(e,a)=>{const o=f,d=K,s=Z,y=G,m=k,x=p,W=_,w=u;return z(),L("div",null,[E(W,null,{toolsLeft:A((()=>[E(o,{value:V(h).keyword,"onUpdate:value":a[0]||(a[0]=e=>V(h).keyword=e),width:"300",placeholder:e.$t("Waf.Block.index_8"),onSearch:v},null,8,["value","placeholder"]),E(d,{type:"primary",onClick:v},{default:A((()=>[T(Q(e.$t("Public.Btn.Search")),1)])),_:1}),E(d,{onClick:l},{default:A((()=>[T(Q(e.$t("Waf.Block.index_9")),1)])),_:1}),E(d,{onClick:n},{default:A((()=>[T(Q(e.$t("Waf.Block.index_57")),1)])),_:1})])),toolsRight:A((()=>[E(y,{value:V(h).filter,"onUpdate:value":[a[1]||(a[1]=e=>V(h).filter=e),v]},{default:A((()=>[E(s,{value:"all"},{default:A((()=>[T(Q(e.$t("Public.All")),1)])),_:1}),E(s,{value:"refuse"},{default:A((()=>[T(Q(e.$t("Waf.Block.index_58")),1)])),_:1}),E(s,{value:"accept"},{default:A((()=>[T(Q(e.$t("Waf.Block.index_59")),1)])),_:1})])),_:1},8,["value"])])),table:A((()=>[E(de,{total:V(c).total,"is-rule":!0},null,8,["total"]),E(m,{loading:V(c).loading,data:V(c).data,columns:V(r)},null,8,["loading","data","columns"])])),pageRight:A((()=>[E(x,{page:V(h).p,"onUpdate:page":a[2]||(a[2]=e=>V(h).p=e),"page-size":V(h).limit,"onUpdate:pageSize":a[3]||(a[3]=e=>V(h).limit=e),"item-count":V(c).total,"store-key":"waf-rule-record",onRefresh:B},null,8,["page","page-size","item-count"])])),_:1}),E(w,{show:V(i).show,"onUpdate:show":a[4]||(a[4]=e=>V(i).show=e),title:V(i).title,data:V(i).data,width:400,"min-height":370,footer:!0,component:V(t)},null,8,["show","title","data","component"])])}}}),_e=S({__name:"index",setup(t){const{t:a}=M(),l=P("block"),i=[{key:"block",label:a("Waf.Block.index_1"),component:se},{key:"ip",label:a("Waf.Block.index_2"),component:re},{key:"rule",label:a("Waf.Block.index_3"),component:ue}];return(t,a)=>{const o=e,n=ee;return z(),X(n,{class:"p-16px"},{default:A((()=>[E(o,{value:V(l),"onUpdate:value":a[0]||(a[0]=e=>Y(l)?l.value=e:null),options:i},null,8,["value"])])),_:1})}}});export{_e as default};
