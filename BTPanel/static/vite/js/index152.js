import{ax as e,aw as t,j as a,eG as l,bh as s,a as i,h as n,n as o,k as u,ae as r,B as p,g as d,bf as c,ay as m,cQ as _,_ as f,q as h}from"./index.js?v=1723125373998";import{o as v}from"./site2.js?v=1723125373998";import{S as w,aC as g}from"./site.js?v=1723125373998";import{f as x,o as y,h as b,i as j,j as k,k as P}from"./index59.js?v=1723125373998";import{_ as C}from"./index77.js?v=1723125373998";import{A as O,a as D,l as R,P as q,S as M,Z as z,W,_ as B,U as S,V as U,D as A,ad as F,r as L,b as $,aq as I,q as T,a3 as E,d as H,af as K,f as V}from"./vue.js?v=1723125373998";import{u as G,_ as N}from"./useTableData.js?v=1723125373998";import{u as Q}from"./useLoading.js?v=1723125373998";import{_ as Z}from"./Switch.js?v=1723125373998";import{_ as J}from"./index73.js?v=1723125373998";import{_ as X}from"./Tag.js?v=1723125373998";import{b as Y,a as ee}from"./useTableColumns.js?v=1723125373998";import{_ as te}from"./Alert.js?v=1723125373998";import{_ as ae}from"./form.vue_vue_type_script_setup_true_lang2.js?v=1723125373998";import{_ as le}from"./Image.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./index70.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang2.js?v=1723125373998";import"./DataTable.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./Select.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./omit.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang3.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1723125373998";import"./index144.js?v=1723125373998";import"./Tabs.js?v=1723125373998";import"./index105.js?v=1723125373998";import"./use-theme-vars.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang13.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1723125373998";import"./InputGroupLabel.js?v=1723125373998";import"./InputGroup.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1723125373998";import"./file2.js?v=1723125373998";import"./Spin.js?v=1723125373998";import"./refersh.js?v=1723125373998";import"./php.js?v=1723125373998";import"./Space.js?v=1723125373998";import"./index145.js?v=1723125373998";import"./Progress.js?v=1723125373998";import"./data.js?v=1723125373998";import"./Skeleton.js?v=1723125373998";import"./_createCompounder.js?v=1723125373998";const se=Symbol("server-list");function ie(){return D(se)}const ne=a=>e.post("/tamper_core/add_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),oe=a=>e.post("/tamper_core/remove_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),ue=B("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1),re=R({__name:"index",setup(i,{expose:n}){const{site:o,setPid:u}=ie(),{loading:r,setLoading:p}=Q(),{table:d,columns:c}=G([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:l=>q(Z,{value:l.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async s=>{const{message:i}=await(n={key:l.key,value:s,path_id:l.id},e.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;a(i)&&i.status&&(l.status=s)}},null)}]),m=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],_=async()=>{try{p(!0);const{message:t}=await x({path:o.path});a(t)&&!l(t)?(u(t.pid),e=t,d.data=m.map((t=>{const a="is_".concat(t.name),l=e[a];return{key:a,id:e.pid,name:"Disabled ".concat(t.title),status:s(l)?l:0}}))):d.data=[]}finally{p(!1)}var e};return _(),n({init:_}),(e,t)=>{const a=N;return M(),z("div",null,[q(a,{loading:W(r),"loading-num":9,"max-height":340,data:W(d).data,columns:W(c)},null,8,["loading","data","columns"]),ue])}}});const pe=i({},[["render",function(e,t){const a=X;return M(),S(a,{size:"small",bordered:!1},{default:U((()=>[A(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-3eeccaf3"]]),de={class:"flex mb-12px"},ce={class:"w-240px mr-12px"},me=B("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1),_e=B("div",null,"Example:",-1),fe=R({__name:"index",setup(e,{expose:t}){const{t:l}=F(),{site:s,setPid:i}=ie(),d=L("");let c=-1,m="";const _=async()=>{if(""===d.value.trim())return void o.error("Please enter suffix");const{message:e}=await ne({path_id:c,path:m,exts:d.value});a(e)&&(e.status?(o.success(e.msg),d.value="",y()):o.error(e.msg))},{table:f,columns:h}=G([{key:"exts",title:"Suffix"},Y({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{v(e)}}]})]),v=async e=>{n({title:"Delete protected file suffix [".concat(e.exts,"]"),content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await oe({path_id:e.id,path:m,exts:e.exts});a(t)&&(t.status?(o.success(t.msg),y()):o.error(t.msg))}})},{loading:w,setLoading:g}=Q(),y=async()=>{try{g(!0);const{message:t}=await x({path:s.path});a(t)&&(i(t.pid),c=(e=t).pid,m=e.path,u(e.black_exts)?f.data=e.black_exts.filter((e=>"/"!=e[0]&&-1==e.indexOf("./"))).map((t=>({id:e.pid,exts:t}))):f.data=[])}finally{g(!1)}var e};return y(),t({init:y}),(e,t)=>{const a=r,l=p,s=N,i=pe,n=J;return M(),z("div",null,[B("div",de,[B("div",ce,[q(a,{value:W(d),"onUpdate:value":t[0]||(t[0]=e=>$(d)?d.value=e:null),placeholder:"Suffix",onKeyup:I(_,["enter"])},null,8,["value"])]),q(l,{type:"primary",onClick:_},{default:U((()=>[T(E(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(w),"loading-num":6,"max-height":230,data:W(f).data,columns:W(h)},null,8,["loading","data","columns"]),q(n,{class:"mt-16px"},{default:U((()=>[me,B("li",null,[T(" As: "),q(i,null,{default:U((()=>[T(".php")])),_:1}),T(", "),q(i,null,{default:U((()=>[T(".html")])),_:1}),T(", "),q(i,null,{default:U((()=>[T(".js?v=1723125373998")])),_:1}),T(", "),q(i,null,{default:U((()=>[T("index.php")])),_:1}),T(" etc. ")]),_e,B("li",null,[q(i,null,{default:U((()=>[T(".php")])),_:1}),T(" Match: "),q(i,null,{default:U((()=>[T("./1.php")])),_:1}),T(),q(i,null,{default:U((()=>[T("./test/2.php")])),_:1}),T(" Mismatch: "),q(i,null,{default:U((()=>[T("./1.php/1.txt")])),_:1})]),B("li",null,[q(i,null,{default:U((()=>[T("index.php")])),_:1}),T(" Match: "),q(i,null,{default:U((()=>[T("./index.php")])),_:1}),T(),q(i,null,{default:U((()=>[T("./test/index.php")])),_:1}),q(i,{class:"ml-0.5em"},{default:U((()=>[T("./abc_index.php")])),_:1}),T(" Mismatch: "),q(i,null,{default:U((()=>[T("./index.php.tar.gz")])),_:1})])])),_:1})])}}}),he={class:"flex mb-12px"},ve={class:"w-240px mr-12px"},we=B("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1),ge=B("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1),xe=R({__name:"index",setup(e,{expose:t}){const{t:l}=F(),{site:s,setPid:i}=ie(),d=L("");let c=-1,m="";const _=async()=>{if(""===d.value.trim())return void o.error("Please enter the full path or relative path of the file");const{message:e}=await ne({path_id:c,path:m,exts:d.value});a(e)&&(e.status?(o.success(e.msg),d.value="",y()):o.error(e.msg))},{table:f,columns:h}=G([{key:"exts",title:"Full file path"},Y({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{v(e)}}]})]),v=async e=>{n({title:"Delete protected files [".concat(e.exts,"]"),content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await oe({path_id:e.id,path:m,exts:e.exts});a(t)&&(t.status?(o.success(t.msg),y()):o.error(t.msg))}})},{loading:w,setLoading:g}=Q(),y=async()=>{try{g(!0);const{message:t}=await x({path:s.path});a(t)&&(i(t.pid),c=(e=t).pid,m=e.path,u(e.black_exts)?f.data=e.black_exts.filter((e=>"/"==e[0]||"."==e[0]&&"/"==e[1])).map((t=>({id:e.pid,exts:t}))):f.data=[])}finally{g(!1)}var e};return y(),t({init:y}),(e,t)=>{const a=r,l=p,s=N,i=pe,n=J;return M(),z("div",null,[B("div",he,[B("div",ve,[q(a,{value:W(d),"onUpdate:value":t[0]||(t[0]=e=>$(d)?d.value=e:null),placeholder:"Full path Or Relative path",onKeyup:I(_,["enter"])},null,8,["value"])]),q(l,{type:"primary",onClick:_},{default:U((()=>[T(E(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(w),"loading-num":5,"max-height":200,data:W(f).data,columns:W(h)},null,8,["loading","data","columns"]),q(n,{class:"mt-16px"},{default:U((()=>[we,B("li",null,[T("1. Complete file path, such as: "),q(i,null,{default:U((()=>[T("/www/wwwroot/test/123.log")])),_:1})]),B("li",null,[T(" 2. Relative path to the site, such as: Full path "),q(i,null,{default:U((()=>[T("/www/wwwroot/test/app/123.log")])),_:1}),T(" Relative path "),q(i,null,{default:U((()=>[T("./app/123.log")])),_:1})]),B("li",null,[T(" 3. All files in the specified directory, such as: "),q(i,null,{default:U((()=>[T("/www/wwwroot/test/app/*")])),_:1}),T(" Relative path "),q(i,null,{default:U((()=>[T("./app/*")])),_:1})]),B("li",null,[T(" 4. the specified directory under the specified file type, such as: "),q(i,null,{default:U((()=>[T("/www/wwwroot/test/app/*.log")])),_:1}),T(" Relative path "),q(i,null,{default:U((()=>[T("./app/*.log")])),_:1})]),ge])),_:1})])}}}),ye={class:"flex mb-12px"},be={class:"w-240px mr-12px"},je=B("div",null,"Example:",-1),ke=R({__name:"index",setup(l,{expose:s}){const{t:i}=F(),{site:d,setPid:c}=ie(),m=L("");let _=-1,f="";const h=async()=>{if(""===m.value.trim())return void o.error("Please enter directory name");const{message:l}=await(s={path_id:_,path:f,dirnames:m.value},e.post("/tamper_core/add_white_dirs.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(o.success(l.msg),m.value="",j()):o.error(l.msg))},{table:v,columns:w}=G([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},ee({title:"Remark",onBlur:async(l,s)=>{const{message:i}=await(n={path_id:s.id,dir_name:s.dir,ps:l},e.post("/tamper_core/set_white_dir_with_ps.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var n;a(i)&&(i.status?s.ps=l:o.error(i.msg))}}),Y({width:80,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async l=>{n({title:"Delete directory whitelist",content:l.tip_msg?l.tip_msg:"Delete [".concat(l.dir,"] later, All files in the directory will be protected, continue?"),onConfirm:async()=>{const{message:s}=await(i={path_id:l.id,path:f,dirname:l.dir},e.post("/tamper_core/remove_white_dirs.json",i,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;a(s)&&(s.status?(o.success(s.msg),j()):o.error(s.msg))}})},{loading:y,setLoading:b}=Q(),j=async()=>{try{b(!0);const{message:t}=await x({path:d.path});a(t)&&(c(t.pid),_=(e=t).pid,f=e.path,u(e.white_dirs)?v.data=e.white_dirs.map((t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t}))):v.data=[])}finally{b(!1)}var e};return j(),s({init:j}),(e,t)=>{const a=r,l=p,s=N,i=pe,n=J;return M(),z("div",null,[B("div",ye,[B("div",be,[q(a,{value:W(m),"onUpdate:value":t[0]||(t[0]=e=>$(m)?m.value=e:null),placeholder:"Directory name",onKeyup:I(h,["enter"])},null,8,["value"])]),q(l,{type:"primary",onClick:h},{default:U((()=>[T(E(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(y),"loading-num":5,"max-height":188,data:W(v).data,columns:W(w)},null,8,["loading","data","columns"]),q(n,{class:"mt-16px"},{default:U((()=>[B("li",null,[T(" Full path or directory name or parts path are allowed such as: "),q(i,null,{default:U((()=>[T("/www/abc/cache/test/")])),_:1}),T(", "),q(i,null,{default:U((()=>[T("test")])),_:1}),T(", "),q(i,null,{default:U((()=>[T("cache/test/")])),_:1})]),B("li",null,[T(" The first character of the Full path must be "),q(i,null,{default:U((()=>[T("/")])),_:1}),T(", as: "),q(i,null,{default:U((()=>[T("cache/test/")])),_:1}),T(" or "),q(i,null,{default:U((()=>[T("test")])),_:1})]),B("li",null,[T(" art of directory name or path cannot begin with "),q(i,null,{default:U((()=>[T("/")])),_:1}),T(", as: "),q(i,null,{default:U((()=>[T("/www/abc/cache/test/")])),_:1})]),je,B("li",null,[q(i,null,{default:U((()=>[T("/www/abc/")])),_:1}),T(" Match: "),q(i,null,{default:U((()=>[T("/www/abc/*")])),_:1}),T(" Mismatch: "),q(i,null,{default:U((()=>[T("/www/abc")])),_:1}),q(i,{class:"ml-0.5em"},{default:U((()=>[T("/www/abc123")])),_:1})]),B("li",null,[q(i,null,{default:U((()=>[T("test")])),_:1}),T(" Match: "),q(i,null,{default:U((()=>[T("/www/test/1.txt")])),_:1}),T(),q(i,null,{default:U((()=>[T("/www/test_abc")])),_:1}),T(" Mismatch: "),q(i,null,{default:U((()=>[T("/www/1.php")])),_:1})]),B("li",null,[q(i,null,{default:U((()=>[T("cache/test/")])),_:1}),T(" Match: "),q(i,null,{default:U((()=>[T("/www/cache/test/1.txt")])),_:1}),T(),q(i,null,{default:U((()=>[T("/cache/test/")])),_:1}),T(" Mismatch: "),q(i,null,{default:U((()=>[T("/www/cache/test")])),_:1}),T(),q(i,null,{default:U((()=>[T("/cache/")])),_:1})])])),_:1})])}}}),Pe={class:"flex mb-12px"},Ce={class:"w-240px mr-12px"},Oe=B("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1),De=B("div",null,"Example:",-1),Re=R({__name:"index",setup(l,{expose:s}){const{t:i}=F(),{site:d,setPid:c}=ie(),m=L("");let _=-1,f="";const h=async()=>{if(""===m.value.trim())return void o.error("Please enter file name");const{message:l}=await(s={path_id:_,path:f,filename:m.value},e.post("/tamper_core/add_white_files.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(o.success(l.msg),m.value="",j()):o.error(l.msg))},{table:v,columns:w}=G([{key:"filename",title:"File name"},Y({width:100,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async l=>{n({title:"Delete file whitelist [".concat(l.filename,"]"),content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:s}=await(i={path_id:l.id,path:f,filename:l.filename},e.post("/tamper_core/remove_white_files.json",i,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;a(s)&&(s.status?(o.success(s.msg),j()):o.error(s.msg))}})},{loading:y,setLoading:b}=Q(),j=async()=>{try{b(!0);const{message:t}=await x({path:d.path});a(t)&&(c(t.pid),_=(e=t).pid,f=e.path,u(e.white_files)?v.data=e.white_files.map((t=>({id:e.pid,filename:t}))):v.data=[])}finally{b(!1)}var e};return j(),s({init:j}),(e,t)=>{const a=r,l=p,s=N,i=pe,n=J;return M(),z("div",null,[B("div",Pe,[B("div",Ce,[q(a,{value:W(m),"onUpdate:value":t[0]||(t[0]=e=>$(m)?m.value=e:null),placeholder:"File name",onKeyup:I(h,["enter"])},null,8,["value"])]),q(l,{type:"primary",onClick:h},{default:U((()=>[T(E(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(y),"loading-num":6,"max-height":230,data:W(v).data,columns:W(w)},null,8,["loading","data","columns"]),q(n,{class:"mt-16px"},{default:U((()=>[B("li",null,[T(" Full path or single filename are allowed such as: "),q(i,null,{default:U((()=>[T("/test/index.php")])),_:1}),T(", "),q(i,null,{default:U((()=>[T("index.php")])),_:1})]),Oe,De,B("li",null,[q(i,null,{default:U((()=>[T("index.php")])),_:1}),T(" Match: "),q(i,null,{default:U((()=>[T("./index.php")])),_:1}),T(),q(i,null,{default:U((()=>[T("./test/index.php")])),_:1}),T(" Mismatch: "),q(i,null,{default:U((()=>[T("./abc_index.php")])),_:1}),T(),q(i,null,{default:U((()=>[T("./index.php/1.txt")])),_:1})]),B("li",null,[q(i,null,{default:U((()=>[T("/test/index.php")])),_:1}),T(" match only: "),q(i,null,{default:U((()=>[T("/test/index.php")])),_:1})])])),_:1})])}}}),qe={class:"p-20px"},Me={class:"flex items-center text-12px text-#666"},ze=B("span",{class:"mr-12px"},"Protection switch",-1),We={key:0,class:"ml-12px"},Be={class:"h-500px"},Se=R({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const a=e,l=t,s=H(a,"site");let i=-1;const n=L(a.open),o=L(),u=async e=>{e?await y({paths:[{path:s.value.path,ps:s.value.ps}]}):await b({path_id:i}),n.value=e,l("changeOpen",e),o.value.init()},r=L("basic"),p=[{key:"basic",label:"Basic Setting",component:re},{key:"suffix",label:"Protected file suffix",component:fe},{key:"protected file",label:"Protected File",component:xe},{key:"directory whitelist",label:"Directory whitelist",component:ke},{key:"file whitelist",label:"File whitelist",component:Re}];var d;return d={site:s.value,setPid:e=>{i=e}},O(se,d),(e,t)=>{const a=Z,l=te,s=C;return M(),z("div",qe,[q(l,{class:"mb-16px",type:W(n)?"success":"error","show-icon":!1,bordered:!1},{default:U((()=>[B("div",Me,[ze,q(a,{value:W(n),"onUpdate:value":u},null,8,["value"]),W(n)?K("",!0):(M(),z("span",We," Protection directory closed, be security risks, Recommended open protection immediately "))])])),_:1},8,["type"]),B("div",Be,[q(s,{ref_key:"tabsRef",ref:o,value:W(r),"onUpdate:value":t[0]||(t[0]=e=>$(r)?r.value=e:null),options:p},null,8,["value"])])])}}}),Ue=R({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const a=t,l=H(e,"site"),s=e=>{a("changeHotlink",e)};return(e,t)=>(M(),z("div",null,[q(ae,{class:"p-20px",site:W(l),onChangeHotlink:s},null,8,["site"])]))}}),Ae={class:"p-20px"},Fe={class:"tools-card"},Le={class:"tools-img"},$e={class:"tools-name"},Ie={class:"tools-desc"},Te={class:"ml-0.5em"},Ee={class:"tools-card"},He={class:"tools-img"},Ke={class:"tools-name"},Ve={class:"tools-desc"},Ge={class:"ml-0.5em"},Ne={class:"tools-card"},Qe={class:"tools-img"},Ze={class:"tools-name"},Je=i(R({__name:"index",props:{site:{}},setup(e){const t=H(e,"site"),l=V({status:!1,number:0,pid:-1}),s=L(!1),i=async e=>{try{s.value=!0,await m({source:200}),await _("tamper_core"),e?await y({paths:[{path:t.value.path,ps:t.value.ps}]}):await b({path_id:l.pid}),K()}finally{s.value=!1}},n=d("File Protection [".concat(t.value.name,"]"),{site:t.value,open:!1,onChangeOpen:e=>{l.status=e}}),o=async()=>{await m({source:200}),await _("tamper_core"),n.data.open=l.status,n.show=!0},u=V({status:!1,number:0}),r=L(!1),C=async e=>{try{r.value=!0,await m({source:201}),await _("btwaf"),e?await j({site_name:t.value.name}):await k({site_name:t.value.name}),K()}finally{r.value=!1}},O=async()=>{await m({source:201}),await _("btwaf"),v(t.value.name),D()},D=()=>{let e=0;const t=setInterval((()=>{e+=.5;const a=document.querySelector(".waf_site_body");if(a){let e=!1;new MutationObserver((t=>{t.forEach((t=>{"childList"!==t.type||document.contains(a)||e||(K(),e=!0)}))})).observe(document.body,{childList:!0,subtree:!0}),clearInterval(t)}e>=20&&clearInterval(t)}),500)},R=L(!1),S=L(!1),A=async e=>{try{S.value=!0;const{message:l}=await w({id:t.value.id,name:t.value.name},!1);if(a(l)){const a={id:t.value.id,name:t.value.name,fix:l.fix,domains:l.domains,return_rule:l.return_rule,status:e,http_status:"true"===l.http_status};await g(a,!1),R.value=e}}finally{S.value=!1}},F=d("Hotlink Protection [".concat(t.value.name,"]"),{site:t.value,onChangeHotlink:e=>{R.value=e}}),$=()=>{F.show=!0},I=e=>{s.value=e,r.value=e,S.value=e},K=async()=>{try{I(!0);const{message:e}=await P({id:t.value.id,path:t.value.path,site_name:t.value.name});if(a(e)&&(l.status=1===e.file_status,l.number=e.file_count,u.status=1===e.firewall_status,u.number=e.firewall_count,R.value=1===e.hotlink_status,1===e.file_status)){const{message:e}=await x({path:t.value.path});a(e)&&(l.pid=e.pid)}}finally{I(!1)}};return K(),(e,t)=>{const a=le,d=Z,m=f,_=p,v=X,w=h;return M(),z("div",Ae,[B("div",Fe,[B("div",Le,[q(a,{lazy:!0,"preview-disabled":!0,width:"24",src:"".concat(W(c),"images/soft-ico/ico-tamper_core.png")},null,8,["src"])]),B("div",$e,E(e.$t("WP.Label.FileProtection")),1),q(d,{value:W(l).status,loading:W(s),"onUpdate:value":i},null,8,["value","loading"]),q(_,{quaternary:"",size:"small",onClick:o},{default:U((()=>[q(m,{name:"setting",size:"18"})])),_:1}),B("div",Ie,[q(v,{type:"error",size:"small",bordered:!1},{default:U((()=>[T(E(W(l).number),1)])),_:1}),B("span",Te,E(e.$t("WP.Config.Protection.Blocked")),1)])]),B("div",Ee,[B("div",He,[q(a,{lazy:!0,"preview-disabled":!0,width:"26",src:"".concat(W(c),"images/soft-ico/ico-btwaf.png")},null,8,["src"])]),B("div",Ke,E(e.$t("WP.Label.Application")),1),q(d,{value:W(u).status,loading:W(r),"onUpdate:value":C},null,8,["value","loading"]),q(_,{quaternary:"",size:"small",onClick:O},{default:U((()=>[q(m,{name:"setting",size:"18"})])),_:1}),B("div",Ve,[q(v,{type:"error",size:"small",bordered:!1},{default:U((()=>[T(E(W(u).number),1)])),_:1}),B("span",Ge,E(e.$t("WP.Config.Protection.Requests")),1)])]),B("div",Ne,[B("div",Qe,[q(m,{name:"soft-hotlink",size:"24"})]),B("div",Ze,E(e.$t("WP.Label.Hotlink")),1),q(d,{value:W(R),loading:W(S),"onUpdate:value":A},null,8,["value","loading"]),q(_,{quaternary:"",size:"small",onClick:$},{default:U((()=>[q(m,{name:"setting",size:"18"})])),_:1})]),q(w,{show:W(n).show,"onUpdate:show":t[0]||(t[0]=e=>W(n).show=e),title:W(n).title,data:W(n).data,width:800,component:Se},null,8,["show","title","data"]),q(w,{show:W(F).show,"onUpdate:show":t[1]||(t[1]=e=>W(F).show=e),title:W(F).title,data:W(F).data,component:Ue},null,8,["show","title","data"])])}}}),[["__scopeId","data-v-9c1f3952"]]);export{Je as default};
