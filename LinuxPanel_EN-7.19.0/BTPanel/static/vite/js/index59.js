import{d as e,b as t,h as a,E as s,f as i,a as n,s as l,F as o}from"./public.js?v=1732601582185";import{_ as u}from"./index102.js?v=1732601582185";import{_ as r}from"./index.js?v=1732601582185";import{_ as c}from"./index96.js?v=1732601582185";import{_ as d}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1732601582185";import{i as p,a8 as _,S as y,I as m,bn as g,m as x,f as v,a4 as h,_ as w,k as b,u as k,n as f}from"./page_layout.js?v=1732601582185";import{_ as S}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1732601582185";import{d as I,W as A,r as j,n as O,j as P,O as C,P as U,M as R,Y as $,Q as q,Z as M,R as L,ac as T,V as z,w as F,F as W,c as K,X as E,L as H,ad as B,k as D,v as G,e as J}from"./vue.js?v=1732601582185";import{bL as Q,bh as V,ad as X,bG as Y,aa as Z,aW as N,bJ as ee,bo as te}from"./naive.js?v=1732601582185";import{_ as ae}from"./index.vue_vue_type_script_setup_true_lang.js?v=1732601582185";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang9.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";import"./index.vue_vue_type_script_setup_true_lang4.js?v=1732601582185";const{t:ie}=p.global,ne={class:"p-20px"},le=I({__name:"log",props:{data:{}},setup(a,{expose:s}){const{t:i}=A(),n=a,{date:l,name:o}=n.data,u=j([]),{keys:r,table:c,columns:p}=e([{key:"log",title:i("Ftp.Analysis.Index_27"),render:()=>o},{key:"cwd",title:i("Security.Anti.Index_46")},{key:"cmd",title:i("Security.Anti.Index_47")},{key:"filename",title:i("Security.Anti.Index_48")},{key:"cwd",title:i("Config.Safe.index_152"),render:e=>y(e.timestamp)}]);O((()=>{u.value=l.map((e=>({label:e,value:e})))}));const g=P({p:1,num:999,day:l[0]}),{loading:x,setLoading:v}=t(),h=async()=>{try{v(!0);const{message:t}=await(e={...g,user:o},_.post("/plugin?action=a&name=bt_security&s=get_user_log",e));m(t)&&(c.data=t,c.total=t.length)}finally{r.value=[],v(!1)}var e};return h(),s({init:h}),(e,t)=>{const a=Q,s=V,i=d,n=S;return C(),U("div",ne,[R(s,{class:"flex-nowrap! items-center mb-10px"},{default:$((()=>[q("span",null,M(e.$t("Security.Anti.Index_45")),1),R(a,{class:"w-150px",value:L(g).day,"onUpdate:value":[t[0]||(t[0]=e=>L(g).day=e),h],options:L(u)},null,8,["value","options"])])),_:1}),R(n,null,{table:$((()=>[R(i,{"checked-row-keys":L(r),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>T(r)?r.value=e:null),loading:L(x),data:L(c).data,"max-height":350,columns:L(p)},null,8,["checked-row-keys","loading","data","columns"])])),_:1})])}}}),oe=I({__name:"index",setup(n,{expose:l}){const{t:o}=A(),u=g(),{antiForm:p}=z(u),y=a(),{keys:h,table:w,columns:b}=e([{key:"user",title:o("Ftp.Analysis.Index_27")},{key:"total",title:o("Security.Anti.Index_7")},{key:"today",title:o("Public.Search.Today")},s({key:"protection",title:o("Security.Tabs.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={user:t.user},_.post("/plugin?action=a&name=bt_security&s=start_user_security",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>_.post("/plugin?action=a&name=bt_security&s=stop_user_security",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({user:t.user})}}),s({key:"log",title:o("Security.Anti.Index_8"),minWidth:60,onClick:async(e,t)=>{var a;e?await(a={uid:t.uid},_.post("/plugin?action=a&name=bt_security&s=start_user_log",a,{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}})):await(e=>_.post("/plugin?action=a&name=bt_security&s=stop_user_log",e,{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}))({uid:t.uid})}}),{key:"remark",title:o("Site.Proxy.index_3")},i({width:130,title:o("Public.Table.Operation"),options:e=>[{label:o("Site.Proxy.index_51"),onClick:async()=>{const{message:t}=await(a={user:e.user},_.post("/plugin?action=a&name=bt_security&s=get_logs_list",a,{requestOptions:{loading:ie("Site.Api.Index_10"),successMessage:!1}}));var a;!m(t)||t.length?(y.title="[".concat(e.user,"] - ").concat(o("Site.Proxy.index_51")),y.data.date=t,y.data.name=e.user,y.show=!0):x.error(o("Security.Anti.Index_44"))}}]})]);F((()=>u.isRefresh),(e=>{e&&(u.setRefresh(!1),S())}));const{loading:k,setLoading:f}=t(),S=async()=>{try{f(!0);const{message:e}=await _.post("/plugin?action=a&name=bt_security&s=get_total_all");v(e)&&(p.value.switch=e.open,p.value.times=e.totla_times,p.value.days=e.totla_days,w.data=e.system_user.map((e=>({user:e[0],total:e[4].totla,today:e[4].day_totla,protection:e[3],log:e[5],remark:e[6],uid:e[1]}))))}finally{h.value=[],f(!1)}};return S(),l({init:S}),(e,t)=>{const a=d,s=c,i=r;return C(),U(W,null,[R(a,{"checked-row-keys":L(h),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>T(h)?h.value=e:null),"row-key":"user","max-height":750,loading:L(k),data:L(w).data,columns:L(b)},null,8,["checked-row-keys","loading","data","columns"]),R(s,{class:"mt-16px"},{default:$((()=>[q("li",null,M(e.$t("Security.Anti.Index_4")),1),q("li",null,M(e.$t("Security.Anti.Index_5")),1),q("li",null,M(e.$t("Security.Anti.Index_6")),1)])),_:1}),R(i,{show:L(y).show,"onUpdate:show":t[1]||(t[1]=e=>L(y).show=e),title:L(y).title,data:L(y).data,width:750,"min-height":268,footer:!1,component:le},null,8,["show","title","data"])],64)}}}),ue={class:"p-20px"},re={class:"w-280px"},ce={class:"color-#ff3333"},de=I({__name:"form",props:{data:{}},setup(e,{expose:t}){const{t:a}=A(),s=e,{getList:i}=s.data,n=j(null),l=P({name:""}),o={name:{required:!0,message:a("Security.Conf.Index_28"),trigger:["blur","input"]}};return t({onConfirm:async({hide:e})=>{var t,a;await(null==(t=n.value)?void 0:t.validate()),await(a={cmd:l.name},_.post("/plugin?action=a&name=bt_security&s=add_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_4"),successMessage:!0}})),null==i||i(),e()}}),(e,t)=>{const a=X,s=Y,i=ae,u=c;return C(),U("div",ue,[R(i,{ref_key:"formRef",ref:n,model:L(l),rules:o},{default:$((()=>[R(s,{label:e.$t("Home.index_24"),path:"name"},{default:$((()=>[q("div",re,[R(a,{type:"text",value:L(l).name,"onUpdate:value":t[0]||(t[0]=e=>L(l).name=e),placeholder:"e.g:/bin/bash"},null,8,["value"])])])),_:1},8,["label"])])),_:1},8,["model"]),R(u,{class:"mt-4px"},{default:$((()=>[q("li",ce,M(e.$t("Security.Anti.Index_9")),1)])),_:1})])}}}),pe=I({__name:"index",setup(s,{expose:l}){const{t:o}=A(),{loading:u,setLoading:c}=t(),{keys:p,table:y,columns:g}=e([{key:"whitelist",title:o("Security.Anti.Index_11")},i({width:130,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{n({title:"".concat(o("Security.Anti.Index_12")," [").concat(e.whitelist,"]"),content:o("Security.Anti.Index_13"),onConfirm:async({hide:t})=>{var a;await(a={cmd:e.whitelist},_.post("/plugin?action=a&name=bt_security&s=del_porcess_log",a,{requestOptions:{loading:ie("Security.Api.Index_3"),successMessage:!0}})),x(),t()}})}}]})]),x=async()=>{try{c(!0);const{message:e}=await _.post("/plugin?action=a&name=bt_security&s=porcess_set_up_log");m(e)&&(y.data=e.map((e=>({whitelist:e}))))}finally{p.value=[],c(!1)}};x(),l({init:x});const v=()=>{h.show=!0},h=a(o("Security.Anti.Index_10"),{getList:x});return(e,t)=>{const a=Z,s=d,i=S,n=r;return C(),U("div",null,[R(i,null,{toolsLeft:$((()=>[R(a,{type:"primary",onClick:v},{default:$((()=>[K(M(e.$t("Security.Anti.Index_10")),1)])),_:1})])),table:$((()=>[R(s,{"checked-row-keys":L(p),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>T(p)?p.value=e:null),"row-key":"whitelist",loading:L(u),"max-height":440,data:L(y).data,columns:L(g)},null,8,["checked-row-keys","loading","data","columns"])])),_:1}),R(n,{show:L(h).show,"onUpdate:show":t[1]||(t[1]=e=>L(h).show=e),title:L(h).title,data:L(h).data,width:480,footer:!0,component:de},null,8,["show","title","data"])])}}}),_e=I({__name:"index",setup(a,{expose:s}){const{t:i}=A(),{keys:n,table:l,columns:o}=e([{key:"log",title:i("Public.Table.Operation")},{key:"addtime",align:"right",title:i("Site.Cert.index_68")}]),u=P({p:1,limit:10}),{loading:r,setLoading:c}=t(),p=async()=>{try{c(!0);const{message:t}=await(e=u,_.post("/plugin?action=a&name=bt_security&s=get_log",e));v(t)&&(l.data=t.data,l.total=h(t.page))}finally{n.value=[],c(!1)}var e};return p(),s({init:p}),(e,t)=>{const a=d,s=se,i=S;return C(),E(i,{feedback:!0},{table:$((()=>[R(a,{"checked-row-keys":L(n),"onUpdate:checkedRowKeys":t[0]||(t[0]=e=>T(n)?n.value=e:null),"row-key":"log",loading:L(r),data:L(l).data,columns:L(o)},null,8,["checked-row-keys","loading","data","columns"])])),pageRight:$((()=>[R(s,{page:L(u).p,"onUpdate:page":t[1]||(t[1]=e=>L(u).p=e),"page-size":L(u).limit,"onUpdate:pageSize":t[2]||(t[2]=e=>L(u).limit=e),"item-count":L(l).total,"store-key":"security-anti",onRefresh:p},null,8,["page","page-size","item-count"])])),_:1})}}}),ye=I({__name:"index",setup(e){const{t:t}=A(),a=j("overview"),s=[{key:"overview",label:t("Security.Tabs.Index_5"),component:oe},{key:"whitelist",label:t("Security.Tabs.Index_6"),component:pe},{key:"operation",label:t("Security.Tabs.Index_7"),component:_e}];return(e,t)=>{const i=u;return C(),E(i,{value:L(a),"onUpdate:value":t[0]||(t[0]=e=>T(a)?a.value=e:null),options:s},null,8,["value"])}}}),me={class:"pt-40px pb-40px"},ge={class:"mb-16px"},xe={class:"ul-style"},ve={class:"text-center my-24px"},he={class:"flex justify-center"},we={class:"item"},be=["onClick"],ke=b(I({__name:"conversion",setup(e){const t=j(0),a=["Overview","Process whitelist","Operation logs"],s=()=>{l({source:105})};return(e,i)=>{const n=w,l=Z,o=N,u=ee;return C(),E(u,null,{default:$((()=>[q("div",me,[i[3]||(i[3]=q("div",{class:"mb-24px text-center text-22px font-bold"},"Anti Intrusion prevention features",-1)),q("div",ge,[q("ul",xe,[q("li",null,[R(n,{name:"security-lixian",size:"22"}),i[0]||(i[0]=q("span",{class:"ml-4px"},"Prevents the program from hanging",-1))]),q("li",null,[R(n,{name:"security-sanfang",size:"20"}),i[1]||(i[1]=q("span",{class:"ml-4px"},"Stop the mining virus",-1))]),q("li",null,[R(n,{name:"security-webshell",size:"26"}),i[2]||(i[2]=q("span",null,"Prevent Privilege Escalation Attacks",-1))])])]),q("div",ve,[R(l,{type:"primary",class:"h-36px text-14px",onClick:s},{default:$((()=>[K(M(e.$t("WP.Transition.index_7")),1)])),_:1})]),q("div",he,[q("div",we,[q("ul",null,[(C(),U(W,null,H(a,((e,a)=>q("li",{class:B({active:L(t)==a}),key:a,onClick:e=>t.value=a},M(e),11,be))),64))])]),D(R(o,{width:"100%",src:L("/static/vite/images/overview2.png")},null,8,["src"]),[[G,0==L(t)]]),D(R(o,{width:"100%",src:L("/static/vite/images/whitelist.png")},null,8,["src"]),[[G,1==L(t)]]),D(R(o,{width:"100%",src:L("/static/vite/images/logs.png")},null,8,["src"]),[[G,2==L(t)]])])])])),_:1})}}}),[["__scopeId","data-v-e7a4054e"]]),fe={key:0},Se=I({__name:"index",setup(e){const t=k(),{isPro:a}=z(t),s=g(),{antiForm:i}=z(s),n=j(i.value.switch),l=J((()=>i.value.switch));F(l,(e=>{n.value=e}));const u=J((()=>i.value.times)),r=J((()=>i.value.days)),c=async e=>{e?await _.post("/plugin?action=a&name=bt_security&s=start_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_1"),successMessage:!0}}):await _.post("/plugin?action=a&name=bt_security&s=stop_bt_security",{},{requestOptions:{loading:ie("Security.Api.Index_2"),successMessage:!0}}),await s.setRefresh(!0)};return(async()=>{a.value&&await o("bt_security")})(),(e,t)=>{const s=te,i=f,l=V,o=ee;return L(a)?(C(),U("div",fe,[R(o,{class:"my-15px"},{default:$((()=>[R(l,{class:"p-15px items-center"},{default:$((()=>[q("span",null,M(e.$t("Security.Anti.Index_1")),1),R(s,{value:L(n),"onUpdate:value":[t[0]||(t[0]=e=>T(n)?n.value=e:null),c],"rubber-band":!1,size:"small"},null,8,["value"]),R(i,{vertical:""}),q("span",null,M(e.$t("Security.Anti.Index_2"))+": "+M(L(u)),1),R(i,{vertical:""}),q("span",null,M(e.$t("Security.Anti.Index_3"))+": "+M(L(r)),1)])),_:1})])),_:1}),R(o,{class:"p-15px"},{default:$((()=>[R(ye)])),_:1})])):(C(),E(ke,{key:1}))}}});export{Se as default};
