import{j as t,k as a,m as e,g as o,q as s}from"./index.js?v=1723125373998";import{_ as i}from"./index.vue_vue_type_script_setup_true_lang.js?v=1723125373998";import{u as l,_ as p}from"./useTableData.js?v=1723125373998";import{u as n}from"./useLoading.js?v=1723125373998";import{b as r}from"./useTableColumns.js?v=1723125373998";import{a6 as d,a7 as m}from"./mail.js?v=1723125373998";import{_ as u}from"./index.vue_vue_type_script_setup_true_lang2.js?v=1723125373998";import{l as y,f as c,P as _,S as g,U as f,V as w,W as h,t as j,F as k,Z as v,q as b}from"./vue.js?v=1723125373998";import{_ as D}from"./Ellipsis.js?v=1723125373998";import{_ as x}from"./RadioButton.js?v=1723125373998";import{b as S}from"./DataTable.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1723125373998";import"./data.js?v=1723125373998";import"./Skeleton.js?v=1723125373998";import"./Progress.js?v=1723125373998";import"./Switch.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Select.js?v=1723125373998";import"./Tag.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./omit.js?v=1723125373998";const z=y({__name:"details",props:{id:{},type:{},row:{}},setup(o){const s=o,r=c({task_id:s.id,type:s.type,value:"domain"===s.type?s.row.domain:s.row.status,page:1,size:10}),{loading:m,setLoading:y}=n(),{table:k,columns:v}=l([{key:"recipient",title:"Recipient",width:160,render:t=>_(D,{class:t.tooltip?"":"break-all!","line-clamp":t.tooltip?999:1,tooltip:!1},{default:()=>[t.recipient]})},{key:"dsn",title:"Dsn",width:60},{key:"delay",title:"Delay",width:70},{key:"delays",title:"Delays",width:150},{key:"relay",title:"Relay",width:200,render:t=>_(D,{class:t.tooltip?"":"break-all!","line-clamp":t.tooltip?9999:1,tooltip:!1},{default:()=>[t.relay]})},{key:"err_info",title:"Details",render:t=>_(D,{class:t.tooltip?"":"break-all!","line-clamp":t.tooltip?9999:1,tooltip:!1},{default:()=>[t.err_info]})}]),b=t=>({onMousemove:()=>{t.tooltip=!0},onMouseleave:()=>{t.tooltip=!1}}),x=async()=>{try{y(!0);const{message:o}=await d(j(r));t(o)&&(k.data=a(o.data)?o.data.map((t=>({...t,tooltip:!1}))):[],k.total=e(o.page))}finally{y(!1)}};return"domain"===r.type&&v.value.push({key:"status",title:"Status",width:100,ellipsis:{tooltip:!0},render:t=>t.status}),"status"===r.type&&v.value.unshift({key:"domain",title:"Domain",width:120,ellipsis:{tooltip:!0},render:t=>t.domain}),x(),(t,a)=>{const e=p,o=u,s=i;return g(),f(s,{class:"p-20px"},{table:w((()=>[_(e,{loading:h(m),data:h(k).data,columns:h(v),"row-props":b},null,8,["loading","data","columns"])])),pageRight:w((()=>[_(o,{page:h(r).page,"onUpdate:page":a[0]||(a[0]=t=>h(r).page=t),"page-size":h(r).size,"onUpdate:pageSize":a[1]||(a[1]=t=>h(r).size=t),"item-count":h(k).total,onRefresh:x},null,8,["page","page-size","item-count"])])),_:1})}}}),R={class:"p-20px"},U=y({__name:"index",props:{row:{}},setup(t){const e=t,d=c({task_id:e.row.id,type:"domain"}),{loading:u,setLoading:y}=n(),{table:f,columns:D}=l([{key:"domain",title:()=>_(k,null,["domain"===d.type?"Domain":"Status"]),render:t=>"domain"===d.type?t.domain:t.status},{key:"count",title:"Number"},r({width:120,options:t=>[{label:"Details",onClick:()=>{L(t)}}]})]),U=o(""),L=t=>{U.data.id=e.row.id,U.data.type=d.type,U.data.row=t,U.title="Failure Details [".concat("domain"===d.type?t.domain:t.status,"]"),U.show=!0},T=async()=>{try{y(!0);const{message:t}=await m(j(d));f.data=a(t)?t:[]}finally{y(!1)}};return T(),(t,a)=>{const e=x,o=S,l=p,n=i,r=s;return g(),v("div",R,[_(n,null,{toolsLeft:w((()=>[_(o,{value:h(d).type,"onUpdate:value":[a[0]||(a[0]=t=>h(d).type=t),T]},{default:w((()=>[_(e,{value:"domain"},{default:w((()=>[b("Domain")])),_:1}),_(e,{value:"status"},{default:w((()=>[b("Status")])),_:1})])),_:1},8,["value"])])),table:w((()=>[_(l,{"max-height":340,loading:h(u),data:h(f).data,columns:h(D)},null,8,["loading","data","columns"])])),_:1}),_(r,{show:h(U).show,"onUpdate:show":a[1]||(a[1]=t=>h(U).show=t),title:h(U).title,data:h(U).data,width:980,"min-height":152,component:z},null,8,["show","title","data"])])}}});export{U as default};
