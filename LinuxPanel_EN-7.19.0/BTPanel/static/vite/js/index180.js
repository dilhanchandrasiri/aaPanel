import{a1 as e,h as a,m as l,bl as t,_ as s,dt as i,k as o}from"./page_layout.js?v=1732601582185";import{d as n,W as p,r as d,e as r,M as u,O as c,P as m,Q as f,Y as _,c as x,Z as h,R as v,ac as C,X as g,an as U}from"./vue.js?v=1732601582185";import{f as y}from"./public.js?v=1732601582185";import{u as b}from"./file.js?v=1732601582185";import{aV as F,aa as w,bR as j}from"./naive.js?v=1732601582185";import"./common.js?v=1732601582185";import"./__commonjsHelpers__.js?v=1732601582185";const k={class:"p-16px"},z={class:"flex items-center mb-12px"},D={key:1,class:"flex-center flex-col h-300px"},B={class:"drag-text"},S={class:"drag-suffix"},$=o(n({__name:"index",props:{path:{default:""},size:{default:100},uploadData:{default:()=>({multiple:!1})}},emits:["setConfirm","uploadSuccess"],setup(o,{expose:n,emit:$}){const L=o,P=$,{path:R,uploadData:E}=L,{t:H}=p(),I=e(),M=d([]),O=r((()=>(E.accept||"").split(",").map((e=>"'".concat(e,"'"))).join(", "))),Q=e=>{var a,t;const{file:s}=e,{size:i}=L;return(null!=(t=null==(a=s.file)?void 0:a.size)?t:0)>1048576*i?(l.error(H("Component.UploadFile.index_7",[s.name,i])),!1):(E.multiple||(M.value=[]),!0)},V=d([{key:"name",title:H("Component.UploadFile.index_3"),ellipsis:!0},{key:"size",title:H("Component.UploadFile.index_4"),width:100,render:e=>{var l;return a(null==(l=e.file)?void 0:l.size)}},{key:"status",title:H("Component.UploadFile.index_5"),width:140,render:e=>"pending"===e.status?H("Component.UploadFile.index_8"):"finished"===e.status?u("span",{class:"text-primary"},[H("Component.UploadFile.index_9")]):u(F,{type:"line",color:I.value.primaryColor,"indicator-placement":"outside",processing:!0,percentage:e.percentage||0},null)},y({width:70,options:(e,a)=>[{label:H("Public.Btn.Del"),type:"error",show:"uploading"!==e.status,onClick:()=>{M.value.splice(a,1)}}]})]);return n({onConfirm:async()=>{const e=M.value.filter((e=>"pending"===e.status));if(0===e.length)return l.error(H("Component.UploadFile.index_10")),!1;P("setConfirm",{disabled:!0}),e.forEach((e=>{e.status="uploading"}));for(let a of e){const e=new FormData;e.append("f_path",R),e.append("f_name",a.name),e.append("f_start","0"),a.file&&(e.append("f_size",a.file.size.toString()),e.append("blob",a.file)),await b(e,(e=>{a.percentage=100*(e.progress||0)})),a.status="finished"}l.success(H("Component.UploadFile.index_9")),P("setConfirm",{disabled:!1}),P("uploadSuccess",e)}}),(e,a)=>{const l=w,o=t,n=j,p=s,d=i;return c(),m("div",k,[f("div",z,[u(o,{ref:"upload",class:"w-auto","file-list":v(M),"onUpdate:fileList":a[0]||(a[0]=e=>C(M)?M.value=e:null),accept:v(E).accept,multiple:v(E).multiple,"default-upload":!1,"show-file-list":!1,onBeforeUpload:Q},{default:_((()=>[u(l,{type:"primary"},{default:_((()=>[x(h(e.$t("Component.UploadFile.index_6")),1)])),_:1})])),_:1},8,["file-list","accept","multiple"])]),u(o,{ref:"upload",class:"w-auto","file-list":v(M),"onUpdate:fileList":a[2]||(a[2]=e=>C(M)?M.value=e:null),accept:v(E).accept,multiple:v(E).multiple,"default-upload":!1,"show-file-list":!1,onBeforeUpload:Q},{default:_((()=>[u(d,null,{default:_((()=>[v(M).length>0?(c(),g(n,{key:0,"max-height":300,bordered:!1,data:v(M),columns:v(V),onClick:a[1]||(a[1]=U((()=>{}),["stop"]))},null,8,["data","columns"])):(c(),m("div",D,[u(p,{name:"base-upload",size:"48",class:"text-#999"}),f("div",B,h(e.$t("Component.UploadFile.index_1")),1),f("div",S,h(e.$t("Component.UploadFile.index_2",[v(O)])),1)]))])),_:1})])),_:1},8,["file-list","accept","multiple"])])}}}),[["__scopeId","data-v-6fd253a2"]]);export{$ as default};
