import{_ as e,a as t}from"./index.vue_vue_type_script_setup_true_lang6.js?v=1723125373998";import{_ as a}from"./index105.js?v=1723125373998";import{l,ah as n,ai as s,S as r,Z as i,_ as o,P as u,V as c,q as p,aj as d,a3 as m,D as _,r as f,U as v,W as b,f as h,B as j,M as x}from"./vue.js?v=1723125373998";import{B as w,j as k,ae as y}from"./index.js?v=1723125373998";import{a3 as S,a4 as U,a5 as M}from"./mail.js?v=1723125373998";import{_ as N}from"./index.vue_vue_type_script_setup_true_lang11.js?v=1723125373998";import{o as g}from"./upload.js?v=1723125373998";import{N as E,a as T,b as P}from"./DataTable.js?v=1723125373998";import{_ as C}from"./Switch.js?v=1723125373998";import"./use-theme-vars.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./Select.js?v=1723125373998";import"./Tag.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./omit.js?v=1723125373998";const D={class:"flex items-center mb-8px"},F={class:"ml-40px"},I=l({__name:"import",props:n({path:{default:""},accept:{default:()=>[]}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(e){const t=e,{path:a,accept:l}=t,n=s(e,"value"),f=()=>{g({path:a,size:5,uploadData:{accept:l.map((e=>".".concat(e))).join(","),multiple:!1},onUploadSuccess:e=>{n.value=e[0].name}})};return(e,t)=>{const a=w;return r(),i("div",null,[o("div",D,[u(a,{onClick:f},{default:c((()=>[p("Import")])),_:1}),o("div",F,[p(" File name: "),o("span",{class:d(n.value?"text-primary":"text-error")},m(n.value||"No file selected"),3)])]),_(e.$slots,"default")])}}}),O=l({__name:"table",props:{data:{default:()=>[]}},setup(e){const t=f([{key:"domain",title:"Domain",ellipsis:!0},{key:"count",title:"Number",width:120},{key:"etc",title:"Projected completion time",width:240}]);return(e,a)=>{const l=E;return r(),v(l,{"max-height":240,data:e.data,columns:b(t)},null,8,["data","columns"])}}}),B={class:"p-20px"},R={class:"w-320px"},q={class:"w-320px"},z=o("div",null,[o("span",{class:"text-error"},"*"),p(" Import format: File type txt/json One mailbox per line Not more than 5M ")],-1),L={class:"w-320px"},V=o("div",null,[o("span",{class:"text-error"},"*"),p(" Import format: File type txt/html Not more than 5M ")],-1),W={class:"w-320px"},Z={class:"w-530px"},$=l({__name:"index",emits:["refresh"],setup(l,{expose:n,emit:s}){const d=s,m=f(null),_=h({task_name:"",addresser:null,file_recipient:"",subject:"",forward_user:"",up_content:1,file_content:"",content:"",is_record:0}),v={task_name:{trigger:["blur","input"],validator:()=>""!==_.task_name.trim()||new Error("Task Name cannot be empty!")},file_recipient:{validator:()=>""!==_.file_recipient||new Error("Recipient cannot be empty!")},subject:{validator:()=>""!==_.file_recipient||new Error("Mail Subject cannot be empty!")},file_content:{validator:()=>1!==_.up_content||""!==_.file_content||new Error("Send content cannot be empty!")},content:{validator:()=>0!==_.up_content||""!==_.content.trim()||new Error("Send content cannot be empty!")}},w=f([]),g=async e=>{if(!e)return;await S({file:e});const{message:t}=await U({file:e});k(t)&&(w.value=Object.entries(t).map((([e,{count:t,etc:a}])=>({domain:e,count:t,etc:a}))))};return n({onConfirm:async()=>{var e;await(null==(e=m.value)?void 0:e.validate()),await M({task_name:_.task_name,addresser:_.addresser||"",file_recipient:_.file_recipient,subject:_.subject,up_content:_.up_content,file_content:_.file_content,content:_.content,is_record:_.is_record}),d("refresh")}}),(l,n)=>{const s=y,d=e,f=T,h=P,k=a,S=C,U=t;return r(),i("div",B,[u(U,{ref_key:"formRef",ref:m,model:b(_),rules:v},{default:c((()=>[u(d,{label:"Task Name",path:"task_name"},{default:c((()=>[o("div",R,[u(s,{value:b(_).task_name,"onUpdate:value":n[0]||(n[0]=e=>b(_).task_name=e),placeholder:"Please enter the Task Name"},null,8,["value"])])])),_:1}),u(d,{label:"Sender",path:"addresser"},{default:c((()=>[o("div",q,[u(N,{value:b(_).addresser,"onUpdate:value":n[1]||(n[1]=e=>b(_).addresser=e),"is-init":!0},null,8,["value"])])])),_:1}),u(d,{label:"To",path:"file_recipient"},{default:c((()=>[u(I,{value:b(_).file_recipient,"onUpdate:value":[n[2]||(n[2]=e=>b(_).file_recipient=e),g],path:"/www/server/panel/data/mail/in_bulk/recipient",accept:["txt","json"]},{default:c((()=>[z])),_:1},8,["value"])])),_:1}),u(d,{label:"Mail Subject",path:"subject"},{default:c((()=>[o("div",L,[u(s,{value:b(_).subject,"onUpdate:value":n[3]||(n[3]=e=>b(_).subject=e),placeholder:"Please enter the Mail Subject"},null,8,["value"])])])),_:1}),u(d,{class:"mb-12px",label:"Send Content","show-feedback":!1},{default:c((()=>[u(h,{value:b(_).up_content,"onUpdate:value":n[4]||(n[4]=e=>b(_).up_content=e)},{default:c((()=>[u(f,{value:1},{default:c((()=>[p("Upload html file")])),_:1}),u(f,{value:0},{default:c((()=>[p("Manual Fill")])),_:1})])),_:1},8,["value"])])),_:1}),j(u(d,{label:" ",path:"file_content"},{default:c((()=>[u(I,{value:b(_).file_content,"onUpdate:value":n[5]||(n[5]=e=>b(_).file_content=e),path:"/www/server/panel/data/mail/in_bulk/content",accept:["txt","html"]},{default:c((()=>[V])),_:1},8,["value"])])),_:1},512),[[x,1===b(_).up_content]]),j(u(d,{label:" ",path:"content"},{default:c((()=>[o("div",W,[u(k,{value:b(_).content,"onUpdate:value":n[6]||(n[6]=e=>b(_).content=e),rows:4,placeholder:"Please enter send content"},null,8,["value"])])])),_:1},512),[[x,0===b(_).up_content]]),u(d,{label:"Save in Outbox"},{default:c((()=>[u(S,{value:b(_).is_record,"onUpdate:value":n[7]||(n[7]=e=>b(_).is_record=e),"checked-value":1,"unchecked-value":0},null,8,["value"])])),_:1}),u(d,{label:"Send Limit","show-feedback":!1},{default:c((()=>[o("div",Z,[u(O,{data:b(w)},null,8,["data"])])])),_:1})])),_:1},8,["model"])])}}});export{$ as default};
