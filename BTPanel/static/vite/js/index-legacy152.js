System.register(["./index-legacy.js?v=1723125373998","./site-legacy2.js?v=1723125373998","./site-legacy.js?v=1723125373998","./index-legacy59.js?v=1723125373998","./index-legacy77.js?v=1723125373998","./vue-legacy.js?v=1723125373998","./useTableData-legacy.js?v=1723125373998","./useLoading-legacy.js?v=1723125373998","./Switch-legacy.js?v=1723125373998","./index-legacy73.js?v=1723125373998","./Tag-legacy.js?v=1723125373998","./useTableColumns-legacy.js?v=1723125373998","./Alert-legacy.js?v=1723125373998","./form.vue_vue_type_script_setup_true_lang-legacy2.js?v=1723125373998","./Image-legacy.js?v=1723125373998","./pinia-legacy.js?v=1723125373998","./index-legacy70.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy2.js?v=1723125373998","./DataTable-legacy.js?v=1723125373998","./Checkbox-legacy.js?v=1723125373998","./Ellipsis-legacy.js?v=1723125373998","./Select-legacy.js?v=1723125373998","./Empty-legacy.js?v=1723125373998","./omit-legacy.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy3.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy4.js?v=1723125373998","./index-legacy144.js?v=1723125373998","./Tabs-legacy.js?v=1723125373998","./index-legacy105.js?v=1723125373998","./use-theme-vars-legacy.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy13.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy8.js?v=1723125373998","./InputGroupLabel-legacy.js?v=1723125373998","./InputGroup-legacy.js?v=1723125373998","./index.vue_vue_type_script_setup_true_lang-legacy12.js?v=1723125373998","./file-legacy2.js?v=1723125373998","./Spin-legacy.js?v=1723125373998","./refersh-legacy.js?v=1723125373998","./php-legacy.js?v=1723125373998","./Space-legacy.js?v=1723125373998","./index-legacy145.js?v=1723125373998","./Progress-legacy.js?v=1723125373998","./data-legacy.js?v=1723125373998","./Skeleton-legacy.js?v=1723125373998","./_createCompounder-legacy.js?v=1723125373998"],(function(e,t){"use strict";var l,a,s,i,n,u,o,r,d,c,p,m,f,_,h,g,v,y,w,x,b,j,k,P,C,O,D,$,M,R,q,z,S,W,B,U,A,F,L,I,T,E,H,K,N,V,G,Q,Z,J,X,Y,ee,te,le,ae,se,ie;return{setters:[e=>{l=e.ax,a=e.aw,s=e.j,i=e.eG,n=e.bh,u=e.a,o=e.h,r=e.n,d=e.k,c=e.ae,p=e.B,m=e.g,f=e.bf,_=e.ay,h=e.cQ,g=e._,v=e.q},e=>{y=e.o},e=>{w=e.S,x=e.aC},e=>{b=e.f,j=e.o,k=e.h,P=e.i,C=e.j,O=e.k},e=>{D=e._},e=>{$=e.A,M=e.a,R=e.l,q=e.P,z=e.S,S=e.Z,W=e.W,B=e._,U=e.U,A=e.V,F=e.D,L=e.ad,I=e.r,T=e.b,E=e.aq,H=e.q,K=e.a3,N=e.d,V=e.af,G=e.f},e=>{Q=e.u,Z=e._},e=>{J=e.u},e=>{X=e._},e=>{Y=e._},e=>{ee=e._},e=>{te=e.b,le=e.a},e=>{ae=e._},e=>{se=e._},e=>{ie=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent=".n-tag[data-v-3eeccaf3]{--n-height: 16px;--n-padding: 0 5px;--n-font-size: 90%;--n-text-color: #2196f3;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.tools-card[data-v-9c1f3952]{display:flex;align-items:center;padding:12px 24px;border-radius:4px;background-color:#f7f7f7}.tools-card+.tools-card[data-v-9c1f3952]{margin-top:16px}.tools-card .tools-img[data-v-9c1f3952]{display:flex;justify-content:center;width:26px}.tools-card .tools-name[data-v-9c1f3952]{min-width:150px;padding:0 12px;font-size:13px}.tools-card .n-button[data-v-9c1f3952]{margin-left:12px;width:32px;padding:0}.tools-card .tools-desc[data-v-9c1f3952]{margin-left:16px}\n",document.head.appendChild(t);const ne=Symbol("server-list");function ue(){return M(ne)}const oe=e=>l.post("/tamper_core/add_black_exts.json",e,{requestOptions:{loading:a.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),re=e=>l.post("/tamper_core/remove_black_exts.json",e,{requestOptions:{loading:a.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),de=B("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1),ce=R({__name:"index",setup(e,{expose:t}){const{site:u,setPid:o}=ue(),{loading:r,setLoading:d}=J(),{table:c,columns:p}=Q([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:e=>q(X,{value:e.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async t=>{const{message:i}=await(n={key:e.key,value:t,path_id:e.id},l.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:a.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;s(i)&&i.status&&(e.status=t)}},null)}]),m=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],f=async()=>{try{d(!0);const{message:t}=await b({path:u.path});s(t)&&!i(t)?(o(t.pid),e=t,c.data=m.map((t=>{const l=`is_${t.name}`,a=e[l];return{key:l,id:e.pid,name:`Disabled ${t.title}`,status:n(a)?a:0}}))):c.data=[]}finally{d(!1)}var e};return f(),t({init:f}),(e,t)=>{const l=Z;return z(),S("div",null,[q(l,{loading:W(r),"loading-num":9,"max-height":340,data:W(c).data,columns:W(p)},null,8,["loading","data","columns"]),de])}}}),pe=u({},[["render",function(e,t){const l=ee;return z(),U(l,{size:"small",bordered:!1},{default:A((()=>[F(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-3eeccaf3"]]),me={class:"flex mb-12px"},fe={class:"w-240px mr-12px"},_e=B("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1),he=B("div",null,"Example:",-1),ge=R({__name:"index",setup(e,{expose:t}){const{t:l}=L(),{site:a,setPid:i}=ue(),n=I("");let u=-1,m="";const f=async()=>{if(""===n.value.trim())return void r.error("Please enter suffix");const{message:e}=await oe({path_id:u,path:m,exts:n.value});s(e)&&(e.status?(r.success(e.msg),n.value="",w()):r.error(e.msg))},{table:_,columns:h}=Q([{key:"exts",title:"Suffix"},te({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{o({title:`Delete protected file suffix [${e.exts}]`,content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await re({path_id:e.id,path:m,exts:e.exts});s(t)&&(t.status?(r.success(t.msg),w()):r.error(t.msg))}})},{loading:v,setLoading:y}=J(),w=async()=>{try{y(!0);const{message:t}=await b({path:a.path});s(t)&&(i(t.pid),u=(e=t).pid,m=e.path,d(e.black_exts)?_.data=e.black_exts.filter((e=>"/"!=e[0]&&-1==e.indexOf("./"))).map((t=>({id:e.pid,exts:t}))):_.data=[])}finally{y(!1)}var e};return w(),t({init:w}),(e,t)=>{const l=c,a=p,s=Z,i=pe,u=Y;return z(),S("div",null,[B("div",me,[B("div",fe,[q(l,{value:W(n),"onUpdate:value":t[0]||(t[0]=e=>T(n)?n.value=e:null),placeholder:"Suffix",onKeyup:E(f,["enter"])},null,8,["value"])]),q(a,{type:"primary",onClick:f},{default:A((()=>[H(K(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(v),"loading-num":6,"max-height":230,data:W(_).data,columns:W(h)},null,8,["loading","data","columns"]),q(u,{class:"mt-16px"},{default:A((()=>[_e,B("li",null,[H(" As: "),q(i,null,{default:A((()=>[H(".php")])),_:1}),H(", "),q(i,null,{default:A((()=>[H(".html")])),_:1}),H(", "),q(i,null,{default:A((()=>[H(".js?v=1723125373998")])),_:1}),H(", "),q(i,null,{default:A((()=>[H("index.php")])),_:1}),H(" etc. ")]),he,B("li",null,[q(i,null,{default:A((()=>[H(".php")])),_:1}),H(" Match: "),q(i,null,{default:A((()=>[H("./1.php")])),_:1}),H(),q(i,null,{default:A((()=>[H("./test/2.php")])),_:1}),H(" Mismatch: "),q(i,null,{default:A((()=>[H("./1.php/1.txt")])),_:1})]),B("li",null,[q(i,null,{default:A((()=>[H("index.php")])),_:1}),H(" Match: "),q(i,null,{default:A((()=>[H("./index.php")])),_:1}),H(),q(i,null,{default:A((()=>[H("./test/index.php")])),_:1}),q(i,{class:"ml-0.5em"},{default:A((()=>[H("./abc_index.php")])),_:1}),H(" Mismatch: "),q(i,null,{default:A((()=>[H("./index.php.tar.gz")])),_:1})])])),_:1})])}}}),ve={class:"flex mb-12px"},ye={class:"w-240px mr-12px"},we=B("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1),xe=B("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1),be=R({__name:"index",setup(e,{expose:t}){const{t:l}=L(),{site:a,setPid:i}=ue(),n=I("");let u=-1,m="";const f=async()=>{if(""===n.value.trim())return void r.error("Please enter the full path or relative path of the file");const{message:e}=await oe({path_id:u,path:m,exts:n.value});s(e)&&(e.status?(r.success(e.msg),n.value="",w()):r.error(e.msg))},{table:_,columns:h}=Q([{key:"exts",title:"Full file path"},te({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{o({title:`Delete protected files [${e.exts}]`,content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await re({path_id:e.id,path:m,exts:e.exts});s(t)&&(t.status?(r.success(t.msg),w()):r.error(t.msg))}})},{loading:v,setLoading:y}=J(),w=async()=>{try{y(!0);const{message:t}=await b({path:a.path});s(t)&&(i(t.pid),u=(e=t).pid,m=e.path,d(e.black_exts)?_.data=e.black_exts.filter((e=>"/"==e[0]||"."==e[0]&&"/"==e[1])).map((t=>({id:e.pid,exts:t}))):_.data=[])}finally{y(!1)}var e};return w(),t({init:w}),(e,t)=>{const l=c,a=p,s=Z,i=pe,u=Y;return z(),S("div",null,[B("div",ve,[B("div",ye,[q(l,{value:W(n),"onUpdate:value":t[0]||(t[0]=e=>T(n)?n.value=e:null),placeholder:"Full path Or Relative path",onKeyup:E(f,["enter"])},null,8,["value"])]),q(a,{type:"primary",onClick:f},{default:A((()=>[H(K(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(v),"loading-num":5,"max-height":200,data:W(_).data,columns:W(h)},null,8,["loading","data","columns"]),q(u,{class:"mt-16px"},{default:A((()=>[we,B("li",null,[H("1. Complete file path, such as: "),q(i,null,{default:A((()=>[H("/www/wwwroot/test/123.log")])),_:1})]),B("li",null,[H(" 2. Relative path to the site, such as: Full path "),q(i,null,{default:A((()=>[H("/www/wwwroot/test/app/123.log")])),_:1}),H(" Relative path "),q(i,null,{default:A((()=>[H("./app/123.log")])),_:1})]),B("li",null,[H(" 3. All files in the specified directory, such as: "),q(i,null,{default:A((()=>[H("/www/wwwroot/test/app/*")])),_:1}),H(" Relative path "),q(i,null,{default:A((()=>[H("./app/*")])),_:1})]),B("li",null,[H(" 4. the specified directory under the specified file type, such as: "),q(i,null,{default:A((()=>[H("/www/wwwroot/test/app/*.log")])),_:1}),H(" Relative path "),q(i,null,{default:A((()=>[H("./app/*.log")])),_:1})]),xe])),_:1})])}}}),je={class:"flex mb-12px"},ke={class:"w-240px mr-12px"},Pe=B("div",null,"Example:",-1),Ce=R({__name:"index",setup(e,{expose:t}){const{t:i}=L(),{site:n,setPid:u}=ue(),m=I("");let f=-1,_="";const h=async()=>{if(""===m.value.trim())return void r.error("Please enter directory name");const{message:e}=await(t={path_id:f,path:_,dirnames:m.value},l.post("/tamper_core/add_white_dirs.json",t,{requestOptions:{loading:a.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var t;s(e)&&(e.status?(r.success(e.msg),m.value="",j()):r.error(e.msg))},{table:g,columns:v}=Q([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},le({title:"Remark",onBlur:async(e,t)=>{const{message:i}=await(n={path_id:t.id,dir_name:t.dir,ps:e},l.post("/tamper_core/set_white_dir_with_ps.json",n,{requestOptions:{loading:a.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var n;s(i)&&(i.status?t.ps=e:r.error(i.msg))}}),te({width:80,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{y(e)}}]})]),y=async e=>{o({title:"Delete directory whitelist",content:e.tip_msg?e.tip_msg:`Delete [${e.dir}] later, All files in the directory will be protected, continue?`,onConfirm:async()=>{const{message:t}=await(i={path_id:e.id,path:_,dirname:e.dir},l.post("/tamper_core/remove_white_dirs.json",i,{requestOptions:{loading:a.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;s(t)&&(t.status?(r.success(t.msg),j()):r.error(t.msg))}})},{loading:w,setLoading:x}=J(),j=async()=>{try{x(!0);const{message:t}=await b({path:n.path});s(t)&&(u(t.pid),f=(e=t).pid,_=e.path,d(e.white_dirs)?g.data=e.white_dirs.map((t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t}))):g.data=[])}finally{x(!1)}var e};return j(),t({init:j}),(e,t)=>{const l=c,a=p,s=Z,i=pe,n=Y;return z(),S("div",null,[B("div",je,[B("div",ke,[q(l,{value:W(m),"onUpdate:value":t[0]||(t[0]=e=>T(m)?m.value=e:null),placeholder:"Directory name",onKeyup:E(h,["enter"])},null,8,["value"])]),q(a,{type:"primary",onClick:h},{default:A((()=>[H(K(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(w),"loading-num":5,"max-height":188,data:W(g).data,columns:W(v)},null,8,["loading","data","columns"]),q(n,{class:"mt-16px"},{default:A((()=>[B("li",null,[H(" Full path or directory name or parts path are allowed such as: "),q(i,null,{default:A((()=>[H("/www/abc/cache/test/")])),_:1}),H(", "),q(i,null,{default:A((()=>[H("test")])),_:1}),H(", "),q(i,null,{default:A((()=>[H("cache/test/")])),_:1})]),B("li",null,[H(" The first character of the Full path must be "),q(i,null,{default:A((()=>[H("/")])),_:1}),H(", as: "),q(i,null,{default:A((()=>[H("cache/test/")])),_:1}),H(" or "),q(i,null,{default:A((()=>[H("test")])),_:1})]),B("li",null,[H(" art of directory name or path cannot begin with "),q(i,null,{default:A((()=>[H("/")])),_:1}),H(", as: "),q(i,null,{default:A((()=>[H("/www/abc/cache/test/")])),_:1})]),Pe,B("li",null,[q(i,null,{default:A((()=>[H("/www/abc/")])),_:1}),H(" Match: "),q(i,null,{default:A((()=>[H("/www/abc/*")])),_:1}),H(" Mismatch: "),q(i,null,{default:A((()=>[H("/www/abc")])),_:1}),q(i,{class:"ml-0.5em"},{default:A((()=>[H("/www/abc123")])),_:1})]),B("li",null,[q(i,null,{default:A((()=>[H("test")])),_:1}),H(" Match: "),q(i,null,{default:A((()=>[H("/www/test/1.txt")])),_:1}),H(),q(i,null,{default:A((()=>[H("/www/test_abc")])),_:1}),H(" Mismatch: "),q(i,null,{default:A((()=>[H("/www/1.php")])),_:1})]),B("li",null,[q(i,null,{default:A((()=>[H("cache/test/")])),_:1}),H(" Match: "),q(i,null,{default:A((()=>[H("/www/cache/test/1.txt")])),_:1}),H(),q(i,null,{default:A((()=>[H("/cache/test/")])),_:1}),H(" Mismatch: "),q(i,null,{default:A((()=>[H("/www/cache/test")])),_:1}),H(),q(i,null,{default:A((()=>[H("/cache/")])),_:1})])])),_:1})])}}}),Oe={class:"flex mb-12px"},De={class:"w-240px mr-12px"},$e=B("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1),Me=B("div",null,"Example:",-1),Re=R({__name:"index",setup(e,{expose:t}){const{t:i}=L(),{site:n,setPid:u}=ue(),m=I("");let f=-1,_="";const h=async()=>{if(""===m.value.trim())return void r.error("Please enter file name");const{message:e}=await(t={path_id:f,path:_,filename:m.value},l.post("/tamper_core/add_white_files.json",t,{requestOptions:{loading:a.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var t;s(e)&&(e.status?(r.success(e.msg),m.value="",j()):r.error(e.msg))},{table:g,columns:v}=Q([{key:"filename",title:"File name"},te({width:100,options:e=>[{label:i("Public.Btn.Del"),onClick:()=>{y(e)}}]})]),y=async e=>{o({title:`Delete file whitelist [${e.filename}]`,content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:t}=await(i={path_id:e.id,path:_,filename:e.filename},l.post("/tamper_core/remove_white_files.json",i,{requestOptions:{loading:a.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var i;s(t)&&(t.status?(r.success(t.msg),j()):r.error(t.msg))}})},{loading:w,setLoading:x}=J(),j=async()=>{try{x(!0);const{message:t}=await b({path:n.path});s(t)&&(u(t.pid),f=(e=t).pid,_=e.path,d(e.white_files)?g.data=e.white_files.map((t=>({id:e.pid,filename:t}))):g.data=[])}finally{x(!1)}var e};return j(),t({init:j}),(e,t)=>{const l=c,a=p,s=Z,i=pe,n=Y;return z(),S("div",null,[B("div",Oe,[B("div",De,[q(l,{value:W(m),"onUpdate:value":t[0]||(t[0]=e=>T(m)?m.value=e:null),placeholder:"File name",onKeyup:E(h,["enter"])},null,8,["value"])]),q(a,{type:"primary",onClick:h},{default:A((()=>[H(K(e.$t("Public.Btn.Add")),1)])),_:1})]),q(s,{loading:W(w),"loading-num":6,"max-height":230,data:W(g).data,columns:W(v)},null,8,["loading","data","columns"]),q(n,{class:"mt-16px"},{default:A((()=>[B("li",null,[H(" Full path or single filename are allowed such as: "),q(i,null,{default:A((()=>[H("/test/index.php")])),_:1}),H(", "),q(i,null,{default:A((()=>[H("index.php")])),_:1})]),$e,Me,B("li",null,[q(i,null,{default:A((()=>[H("index.php")])),_:1}),H(" Match: "),q(i,null,{default:A((()=>[H("./index.php")])),_:1}),H(),q(i,null,{default:A((()=>[H("./test/index.php")])),_:1}),H(" Mismatch: "),q(i,null,{default:A((()=>[H("./abc_index.php")])),_:1}),H(),q(i,null,{default:A((()=>[H("./index.php/1.txt")])),_:1})]),B("li",null,[q(i,null,{default:A((()=>[H("/test/index.php")])),_:1}),H(" match only: "),q(i,null,{default:A((()=>[H("/test/index.php")])),_:1})])])),_:1})])}}}),qe={class:"p-20px"},ze={class:"flex items-center text-12px text-#666"},Se=B("span",{class:"mr-12px"},"Protection switch",-1),We={key:0,class:"ml-12px"},Be={class:"h-500px"},Ue=R({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const l=e,a=t,s=N(l,"site");let i=-1;const n=I(l.open),u=I(),o=async e=>{e?await j({paths:[{path:s.value.path,ps:s.value.ps}]}):await k({path_id:i}),n.value=e,a("changeOpen",e),u.value.init()},r=I("basic"),d=[{key:"basic",label:"Basic Setting",component:ce},{key:"suffix",label:"Protected file suffix",component:ge},{key:"protected file",label:"Protected File",component:be},{key:"directory whitelist",label:"Directory whitelist",component:Ce},{key:"file whitelist",label:"File whitelist",component:Re}];var c;return c={site:s.value,setPid:e=>{i=e}},$(ne,c),(e,t)=>{const l=X,a=ae,s=D;return z(),S("div",qe,[q(a,{class:"mb-16px",type:W(n)?"success":"error","show-icon":!1,bordered:!1},{default:A((()=>[B("div",ze,[Se,q(l,{value:W(n),"onUpdate:value":o},null,8,["value"]),W(n)?V("",!0):(z(),S("span",We," Protection directory closed, be security risks, Recommended open protection immediately "))])])),_:1},8,["type"]),B("div",Be,[q(s,{ref_key:"tabsRef",ref:u,value:W(r),"onUpdate:value":t[0]||(t[0]=e=>T(r)?r.value=e:null),options:d},null,8,["value"])])])}}}),Ae=R({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const l=t,a=N(e,"site"),s=e=>{l("changeHotlink",e)};return(e,t)=>(z(),S("div",null,[q(se,{class:"p-20px",site:W(a),onChangeHotlink:s},null,8,["site"])]))}}),Fe={class:"p-20px"},Le={class:"tools-card"},Ie={class:"tools-img"},Te={class:"tools-name"},Ee={class:"tools-desc"},He={class:"ml-0.5em"},Ke={class:"tools-card"},Ne={class:"tools-img"},Ve={class:"tools-name"},Ge={class:"tools-desc"},Qe={class:"ml-0.5em"},Ze={class:"tools-card"},Je={class:"tools-img"},Xe={class:"tools-name"},Ye=R({__name:"index",props:{site:{}},setup(e){const t=N(e,"site"),l=G({status:!1,number:0,pid:-1}),a=I(!1),i=async e=>{try{a.value=!0,await _({source:200}),await h("tamper_core"),e?await j({paths:[{path:t.value.path,ps:t.value.ps}]}):await k({path_id:l.pid}),T()}finally{a.value=!1}},n=m(`File Protection [${t.value.name}]`,{site:t.value,open:!1,onChangeOpen:e=>{l.status=e}}),u=async()=>{await _({source:200}),await h("tamper_core"),n.data.open=l.status,n.show=!0},o=G({status:!1,number:0}),r=I(!1),d=async e=>{try{r.value=!0,await _({source:201}),await h("btwaf"),e?await P({site_name:t.value.name}):await C({site_name:t.value.name}),T()}finally{r.value=!1}},c=async()=>{await _({source:201}),await h("btwaf"),y(t.value.name),D()},D=()=>{let e=0;const t=setInterval((()=>{e+=.5;const l=document.querySelector(".waf_site_body");if(l){let e=!1;new MutationObserver((t=>{t.forEach((t=>{"childList"!==t.type||document.contains(l)||e||(T(),e=!0)}))})).observe(document.body,{childList:!0,subtree:!0}),clearInterval(t)}e>=20&&clearInterval(t)}),500)},$=I(!1),M=I(!1),R=async e=>{try{M.value=!0;const{message:l}=await w({id:t.value.id,name:t.value.name},!1);if(s(l)){const a={id:t.value.id,name:t.value.name,fix:l.fix,domains:l.domains,return_rule:l.return_rule,status:e,http_status:"true"===l.http_status};await x(a,!1),$.value=e}}finally{M.value=!1}},U=m(`Hotlink Protection [${t.value.name}]`,{site:t.value,onChangeHotlink:e=>{$.value=e}}),F=()=>{U.show=!0},L=e=>{a.value=e,r.value=e,M.value=e},T=async()=>{try{L(!0);const{message:e}=await O({id:t.value.id,path:t.value.path,site_name:t.value.name});if(s(e)&&(l.status=1===e.file_status,l.number=e.file_count,o.status=1===e.firewall_status,o.number=e.firewall_count,$.value=1===e.hotlink_status,1===e.file_status)){const{message:e}=await b({path:t.value.path});s(e)&&(l.pid=e.pid)}}finally{L(!1)}};return T(),(e,t)=>{const s=ie,m=X,_=g,h=p,y=ee,w=v;return z(),S("div",Fe,[B("div",Le,[B("div",Ie,[q(s,{lazy:!0,"preview-disabled":!0,width:"24",src:`${W(f)}images/soft-ico/ico-tamper_core.png`},null,8,["src"])]),B("div",Te,K(e.$t("WP.Label.FileProtection")),1),q(m,{value:W(l).status,loading:W(a),"onUpdate:value":i},null,8,["value","loading"]),q(h,{quaternary:"",size:"small",onClick:u},{default:A((()=>[q(_,{name:"setting",size:"18"})])),_:1}),B("div",Ee,[q(y,{type:"error",size:"small",bordered:!1},{default:A((()=>[H(K(W(l).number),1)])),_:1}),B("span",He,K(e.$t("WP.Config.Protection.Blocked")),1)])]),B("div",Ke,[B("div",Ne,[q(s,{lazy:!0,"preview-disabled":!0,width:"26",src:`${W(f)}images/soft-ico/ico-btwaf.png`},null,8,["src"])]),B("div",Ve,K(e.$t("WP.Label.Application")),1),q(m,{value:W(o).status,loading:W(r),"onUpdate:value":d},null,8,["value","loading"]),q(h,{quaternary:"",size:"small",onClick:c},{default:A((()=>[q(_,{name:"setting",size:"18"})])),_:1}),B("div",Ge,[q(y,{type:"error",size:"small",bordered:!1},{default:A((()=>[H(K(W(o).number),1)])),_:1}),B("span",Qe,K(e.$t("WP.Config.Protection.Requests")),1)])]),B("div",Ze,[B("div",Je,[q(_,{name:"soft-hotlink",size:"24"})]),B("div",Xe,K(e.$t("WP.Label.Hotlink")),1),q(m,{value:W($),loading:W(M),"onUpdate:value":R},null,8,["value","loading"]),q(h,{quaternary:"",size:"small",onClick:F},{default:A((()=>[q(_,{name:"setting",size:"18"})])),_:1})]),q(w,{show:W(n).show,"onUpdate:show":t[0]||(t[0]=e=>W(n).show=e),title:W(n).title,data:W(n).data,width:800,component:Ue},null,8,["show","title","data"]),q(w,{show:W(U).show,"onUpdate:show":t[1]||(t[1]=e=>W(U).show=e),title:W(U).title,data:W(U).data,component:Ae},null,8,["show","title","data"])])}}});e("default",u(Ye,[["__scopeId","data-v-9c1f3952"]]))}}}));
