import{_ as t}from"./index.vue_vue_type_script_setup_true_lang.js?v=1723125373998";import{u as e,_ as i}from"./useTableData.js?v=1723125373998";import{u as a,O as s,N as o,dK as r,dR as l,h as n,dS as p,dT as m,k as d,n as u,dU as c,B as h}from"./index.js?v=1723125373998";import{b as f}from"./useTableColumns.js?v=1723125373998";import{u as w}from"./useLoading.js?v=1723125373998";import{l as j,S as _,Z as g,P as k,V as y,q as b,W as v}from"./vue.js?v=1723125373998";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1723125373998";import"./data.js?v=1723125373998";import"./Skeleton.js?v=1723125373998";import"./DataTable.js?v=1723125373998";import"./Checkbox.js?v=1723125373998";import"./Ellipsis.js?v=1723125373998";import"./Select.js?v=1723125373998";import"./Tag.js?v=1723125373998";import"./Empty.js?v=1723125373998";import"./omit.js?v=1723125373998";import"./pinia.js?v=1723125373998";import"./Progress.js?v=1723125373998";import"./Switch.js?v=1723125373998";const x={class:"p-20px"},C=j({__name:"index",props:{data:{}},setup(j){const C=j,{sid:L}=C.data,D=a(),S=async()=>{if(null===L)throw u.error("Please select remote database!"),new Error("sid is null");await c({sid:L}),F()},{table:T,columns:B}=e([{key:"name",title:"File name",width:180,ellipsis:{tooltip:{width:"trigger"}}},{key:"filepath",title:"File path",ellipsis:{tooltip:{width:"trigger"}}},{key:"mtime",title:"Backup time",width:150,render:t=>s(t.mtime)},{key:"size",title:"File size",width:80,render:t=>o(t.size)},{key:"sid",title:"Backup location",width:120,render:t=>{let e="--";for(let i=0;i<D.remoteList.length;i++)if("".concat(D.remoteList[i].id)===t.sid){e=D.remoteList[i].ps||D.remoteList[i].db_host;break}return e}},f({width:100,options:t=>[{label:"Repair",onClick:()=>{r({text:"Overwrite the data",title:"Overwrite the data",content:"Data will be overwritten using [".concat(t.name,"], Do you want to continue?"),onConfirm:async({hide:e})=>{if(null===L)throw new Error("sid is null");await l({file:t.filepath,sid:L}),D.setRefresh(!0),e()}})}},{label:"Del",onClick:()=>{n({title:"Delete backup",content:"Whether to delete the [".concat(t.name,"] backup"),onConfirm:async({hide:e})=>{await p({file:t.filepath}),F(),e()}})}}]})]),{loading:E,setLoading:z}=w(),F=async()=>{try{z(!0);const{message:t}=await m();T.data=d(t)?t:[]}finally{z(!1)}};return F(),(e,a)=>{const s=h,o=i,r=t;return _(),g("div",x,[k(r,null,{toolsLeft:y((()=>[k(s,{type:"primary",onClick:S},{default:y((()=>[b("Backup")])),_:1})])),table:y((()=>[k(o,{"max-height":400,loading:v(E),columns:v(B),data:v(T).data},null,8,["loading","columns","data"])])),_:1})])}}});export{C as default};
